#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry="iPhone"'
    extract:
    - 'DeviceClass                         :        9 :"Phone"'
    - 'DeviceBrand                         :        9 :"Apple"'
    - 'DeviceName                          :        9 :"iPhone"'
    - 'OperatingSystemClass                :        9 :"Mobile"'
    - 'OperatingSystemName                 :        9 :"iOS"'
    - 'OperatingSystemVersion              :        9 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry="iPad"'
    extract:
    - 'DeviceClass                         :        9 :"Tablet"'
    - 'DeviceBrand                         :        9 :"Apple"'
    - 'DeviceName                          :        9 :"iPhone"'
    - 'OperatingSystemClass                :        9 :"Mobile"'
    - 'OperatingSystemName                 :        9 :"iOS"'
    - 'OperatingSystemVersion              :        9 :"<<<null>>>"'

- matcher:
    variable:
    - 'AppleTag                            :agent.(1-5)product.name[1]?AppleDeviceClass'
    extract:
    - 'DeviceClass                         :      140 :LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :      140 :"Apple"'
    - 'DeviceName                          :      140 :LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :      140 :LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :      140 :"Mobile"'
    - 'OperatingSystemName                 :      140 :"iOS"'
    - 'OperatingSystemVersion              :      140 :"<<<null>>>"'

- matcher:
    variable:
    - 'AppleTag                            :agent.(1-5)product.name[-2]?AppleDeviceClass'
    extract:
    - 'DeviceClass                         :      140 :LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :      140 :"Apple"'
    - 'DeviceName                          :      140 :LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :      140 :LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :      140 :"Mobile"'
    - 'OperatingSystemName                 :      140 :"iOS"'
    - 'OperatingSystemVersion              :      140 :"<<<null>>>"'

- matcher:
    variable:
    - 'AppleTag                            :agent.(1-5)product.version?AppleDeviceClass'
    extract:
    - 'DeviceClass                         :      141 :LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :      141 :"Apple"'
    - 'DeviceName                          :      141 :LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :      141 :LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :      141 :"Mobile"'
    - 'OperatingSystemName                 :      141 :"iOS"'
    - 'OperatingSystemVersion              :      141 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry[-2]="iPhone OS"'
    variable:
    - 'AppleTag                            :agent.(1-5)product.comments.entry[1]?AppleDeviceClass'
    extract:
    - 'DeviceClass                         :      102 :LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :      102 :"Apple"'
    - 'DeviceName                          :      102 :LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :        2 :LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :       11 :"Mobile"'
    - 'OperatingSystemName                 :       11 :"iOS"'
    - 'OperatingSystemVersion              :       11 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry[2-3]="iPhone OS"'
    variable:
    - 'AppleTag                            :agent.(1-5)product.comments.entry[1]?AppleDeviceClass'
    extract:
    - 'DeviceClass                         :      102 :LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :      102 :"Apple"'
    - 'DeviceName                          :      102 :LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :        2 :LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :       11 :"Mobile"'
    - 'OperatingSystemName                 :       11 :"iOS"'
    - 'OperatingSystemVersion              :       11 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry[2-3]="iPhone OS"'
    variable:
    - 'AppleTag                            :agent.(1-5)product.comments.entry[-2]?AppleDeviceClass'
    extract:
    - 'DeviceClass                         :      103 :LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :      103 :"Apple"'
    - 'DeviceName                          :      103 :LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :        3 :LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :       11 :"Mobile"'
    - 'OperatingSystemName                 :       11 :"iOS"'
    - 'OperatingSystemVersion              :       11 :"<<<null>>>"'

- matcher:
    variable:
      #    - 'agent.(5)product.(1)version.(1)keyvalue.(1)key="ios"'
      #    - 'agent.(5)product.(1)version.(1)keyvalue.(1)version="iPhone11,8"'
    - 'AppleTag                            :agent.product.(1)version.keyvalue.key="ios"^.value?AppleDeviceClass'
    extract:
    - 'DeviceClass                         :      123 :LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :      123 :"Apple"'
    - 'DeviceName                          :      123 :LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :      123 :LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :       11 :"Mobile"'
    - 'OperatingSystemName                 :       11 :"iOS"'
    - 'OperatingSystemVersion              :       11 :"<<<null>>>"'

- matcher:
    variable:
    - 'OS                                  :agent.(1-5)product.(1)comments.entry.product.name="iPhone OS"'
    extract:
    - 'DeviceClass                         :      100 :"Phone"'
    - 'DeviceBrand                         :      100 :"Apple"'
    - 'DeviceName                          :      100 :"iPhone"'
    - 'OperatingSystemClass                :      100 :"Mobile"'
    - 'OperatingSystemName                 :      100 :"iOS"'
    - 'OperatingSystemVersion              :      100 :CleanVersion[@OS^.version]'

- matcher:
    variable:
    - 'OS                                  :agent.(1-5)product.(1)comments.entry.product.name="CPU iOS"'
    extract:
    - 'OperatingSystemClass                :      100 :"Mobile"'
    - 'OperatingSystemName                 :      100 :"iOS"'
    - 'OperatingSystemVersion              :      100 :CleanVersion[@OS^.version]'

- matcher:
    require:
    - 'IsNull[agent.(1-5)product.(1)comments.entry.product.name="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       20 :"Desktop"'
    - 'DeviceBrand                         :       20 :"Apple"'
    - 'DeviceName                          :       20 :"Apple Macintosh"'
    - 'OperatingSystemClass                :       20 :"Desktop"'
    - 'OperatingSystemName                 :       20 :"Mac OS X"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.(1-5)product.(1)comments.entry.product.name="OS X"^.version]'

- matcher:
    require:
    - 'IsNull[agent.(1-5)product.(1)comments.entry.product.name="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       20 :"Desktop"'
    - 'DeviceBrand                         :       20 :"Apple"'
    - 'DeviceName                          :       20 :"Apple Macintosh"'
    - 'OperatingSystemClass                :       20 :"Desktop"'
    - 'OperatingSystemName                 :       20 :"Mac OS X"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.(1-5)product.(1)comments.entry.product.name[-3]="Mac OS X"^.version]'

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry.(1-2)text[-3]="Mac OS X"'
    - 'IsNull[agent.(1-5)product.(1)comments.entry.(1-2)text="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       19 :"Desktop"'
    - 'DeviceBrand                         :       19 :"Apple"'
    - 'DeviceName                          :       19 :"Apple Macintosh"'
    - 'DeviceCpuBits                       :       19 : "32"'
    - 'OperatingSystemClass                :       19 :"Desktop"'
    - 'OperatingSystemName                 :       19 :"Mac OS X"'
    - 'OperatingSystemVersion              :       19 :"10.?"'

- matcher:
    variable:
    - 'MacOSX                              :agent.(1-5)product.(1)comments.entry.(1)text[2-4]="Mac OS X"'
    - 'MacOSXVersion                       :@MacOSX@[5-]'
    require:
    - 'IsNull[@MacOSX@="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       19 :"Desktop"'
    - 'DeviceBrand                         :       19 :"Apple"'
    - 'DeviceName                          :       19 :"Apple Macintosh"'
    - 'DeviceCpuBits                       :      110 : LookUpPrefix[MacOSXVersionCPUBits;@MacOSXVersion;"64"]'
    - 'OperatingSystemClass                :       19 :"Desktop"'
    - 'OperatingSystemName                 :       19 :"Mac OS X"'
    - 'OperatingSystemVersion              :       19 :"10.?"'

- lookup:
    name: 'MacOSXVersionCPUBits'
    map:
      "10_0_" : "32"
      "10_1_" : "32"
      "10_2" : "32"
      "10_3" : "32"
      "10_4" : "32"
      "10_5" : "32"
      "10_6" : "32"
      "10_7" : "32"
      "10.0." : "32"
      "10.1." : "32"
      "10.2" : "32"
      "10.3" : "32"
      "10.4" : "32"
      "10.5" : "32"
      "10.6" : "32"
      "10.7" : "32"
      "Mach" : "32"

- matcher:
    variable:
    - 'MacOS                               :agent.(1-5)product.(1)comments.entry.(1)text[2-3]="Mac OS"'
    - 'MacOSVersion                        :@MacOS@[4]{"X"'
    require:
    - 'IsNull[agent.(1-5)product.(1)comments.entry.(1)text="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       19 :"Desktop"'
    - 'DeviceBrand                         :       19 :"Apple"'
    - 'DeviceName                          :       19 :"Apple Macintosh"'
    - 'DeviceCpuBits                       :       19 : LookUpPrefix[MacOSXVersionCPUBits;@MacOSVersion;"64"]'
    - 'OperatingSystemClass                :       19 :"Desktop"'
    - 'OperatingSystemName                 :       19 :"Mac OS X"'
    - 'OperatingSystemVersion              :       18 :"10.?"'

- matcher:
    variable:
    - 'MacOSX                              :agent.(1-5)product.(1)comments.entry.product.name="OS X"'
    - 'MacOSXVersion                       :@MacOSX^.version'
    require:
    - 'IsNull[agent.(1-5)product.(1)comments.entry.(1)text="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       20 :"Desktop"'
    - 'DeviceBrand                         :       20 :"Apple"'
    - 'DeviceName                          :       20 :"Apple Macintosh"'
    - 'DeviceCpuBits                       :      110 : LookUpPrefix[MacOSXVersionCPUBits;@MacOSXVersion;"64"]'
    - 'OperatingSystemClass                :       20 :"Desktop"'
    - 'OperatingSystemName                 :       20 :"Mac OS X"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@MacOSXVersion]'

- matcher:
    variable:
    - 'MacOSX                              :agent.(1-5)product.(1)comments.entry.product.name="Mac OS X"'
    - 'MacOSXVersion                       :@MacOSX^.version'
    require:
    - 'IsNull[agent.(1-5)product.(1)comments.entry.(1)text="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       20 :"Desktop"'
    - 'DeviceBrand                         :       20 :"Apple"'
    - 'DeviceName                          :       20 :"Apple Macintosh"'
    - 'DeviceCpuBits                       :      110 : LookUpPrefix[MacOSXVersionCPUBits;@MacOSXVersion;"64"]'
    - 'OperatingSystemClass                :       20 :"Desktop"'
    - 'OperatingSystemName                 :       20 :"Mac OS X"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@MacOSXVersion]'

- matcher:
    variable:
    - 'MacOSX                              :agent.(1-5)product.(1)comments.entry.product.name[2-4]="Mac OS X"'
    - 'MacOSXVersion                       :@MacOSX^.version'
    require:
    - 'IsNull[agent.(1-5)product.(1)comments.entry.(1)text="like Mac OS X"]'
    extract:
    - 'DeviceClass                         :       20 :"Desktop"'
    - 'DeviceBrand                         :       20 :"Apple"'
    - 'DeviceName                          :       20 :"Apple Macintosh"'
    - 'DeviceCpuBits                       :      110 : LookUpPrefix[MacOSXVersionCPUBits;@MacOSXVersion;"64"]'
    - 'OperatingSystemClass                :       20 :"Desktop"'
    - 'OperatingSystemName                 :       20 :"Mac OS X"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@MacOSXVersion]'

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry.(1)text="CPU like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :"<<<null>>>"'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU"^'
    require:
    - '@CPUProduct>="like Mac OS X"'
    extract:
    - 'DeviceFirmwareVersion               :       20 :agent.product.name="Mobile"^.version'
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@CPUProduct.version]'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU OS"^'
    require:
    - '@CPUProduct>="like Mac OS X"'
    extract:
    - 'DeviceFirmwareVersion               :       20 :agent.product.name="Mobile"^.version'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU OS"^'
    require:
    - '@CPUProduct>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@CPUProduct.version]'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU OS"^'
    require:
    - '@CPUProduct>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@CPUProduct.version]'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="OS"^'
    require:
    - '@CPUProduct>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@CPUProduct.version]'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="OS"^'
    require:
    - '@CPUProduct>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@CPUProduct.version]'


- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU iPhone OS"^'
    - 'MobileVersion                       :agent.product.name="Mobile"^.version'
    require:
 #    - 'agent.(5)product.(1)version.(1)keyvalue.(1)key="ios"'
    - 'IsNull[@MobileVersion.keyvalue.key="ios"]'
    extract:
    - 'DeviceFirmwareVersion               :       20 :@MobileVersion'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU iPhone OS"^'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@CPUProduct.version]'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU iPad OS"^'
    extract:
    - 'DeviceFirmwareVersion               :       20 :agent.product.name="Mobile"^.version'

- matcher:
    variable:
    - 'CPUProduct                          :agent.(1-5)product.(1)comments.entry.(1-2)product.name="CPU iPad OS"^'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[@CPUProduct.version]'

- matcher:
    require:
    - 'agent.text="CPU like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.product.name="CPU"^>="like Mac OS X"'
    extract:
    - 'DeviceFirmwareVersion               :       20 :agent.product.name="Mobile"^.version'

- matcher:
    require:
    - 'agent.product.name="CPU"^>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.product.name="CPU"^.version]'

- matcher:
    require:
    - 'agent.product.name="CPU OS"^>="like Mac OS X"'
    extract:
    - 'DeviceFirmwareVersion               :       20 :agent.product.name="Mobile"^.version'

- matcher:
    require:
    - 'agent.product.name="CPU OS"^>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.product.name="CPU OS"^.version]'

- matcher:
    require:
    - 'agent.product.name="CPU OS"^>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.product.name="CPU OS"^.version]'

- matcher:
    require:
    - 'agent.product.name="CPU iPhone OS"^>="like Mac OS X"'
    extract:
    - 'DeviceFirmwareVersion               :       20 :agent.product.name="Mobile"^.version'

- matcher:
    require:
    - 'agent.product.name="CPU iPhone OS"^>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.product.name="CPU iPhone OS"^.version]'

- matcher:
    require:
    - 'agent.product.name="CPU iPad OS"^>="like Mac OS X"'
    extract:
    - 'DeviceFirmwareVersion               :       20 :agent.product.name="Mobile"^.version'

- matcher:
    require:
    - 'agent.product.name="CPU iPad OS"^>="like Mac OS X"'
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.product.name="CPU iPad OS"^.version]'

- matcher:
    require:
    - 'agent.(1-5)product.(1)comments.entry.(1-2)text="Macintosh"'
    extract:
    - 'DeviceClass                         :       10 :"Desktop"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'DeviceName                          :       10 :"Macintosh"'
    - 'DeviceCpuBits                       :       10 : "32"'
    - 'OperatingSystemClass                :        1 :"Desktop"'
    - 'OperatingSystemName                 :        1 :"Mac OS"'
    - 'OperatingSystemVersion              :        1 :"<<<null>>>"'

- matcher:
    variable:
    - 'MacOS                               :agent.(1-5)product.(1)comments.entry.(1-2)text[2-3]="Mac OS"'
    require:
    - 'IsNull[@MacOS@[4]]'
    extract:
    - 'DeviceClass                         :       10 :"Desktop"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'DeviceName                          :       10 :"Macintosh"'
    - 'OperatingSystemClass                :        1 :"Desktop"'
    - 'OperatingSystemName                 :        1 :"Mac OS"'
    - 'OperatingSystemVersion              :        1 :"<<<null>>>"'

- matcher:
    variable:
    - 'MacOS                               :agent.(1-5)product.(1)comments.entry.(1-2)text[3-4]="Mac OS"'
    require:
    - 'IsNull[@MacOS@[5]]'
    extract:
    - 'DeviceClass                         :       10 :"Desktop"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'DeviceName                          :       10 :"Macintosh"'
    - 'OperatingSystemClass                :        1 :"Desktop"'
    - 'OperatingSystemName                 :        1 :"Mac OS"'
    - 'OperatingSystemVersion              :        1 :"<<<null>>>"'

- matcher:
    extract:
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :CleanVersion[agent.(1-5)product.(1)comments.entry.(1-2)product.name="iOS"^.version]'

# Testcases for apps

- test:
    input:
      user_agent_string: 'bol.com/1.8.2 (iPad; iOS 9.3; Scale/2.00)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.8.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.8.2'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'bol.com'

- test:
    input:
      user_agent_string: 'bol.com/1.8.2 (iPhone; iOS 10.0; Scale/2.00)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.0'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.8.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.8.2'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'bol.com'

- test:
    input:
      user_agent_string: 'Voordeel 1.3.0 rv:1.30 (iPhone; iPhone OS 7.1.1; nl_NL)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Voordeel'
      AgentVersion                         : '1.3.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Voordeel 1.3.0'
      AgentNameVersionMajor                : 'Voordeel 1'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) CriOS/40.0.2214.73 Mobile/11D201 Safari/9537.53'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11D201'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.2'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '40.0.2214.73'
      AgentVersionMajor                    : '40'
      AgentNameVersion                     : 'Chrome 40.0.2214.73'
      AgentNameVersionMajor                : 'Chrome 40'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/77.0.3865.103 Mobile/15E148 Safari/605.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '77.0.3865.103'
      AgentVersionMajor                    : '77'
      AgentNameVersion                     : 'Chrome 77.0.3865.103'
      AgentNameVersionMajor                : 'Chrome 77'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; U; CPU OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B367 Safari/531.21.10'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '7B367'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '3.2'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'iOS 3.2'
      OperatingSystemNameVersionMajor      : 'iOS 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '531.21.10'
      LayoutEngineVersionMajor             : '531'
      LayoutEngineNameVersion              : 'AppleWebKit 531.21.10'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 531'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '4.0.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Safari 4.0.4'
      AgentNameVersionMajor                : 'Safari 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; nl-nl) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '8C148'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.2.1'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.17.9'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.17.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '5.0.2'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Safari 5.0.2'
      AgentNameVersionMajor                : 'Safari 5'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; U; CPU OS 4_3_3 like Mac OS X; nl-nl) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '8J2'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.3.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.17.9'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.17.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '5.0.2'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Safari 5.0.2'
      AgentNameVersionMajor                : 'Safari 5'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; U; CPU OS 4_3_5 like Mac OS X; nl-nl) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8L1 Safari/6533.18.5'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '8L1'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.3.5'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.17.9'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.17.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '5.0.2'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Safari 5.0.2'
      AgentNameVersionMajor                : 'Safari 5'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad;U;CPU OS 5_1_1 like Mac OS X; zh-cn)AppleWebKit/534.46.0(KHTML, like Gecko)CriOS/19.0.1084.60 Mobile/9B206 Safari/7534.48.3'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '9B206'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'iOS 5.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 5'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.46.0'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.46.0'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '19.0.1084.60'
      AgentVersionMajor                    : '19'
      AgentNameVersion                     : 'Chrome 19.0.1084.60'
      AgentNameVersionMajor                : 'Chrome 19'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; U; CPU OS 5_1 like Mac OS X; en-us) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B176 Safari/7534.48.3'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '9B176'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '5.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'iOS 5.1'
      OperatingSystemNameVersionMajor      : 'iOS 5'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.46'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '5.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Safari 5.1'
      AgentNameVersionMajor                : 'Safari 5'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_3 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10B329 Safari/8536.25'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '10B329'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '6.1.3'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'iOS 6.1.3'
      OperatingSystemNameVersionMajor      : 'iOS 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '536.26'
      LayoutEngineVersionMajor             : '536'
      LayoutEngineNameVersion              : 'AppleWebKit 536.26'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 536'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Safari 6.0'
      AgentNameVersionMajor                : 'Safari 6'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_6 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10B500 Safari/8536.25'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '10B500'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '6.1.6'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'iOS 6.1.6'
      OperatingSystemNameVersionMajor      : 'iOS 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '536.26'
      LayoutEngineVersionMajor             : '536'
      LayoutEngineNameVersion              : 'AppleWebKit 536.26'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 536'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Safari 6.0'
      AgentNameVersionMajor                : 'Safari 6'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0_2 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A501 Safari/9537.53'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11A501'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.0.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.0.2'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Safari 7.0'
      AgentNameVersionMajor                : 'Safari 7'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0_3 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11B511 Safari/9537.53'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11B511'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.0.3'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.0.3'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Safari 7.0'
      AgentNameVersionMajor                : 'Safari 7'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0_6 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11B651 Safari/9537.53'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11B651'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.0.6'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.0.6'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Safari 7.0'
      AgentNameVersionMajor                : 'Safari 7'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPod; CPU iPhone OS 6_1_6 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10B500 Safari/8536.25'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPod'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '10B500'
      DeviceVersion                        : 'iPod'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '6.1.6'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'iOS 6.1.6'
      OperatingSystemNameVersionMajor      : 'iOS 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '536.26'
      LayoutEngineVersionMajor             : '536'
      LayoutEngineNameVersion              : 'AppleWebKit 536.26'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 536'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Safari 6.0'
      AgentNameVersionMajor                : 'Safari 6'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPod touch; CPU iPhone OS 8_1_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12B440 Safari/600.1.4'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPod Touch'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12B440'
      DeviceVersion                        : 'iPod touch'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Safari 8.0'
      AgentNameVersionMajor                : 'Safari 8'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/600.3.18 (KHTML, like Gecko) Version/8.0.3 Safari/600.3.18'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.10.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.10.2'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.3.18'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.3.18'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '8.0.3'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Safari 8.0.3'
      AgentNameVersionMajor                : 'Safari 8'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 8_1_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.3'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.3'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '600.1.4'
      AgentVersionMajor                    : '600'
      AgentNameVersion                     : 'AppleWebKit 600.1.4'
      AgentNameVersionMajor                : 'AppleWebKit 600'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU iPad OS 8_0 like Mac OS X) AppleWebKit/600.1.3 (KHTML, like Gecko) Version/8.0 Mobile/12A4345d Safari/600.1.4'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12A4345d'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.0'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.3'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.3'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Safari 8.0'
      AgentNameVersionMajor                : 'Safari 8'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; U; CPU like Mac OS X; en) AppleWebKit/420+'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '420'
      LayoutEngineVersionMajor             : '420'
      LayoutEngineNameVersion              : 'AppleWebKit 420'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 420'
      AgentClass                           : 'Browser'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '420'
      AgentVersionMajor                    : '420'
      AgentNameVersion                     : 'AppleWebKit 420'
      AgentNameVersionMajor                : 'AppleWebKit 420'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Airmail 1.3.3 rv:237 (Macintosh; Mac OS X 10.9.3; nl_NL)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.9.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.9.3'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Airmail'
      AgentVersion                         : '1.3.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Airmail 1.3.3'
      AgentNameVersionMajor                : 'Airmail 1'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; U; CPU OS_3_2_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B500 Safari/531.21.10'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '7B500'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : 'OS.3.2.2'
      OperatingSystemVersionMajor          : 'OS'
      OperatingSystemNameVersion           : 'iOS OS.3.2.2'
      OperatingSystemNameVersionMajor      : 'iOS OS'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '531.21.10'
      LayoutEngineVersionMajor             : '531'
      LayoutEngineNameVersion              : 'AppleWebKit 531.21.10'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 531'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '4.0.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Safari 4.0.4'
      AgentNameVersionMajor                : 'Safari 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13B143 Instagram 7.10.0 (iPhone5,4; iPhone OS 9_1; nl_NL@calendar=buddhist; nl-NL; scale=2.00; 640x1136)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13B143'
      DeviceVersion                        : 'iPhone 5c (A1507/A1516/A1529)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.1'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.1'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Instagram'
      AgentVersion                         : '7.10.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Instagram 7.10.0'
      AgentNameVersionMajor                : 'Instagram 7'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'

# Has empty version at the end
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.1 Mobile/11D201 Safari/'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11D201'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.2'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '7.1'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Safari 7.1'
      AgentNameVersionMajor                : 'Safari 7'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry[1]="Mac"'
    extract:
    - 'DeviceClass                         :       10 :"Desktop"'
    - 'DeviceName                          :       10 :"Macintosh"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'OperatingSystemClass                :       10 :"Desktop"'
    - 'OperatingSystemName                 :       10 :"Mac OS"'
    - 'OperatingSystemVersion              :       10 :"before 10"'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry[1]="Mac_68K"'
    extract:
    - 'DeviceClass                         :       10 :"Desktop"'
    - 'DeviceName                          :       10 :"Macintosh"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'OperatingSystemClass                :       10 :"Desktop"'
    - 'OperatingSystemName                 :       10 :"Mac OS"'
    - 'OperatingSystemVersion              :       10 :"before 10"'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry[1]="Mac_PowerPC"'
    extract:
    - 'DeviceClass                         :       10 :"Desktop"'
    - 'DeviceName                          :       10 :"Macintosh"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'OperatingSystemClass                :       10 :"Desktop"'
    - 'OperatingSystemName                 :       10 :"Mac OS"'
    - 'OperatingSystemVersion              :       10 :"before 10"'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 5.23; Mac_PowerPC)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'PowerPC'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : 'before 10'
      OperatingSystemVersionMajor          : 'before 10'
      OperatingSystemNameVersion           : 'Mac OS before 10'
      OperatingSystemNameVersionMajor      : 'Mac OS before 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '5.23'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Internet Explorer 5.23'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '5.23'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Internet Explorer 5.23'
      AgentNameVersionMajor                : 'Internet Explorer 5'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 4.01; AOL 4.0; Mac_68K)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Motorola 68000'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : 'before 10'
      OperatingSystemVersionMajor          : 'before 10'
      OperatingSystemNameVersion           : 'Mac OS before 10'
      OperatingSystemNameVersionMajor      : 'Mac OS before 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '4.01'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Internet Explorer 4.01'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'AOL'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'AOL 4.0'
      AgentNameVersionMajor                : 'AOL 4'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 5.0; Mac_PowerPC) Opera 5.12  [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'PowerPC'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : 'before 10'
      OperatingSystemVersionMajor          : 'before 10'
      OperatingSystemNameVersion           : 'Mac OS before 10'
      OperatingSystemNameVersionMajor      : 'Mac OS before 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '5.12'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Opera 5.12'
      AgentNameVersionMajor                : 'Opera 5'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 9_3_5 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G36'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.5'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '601.1.46'
      AgentVersionMajor                    : '601'
      AgentNameVersion                     : 'UIWebView 601.1.46'
      AgentNameVersionMajor                : 'UIWebView 601'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_0_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16A405'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16A405'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.0.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.0.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'UIWebView 605.1.15'
      AgentNameVersionMajor                : 'UIWebView 605'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_0_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Snapchat/10.43.0.25 (iPhone7,2; iOS 12.0.1; gzip)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 6'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.0.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.0.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Snapchat'
      AgentVersion                         : '10.43.0.25'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Snapchat 10.43.0.25'
      AgentNameVersionMajor                : 'Snapchat 10'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) (Ecosia ios@3.1.3.731)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.0'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.0'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'AppleWebKit' # FIXME: Agent is stored in the (Ecosia ios@3.1.3.731) part??
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'AppleWebKit 605.1.15'
      AgentNameVersionMajor                : 'AppleWebKit 605'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16A366'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16A366'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.0'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.0'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'UIWebView 605.1.15'
      AgentNameVersionMajor                : 'UIWebView 605'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Safari/604.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.3'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.3'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '11.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Safari 11.0'
      AgentNameVersionMajor                : 'Safari 11'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Apple-iPhone7C2/1202.466; U; CPU like Mac OS X; en) AppleWebKit/420+ (KHTML, like Gecko) Version/3.0 Mobile/1A543 Safari/419.3'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 6'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '420'
      LayoutEngineVersionMajor             : '420'
      LayoutEngineNameVersion              : 'AppleWebKit 420'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 420'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Safari 3.0'
      AgentNameVersionMajor                : 'Safari 3'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- matcher:
    variable:
    - 'Device                              :agent.product.name[1]="Apple"'
    - 'iOS                                 :@Device@[3]="iOS"'
    extract:
    - 'OperatingSystemClass                :      150 : "Mobile"'
    - 'OperatingSystemName                 :      150 : "iOS"'
    - 'OperatingSystemVersion              :      150 : @iOS^.version'

- test:
    input:
      user_agent_string: 'Apple iPhone iOS 13.3.1 AppleWebKit/1 Safari/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.3.1'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'AppleWebKit 1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Safari 1'
      AgentNameVersionMajor                : 'Safari 1'
