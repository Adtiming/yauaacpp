#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#


config:

- lookup:
    name: 'SpecialOSTags'
    map:
      # https://en.wikipedia.org/wiki/Glass_OS
      "XE4"                     : "Augmented Reality|Glass OS|4"
      "XE5"                     : "Augmented Reality|Glass OS|5"
      "XE6"                     : "Augmented Reality|Glass OS|6"
      "XE7"                     : "Augmented Reality|Glass OS|7"
      "XE8"                     : "Augmented Reality|Glass OS|8"
      "XE9"                     : "Augmented Reality|Glass OS|9"
      "XE10"                    : "Augmented Reality|Glass OS|10"
      "XE11"                    : "Augmented Reality|Glass OS|11"
      "XE12"                    : "Augmented Reality|Glass OS|12"
      "XE13"                    : "Augmented Reality|Glass OS|13"
      "XE14"                    : "Augmented Reality|Glass OS|14"
      "XE15"                    : "Augmented Reality|Glass OS|15"
      "XE16"                    : "Augmented Reality|Glass OS|16"
      "XE17"                    : "Augmented Reality|Glass OS|17"
      "XE18"                    : "Augmented Reality|Glass OS|18"
      "XE19"                    : "Augmented Reality|Glass OS|19"
      "XE20"                    : "Augmented Reality|Glass OS|20"
      "XE21"                    : "Augmented Reality|Glass OS|21"
      "XE22"                    : "Augmented Reality|Glass OS|22"
      "XE23"                    : "Augmented Reality|Glass OS|23"
      "XE24"                    : "Augmented Reality|Glass OS|24"

- matcher:
    variable:
    - 'OSMatch                             :LookUp[SpecialOSTags;agent.product.comments.entry]'
    extract:
    - 'OperatingSystemClass                :     1001 :@OSMatch[[1]]'
    - 'OperatingSystemName                 :     1001 :@OSMatch[[2]]'
    - 'OperatingSystemVersion              :     1001 :@OSMatch[[3]]'

#  - matcher:
#      extract:
#        - 'DeviceClass           :   10:"Desktop"'
#        - 'DeviceBrand           :   10:"Sun"'
#        - 'DeviceName            :   10:"Sun"'
#        - 'OperatingSystemClass  :   10:"Desktop"'
#        - 'OperatingSystemName   :   10:agent.(1)product.(1)comments.entry.(1)product.name="SunOS"'
#        - 'OperatingSystemVersion:   10:agent.(1)product.(1)comments.entry.(1)product.name="SunOS"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; SunOS i86pc; rv:31.0) Gecko/20100101 Firefox/31.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'SUN Microsystems Desktop'
      DeviceBrand                          : 'SUN Microsystems'
      DeviceCpu                            : 'i86pc'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SunOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'SunOS ??'
      OperatingSystemNameVersionMajor      : 'SunOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '31.0'
      LayoutEngineVersionMajor             : '31'
      LayoutEngineNameVersion              : 'Gecko 31.0'
      LayoutEngineNameVersionMajor         : 'Gecko 31'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '31.0'
      AgentVersionMajor                    : '31'
      AgentNameVersion                     : 'Firefox 31.0'
      AgentNameVersionMajor                : 'Firefox 31'

- matcher:
    extract:
    - 'DeviceClass                         :       10 :"Desktop"'
    - 'DeviceName                          :       10 :"Desktop"'
    - 'OperatingSystemClass                :       10 :"Desktop"'
    - 'OperatingSystemName                 :       10 :agent.(1-4)product.comments.entry="OS/2"'
    - 'OperatingSystemVersion              :       10 :"2.x"'

- matcher:
    extract:
    - 'DeviceClass                         :       20 :"Desktop"'
    - 'DeviceName                          :       20 :"Desktop"'
    - 'OperatingSystemClass                :       20 :"Desktop"'
    - 'OperatingSystemName                 :       20 :agent.(1-4)product.comments.entry="OS/2"'
    - 'OperatingSystemVersion              :       20 :agent.(1-4)product.comments.entry.(1)product.name="Warp"^'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (OS/2; Warp 4.5; rv:24.0) Gecko/20100101 Firefox/24.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OS/2'
      OperatingSystemVersion               : 'Warp 4.5'
      OperatingSystemVersionMajor          : 'Warp 4'
      OperatingSystemNameVersion           : 'OS/2 Warp 4.5'
      OperatingSystemNameVersionMajor      : 'OS/2 Warp 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '24.0'
      LayoutEngineVersionMajor             : '24'
      LayoutEngineNameVersion              : 'Gecko 24.0'
      LayoutEngineNameVersionMajor         : 'Gecko 24'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '24.0'
      AgentVersionMajor                    : '24'
      AgentNameVersion                     : 'Firefox 24.0'
      AgentNameVersionMajor                : 'Firefox 24'

- test:
    input:
      user_agent_string: 'Mozilla/4.61 [de] (OS/2; U)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OS/2'
      OperatingSystemVersion               : '2.x'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'OS/2 2.x'
      OperatingSystemNameVersionMajor      : 'OS/2 2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.61'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.61'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.61'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.61'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentLanguage                        : 'German'
      AgentLanguageCode                    : 'de'
      AgentSecurity                        : 'Strong security'


- matcher:
    extract:
    - 'DeviceClass                         :      111 :"Mobile"'
    - 'DeviceName                          :      113 :agent.(1)product.(1)comments.entry.(1-2)product.name="PalmSource"^.(1)version'
    - 'DeviceBrand                         :      111 :"Palm"'
    - 'OperatingSystemClass                :      151 :"Mobile"'
    - 'OperatingSystemName                 :      151 :"Palm OS"'
    - 'OperatingSystemVersion              :      151 :"<<<null>>>"'


- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1-2)product.name="PalmSource"'
    - 'agent.(1)product.(1)comments.entry.(1-2)product.name="Blazer"'
    extract:
    - 'LayoutEngineClass                   :     2100 : "Browser"'
    - 'LayoutEngineName                    :     2100 : "<<<null>>>"'
    - 'LayoutEngineVersion                 :     2100 : "<<<null>>>"'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Windows 98; PalmSource/hspr-H102; Blazer/4.0) 16;320x320'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Palm Hspr-H102'
      DeviceBrand                          : 'Palm'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Palm OS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Palm OS ??'
      OperatingSystemNameVersionMajor      : 'Palm OS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'Blazer'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Blazer 4.0'
      AgentNameVersionMajor                : 'Blazer 4'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (BeOS; U; Haiku BePC; en-US; rv:1.8.1.18) Gecko/20081114 BonEcho/2.0.0.18'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Beos/Haiku Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'BeOS/Haiku'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'BeOS/Haiku ??'
      OperatingSystemNameVersionMajor      : 'BeOS/Haiku ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.18'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.18'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20081114'
      AgentClass                           : 'Browser'
      AgentName                            : 'BonEcho'
      AgentVersion                         : '2.0.0.18'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'BonEcho 2.0.0.18'
      AgentNameVersionMajor                : 'BonEcho 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Haiku R1 x86) AppleWebKit/602.1 (KHTML, like Gecko) QupZilla/1.8.9 Version/10.0 Safari/602.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Beos/Haiku Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'x86'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'BeOS/Haiku'
      OperatingSystemVersion               : 'R1'
      OperatingSystemVersionMajor          : 'R1'
      OperatingSystemNameVersion           : 'BeOS/Haiku R1'
      OperatingSystemNameVersionMajor      : 'BeOS/Haiku R1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.1'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Unknown; UNIX BSD/SYSV system) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.7.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unix BSD/Sysv Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'UNIX BSD/SYSV'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'UNIX BSD/SYSV ??'
      OperatingSystemNameVersionMajor      : 'UNIX BSD/SYSV ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.7.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.7.0'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; NetBSD alpha; en-US; rv:1.8.1.6) Gecko/20080115 Firefox/51.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Netbsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Alpha'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'NetBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'NetBSD ??'
      OperatingSystemNameVersionMajor      : 'NetBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.6'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.6'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20080115'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '51.0'
      AgentVersionMajor                    : '51'
      AgentNameVersion                     : 'Firefox 51.0'
      AgentNameVersionMajor                : 'Firefox 51'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; NetBSD amd64; fr-FR; rv:1.8.0.7) Gecko/20061102 Firefox/52.6.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Netbsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'AMD64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'NetBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'NetBSD ??'
      OperatingSystemNameVersionMajor      : 'NetBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.0.7'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.0.7'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20061102'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '52.6.0'
      AgentVersionMajor                    : '52'
      AgentNameVersion                     : 'Firefox 52.6.0'
      AgentNameVersionMajor                : 'Firefox 52'
      AgentLanguage                        : 'French (France)'
      AgentLanguageCode                    : 'fr-fr'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; NetBSD i386; en-US; rv:1.9.2.3) Gecko/20100403 Namoroka/3.6.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Netbsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'NetBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'NetBSD ??'
      OperatingSystemNameVersionMajor      : 'NetBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.3'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20100403'
      AgentClass                           : 'Browser'
      AgentName                            : 'Namoroka'
      AgentVersion                         : '3.6.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Namoroka 3.6.3'
      AgentNameVersionMajor                : 'Namoroka 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.8) Gecko/20071008 FreeBSD/i386 Firefox/2.0.0.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FreeBSD ??'
      OperatingSystemNameVersionMajor      : 'FreeBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.8'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.8'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20071008'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '2.0.0.8'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Firefox 2.0.0.8'
      AgentNameVersionMajor                : 'Firefox 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; NetBSD sparc64; fr-FR; rv:1.8.1.6) Gecko/20070822 Firefox/52.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Netbsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Sparc 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'NetBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'NetBSD ??'
      OperatingSystemNameVersionMajor      : 'NetBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.6'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.6'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20070822'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '52.0'
      AgentVersionMajor                    : '52'
      AgentNameVersion                     : 'Firefox 52.0'
      AgentNameVersionMajor                : 'Firefox 52'
      AgentLanguage                        : 'French (France)'
      AgentLanguageCode                    : 'fr-fr'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD amd64; en-US; rv:1.9.0.1) Gecko/2008081402 Firefox/3.0.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'AMD64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.0.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.0.1'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '2008081402'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.0.1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.0.1'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD arm; en-us) AppleWebKit/531.2+ (KHTML, like Gecko) Safari/531.2+ Epiphany/2.30.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARM'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '531.2'
      LayoutEngineVersionMajor             : '531'
      LayoutEngineNameVersion              : 'AppleWebKit 531.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 531'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '2.30.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Epiphany 2.30.0'
      AgentNameVersionMajor                : 'Epiphany 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD i386; en-US; rv:1.8.1.4) Gecko/20071127 Firefox/2.0.0.11'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.4'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.4'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20071127'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '2.0.0.11'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Firefox 2.0.0.11'
      AgentNameVersionMajor                : 'Firefox 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD ppc; en-US; rv:1.8.1.4) Gecko/20070223 BonEcho/2.0.0.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'PowerPC'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.4'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.4'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20070223'
      AgentClass                           : 'Browser'
      AgentName                            : 'BonEcho'
      AgentVersion                         : '2.0.0.4'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'BonEcho 2.0.0.4'
      AgentNameVersionMajor                : 'BonEcho 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD sparc64; en-AU; rv:1.8.1.6) Gecko/20071225 Firefox/2.0.0.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Sparc 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.6'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.6'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20071225'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '2.0.0.6'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Firefox 2.0.0.6'
      AgentNameVersionMajor                : 'Firefox 2'
      AgentLanguage                        : 'English (Australia)'
      AgentLanguageCode                    : 'en-au'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD sparc64; en-CA; rv:1.8.0.2) Gecko/20060429 Firefox/1.5.0.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Sparc 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.0.2'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.0.2'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20060429'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '1.5.0.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Firefox 1.5.0.2'
      AgentNameVersionMajor                : 'Firefox 1'
      AgentLanguage                        : 'English (Canada)'
      AgentLanguageCode                    : 'en-ca'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD sparc64; en-US; rv:1.8.1.6) Gecko/20070816 Firefox/2.0.0.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Sparc 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.1.6'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.1.6'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20070816'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '2.0.0.6'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Firefox 2.0.0.6'
      AgentNameVersionMajor                : 'Firefox 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; OpenBSD sparc64; pl-PL; rv:1.8.0.2) Gecko/20060429 Firefox/1.5.0.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Sparc 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.8.0.2'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.8.0.2'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20060429'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '1.5.0.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Firefox 1.5.0.2'
      AgentNameVersionMajor                : 'Firefox 1'
      AgentLanguage                        : 'Polish (Poland)'
      AgentLanguageCode                    : 'pl-pl'
      AgentSecurity                        : 'Strong security'


- set:
    name: 'OSNamesForBrowserMatching'
    merge:
    - 'UbuntuOSName'
    - 'OSPatterns'

- matcher:
    variable:
    - 'Browser                             :agent.product.name?OSNamesForBrowserMatching^'
    extract:
    - 'AgentVersion                        :     2000 : @Browser.(2)version?!OSNamesForBrowserMatching'
    - 'AgentName                           :     2000 : @Browser.(1)version?!OSNamesForBrowserMatching'

- test:
    input:
      user_agent_string: 'Mozilla/6.0 (X11; U; Linux x86_64; en-US; rv:2.9.0.3) Gecko/2009022510 FreeBSD/ Sunrise/4.0.1/like Safari'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '4.0.1'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FreeBSD 4.0.1'
      OperatingSystemNameVersionMajor      : 'FreeBSD 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '2.9.0.3'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Gecko 2.9.0.3'
      LayoutEngineNameVersionMajor         : 'Gecko 2'
      LayoutEngineBuild                    : '2009022510'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sunrise'
      AgentVersion                         : '4.0.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Sunrise 4.0.1'
      AgentNameVersionMajor                : 'Sunrise 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/9.01 (X11; OpenBSD i386; U; en)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '9.01'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Opera 9.01'
      AgentNameVersionMajor                : 'Opera 9'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; FreeBSD 8.2-STABLE i386; U; en) Presto/2.9.168 Version/11.50'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '8.2-STABLE'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'FreeBSD 8.2-STABLE'
      OperatingSystemNameVersionMajor      : 'FreeBSD 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.9.168'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.9.168'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '11.50'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Opera 11.50'
      AgentNameVersionMajor                : 'Opera 11'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- matcher:
    require:
    - 'agent.(1-4)product.comments.entry[1]="Indy"'
    extract:
    - 'DeviceClass                         :        1 : "Desktop"'
    - 'DeviceName                          :        1 : "Indy"'
    - 'DeviceBrand                         :        1 : "Silicon Graphics"'
    - 'OperatingSystemClass                :        1 : "Desktop"'
    - 'OperatingSystemName                 :        1 : "Irix"'
    - 'OperatingSystemVersion              :        1 : "<<<null>>>"'

- test:
    input:
      user_agent_string: 'Mozilla/3.0 (compatible; Indy Library)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Silicon Graphics Indy'
      DeviceBrand                          : 'Silicon Graphics'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Irix'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Irix ??'
      OperatingSystemNameVersionMajor      : 'Irix ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '3.0'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'Mozilla 3.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Netscape 3.0'
      AgentNameVersionMajor                : 'Netscape 3'
