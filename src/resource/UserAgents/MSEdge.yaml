#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# https://msdn.microsoft.com/en-us/library/ms537503(v=vs.85).aspx

config:

# https://msdn.microsoft.com/en-us/library/hh869301(v=vs.85).aspx
# User-agent strings for Microsoft Edge

# Desktop
# Mozilla/5.0 (Windows NT 10.0; <64-bit tags>) AppleWebKit/<WebKit Rev> (KHTML, like Gecko) Chrome/<Chrome Rev> Safari/<WebKit Rev> Edge/<EdgeHTML Rev>.<Windows Build>

# Mobile:
# Mozilla/5.0 (Windows Phone 10.0; Android <Android Version>; <Device Manufacturer>; <Device Model>) AppleWebKit/<WebKit Rev> (KHTML, like Gecko) Chrome/<Chrome Rev> Mobile Safari/<WebKit Rev> Edge/<EdgeHTML Rev>.<Windows Build>

# Webview
# Note  "MSAppHost/<WebView Rev>" is added when EdgeHTML is hosted in a Universal Windows App using WebView.


# As clearly visible Microsoft does not include the version of the application in the useragent.
# So if we have the EdgeHTML version and the OS build in this table then we have the version of Edge.
# NOTE: Yes, MS deployed the browser as an OS update ... <face palm> ...

# 2018-12-12 Copied from https://en.wikipedia.org/wiki/Microsoft_Edge
- lookup:
    name: 'EdgeHtmlVersionToEdgeVersion'
    map:
      "12.10049" : "0.10.10049"
      "12.10051" : "0.11.10051"
      "12.10052" : "0.11.10052"
      "12.10061" : "0.11.10061"
      "12.10074" : "0.11.10074"
      "12.10080" : "0.11.10080"
      "12.10122" : "13.10122"
      "12.10130" : "15.10130"
      "12.10136" : "16.10136"
      "12.10149" : "19.10149"
      "12.10158" : "20.10158"
      "12.10159" : "20.10159"
      "12.10162" : "20.10162"
      "12.10166" : "20.10166"
      "12.10240" : "20.10240"
      "12.10525" : "20.10525"
      "12.10532" : "20.10532"
      "12.10536" : "20.10536"
      "13.10547" : "21.10547"
      "13.10549" : "21.10549"
      "13.10553" : "22.10553" # Apparently an Xbox specific version. The 22 is an educated guess.
      "13.10565" : "23.10565"
      "13.10572" : "25.10572"
      "13.10576" : "25.10576"
      "13.10581" : "25.10581"
      "13.10586" : "25.10586"
      "13.11082" : "25.11082"
      "13.11099" : "27.11099"
      "13.11102" : "28.11102"
      "13.14251" : "28.14251"
      "13.14257" : "28.14257"
      "14.14267" : "31.14267"
      "14.14271" : "31.14271"
      "14.14279" : "31.14279"
      "14.14283" : "31.14283"
      "14.14291" : "34.14291"
      "14.14295" : "34.14295"
      "14.14300" : "34.14300"
      "14.14316" : "37.14316"
      "14.14322" : "37.14322"
      "14.14327" : "37.14327"
      "14.14328" : "37.14328"
      "14.14332" : "37.14332"
      "14.14342" : "38.14342"
      "14.14352" : "38.14352"
      "14.14393" : "38.14393"
      "14.14901" : "39.14901"
      "14.14905" : "39.14905"
      "14.14915" : "39.14915"
      "14.14926" : "39.14926"
      "14.14931" : "39.14931"
      "14.14936" : "39.14936"
      "15.14942" : "39.14942"
      "15.14946" : "39.14946"
      "15.14951" : "39.14951"
      "15.14955" : "39.14955"
      "15.14959" : "39.14959"
      "15.14965" : "39.14965"
      "15.14971" : "39.14971"
      "15.14977" : "39.14977"
      "15.14986" : "39.14986"
      "15.15063" : "40.15063"
      "16.16299" : "41.16299.15"
      "17.17134" : "42.17134"
      "18.17763" : "44.17763"
      "18.18362" : "44.18362.1.0"
      "18.18363" : "44.18363"
      "18.19041" : "44.19041"
      # In addition if the Windows 10 build is not in this list we assume the base version is using the latest major
      "12"       : "20.??"
      "13"       : "28.??"
      "14"       : "39.??"
      "15"       : "40.??"
      "16"       : "41.??"
      "17"       : "42.??"
      "18"       : "44.??"


- matcher:
    variable:
    - 'EdgeHtmlVersion                     :agent.product.name="Edge"^.version'
    - 'EdgeHtmlVersionFirstWord            :@EdgeHtmlVersion[-1]'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Desktop"'
    - 'OperatingSystemClass                :        1 :"Desktop"'
    - 'OperatingSystemName                 :        1 :"Windows NT"'
    - 'OperatingSystemVersion              :        1 :"10.0"'
    - 'LayoutEngineClass                   :     2015 :"Browser"'
    - 'LayoutEngineName                    :     2015 :"EdgeHTML"'
    - 'LayoutEngineVersion                 :     2015 :@EdgeHtmlVersionFirstWord'
    - 'AgentClass                          :     2016 :"Browser"'
    - 'AgentName                           :     2016 :"Edge"'
    - 'AgentVersion                        :     2016 :LookUp[EdgeHtmlVersionToEdgeVersion;@EdgeHtmlVersionFirstWord;"<<<null>>>"]'

- matcher:
    variable:
    - 'EdgeHtmlVersion                     :agent.product.name="Edge"^.version'
    - 'EdgeHtmlVersionFirstWord            :@EdgeHtmlVersion[-1]'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Desktop"'
    - 'OperatingSystemClass                :        1 :"Desktop"'
    - 'OperatingSystemName                 :        1 :"Windows NT"'
    - 'OperatingSystemVersion              :        1 :"10.0"'
    - 'LayoutEngineClass                   :     2015 :"Browser"'
    - 'LayoutEngineName                    :     2015 :"EdgeHTML"'
    - 'LayoutEngineVersion                 :     2015 :@EdgeHtmlVersionFirstWord'
    - 'AgentClass                          :     2017 :"Browser"'
    - 'AgentName                           :     2017 :"Edge"'
    - 'AgentVersion                        :     2017 :LookUp[EdgeHtmlVersionToEdgeVersion;@EdgeHtmlVersion]'

# If it is not '??' then the second part of the Edge version is the Windows 10 BUILD number
- matcher:
    require:
    - 'agent.product.name="Edge"^.version[2]!="0"'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Desktop"'
    - 'OperatingSystemClass                :        1 :"Desktop"'
    - 'OperatingSystemName                 :        1 :"Windows NT"'
    - 'OperatingSystemVersion              :        1 :"10.0"'
    - 'OperatingSystemVersionBuild         :      100 :agent.product.name="Edge"^.version[2]'


# Edge (IE >= 12):
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36 Edge/12.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '12'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'EdgeHTML 12'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 12'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '20.??'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'Edge 20.??'
      AgentNameVersionMajor                : 'Edge 20'

# -----------------------------------------------------
# Apparently these all follow this specification
# https://docs.microsoft.com/en-us/windows-hardware/customize/mobile/mcsf/custom-user-agent-string-for-internet-explorer
# -----------------------------------------------------
# The user agent string indicates which browser you are using, its version number, and details about your system, such as operating system and version.
# A web server can use this information to provide content that is tailored for your specific browser and phone.
# The user agent string for the browser cannot be modified. By default, the string has the following format:
#
#    Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; <Manufacturer>; <Device>) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Mobile Safari/537.36 Edge/12.10166
#
# <Manufacturer> is automatically replaced with the OEM name. This is the same as the PhoneManufacturer setting value that is set as part of the customization Phone metadata in DeviceTargetingInfo.
# <Device> is replaced with the device name or phone name. This is the same as the PhoneModelName setting value that is set as part of the customization Phone metadata in DeviceTargetingInfo.
#
#Limitations and restrictions:
# - The user agent string for the browser cannot be modified outside of the customizations listed above.
# - The user agent type registry setting cannot be modified or used to change the default browser view from Mobile to Desktop.
# -----------------------------------------------------

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; NOKIA; Lumia 928) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/13.10586'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia Lumia 928'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows Phone 10.0'
      OperatingSystemNameVersionMajor      : 'Windows Phone 10'
      OperatingSystemVersionBuild          : '10586'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '25.10586'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Edge 25.10586'
      AgentNameVersionMajor                : 'Edge 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Xbox; Xbox One) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/13.10586'
    expected:
      DeviceClass                          : 'Game Console'
      DeviceName                           : 'Microsoft Xbox'
      DeviceBrand                          : 'Microsoft'
      DeviceVersion                        : 'Xbox One'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows Phone 10.0'
      OperatingSystemNameVersionMajor      : 'Windows Phone 10'
      OperatingSystemVersionBuild          : '10586'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '25.10586'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Edge 25.10586'
      AgentNameVersionMajor                : 'Edge 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; NOKIA; Lumia 730 Dual SIM) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Mobile Safari/537.36 Edge/12.10166'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia Lumia 730 Dual SIM'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows Phone 10.0'
      OperatingSystemNameVersionMajor      : 'Windows Phone 10'
      OperatingSystemVersionBuild          : '10166'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '12'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'EdgeHTML 12'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 12'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '20.10166'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'Edge 20.10166'
      AgentNameVersionMajor                : 'Edge 20'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; RM-1092) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/14.14295'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Microsoft RM-1092'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows Phone 10.0'
      OperatingSystemNameVersionMajor      : 'Windows Phone 10'
      OperatingSystemVersionBuild          : '14295'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '14'
      LayoutEngineVersionMajor             : '14'
      LayoutEngineNameVersion              : 'EdgeHTML 14'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 14'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '34.14295'
      AgentVersionMajor                    : '34'
      AgentNameVersion                     : 'Edge 34.14295'
      AgentNameVersionMajor                : 'Edge 34'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.14257'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '14257'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '28.14257'
      AgentVersionMajor                    : '28'
      AgentNameVersion                     : 'Edge 28.14257'
      AgentNameVersionMajor                : 'Edge 28'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; ARM) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/14.14291'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Windows Phone'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARM'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Mobile'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10 Mobile'
      OperatingSystemNameVersionMajor      : 'Windows 10 Mobile'
      OperatingSystemVersionBuild          : '14291'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '14'
      LayoutEngineVersionMajor             : '14'
      LayoutEngineNameVersion              : 'EdgeHTML 14'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 14'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '34.14291'
      AgentVersionMajor                    : '34'
      AgentNameVersion                     : 'Edge 34.14291'
      AgentNameVersionMajor                : 'Edge 34'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; ARM; Lumia 640 LTE) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586'
    expected:
      # WTF: Desktop OS on Mobile phone ?!?!?!
      # http://www.gsmarena.com/microsoft_lumia_640_lte-7055.php
      # OS: Microsoft Windows Phone 8.1, upgradable to Microsoft Windows 10
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia Lumia 640 LTE'
      DeviceBrand                          : 'Nokia'
      DeviceCpu                            : 'ARM'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Mobile'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10 Mobile'
      OperatingSystemNameVersionMajor      : 'Windows 10 Mobile'
      OperatingSystemVersionBuild          : '10586'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '25.10586'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Edge 25.10586'
      AgentNameVersionMajor                : 'Edge 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; ARM; Lumia 640 LTE Dual SIM) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586'
    expected:
      # http://www.gsmarena.com/microsoft_lumia_640_lte-7055.php
      # OS: Microsoft Windows Phone 8.1, upgradable to Microsoft Windows 10
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia Lumia 640 LTE Dual SIM'
      DeviceBrand                          : 'Nokia'
      DeviceCpu                            : 'ARM'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Mobile'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10 Mobile'
      OperatingSystemNameVersionMajor      : 'Windows 10 Mobile'
      OperatingSystemVersionBuild          : '10586'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '25.10586'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Edge 25.10586'
      AgentNameVersionMajor                : 'Edge 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WebView/3.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240'
    expected:
      #TODO (Low prio): What is WebView/3.0??
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '10240'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '12'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'EdgeHTML 12'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 12'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '20.10240'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'Edge 20.10240'
      AgentNameVersionMajor                : 'Edge 20'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2351.3 Safari/537.36 Edge/12.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '12'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'EdgeHTML 12'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 12'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '20.??'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'Edge 20.??'
      AgentNameVersionMajor                : 'Edge 20'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586,gzip(gfe)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '10586'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '25.10586'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Edge 25.10586'
      AgentNameVersionMajor                : 'Edge 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/14.14279'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '14279'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '14'
      LayoutEngineVersionMajor             : '14'
      LayoutEngineNameVersion              : 'EdgeHTML 14'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 14'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '31.14279'
      AgentVersionMajor                    : '31'
      AgentNameVersion                     : 'Edge 31.14279'
      AgentNameVersionMajor                : 'Edge 31'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '17763'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '18'
      LayoutEngineVersionMajor             : '18'
      LayoutEngineNameVersion              : 'EdgeHTML 18'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 18'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '44.17763'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Edge 44.17763'
      AgentNameVersionMajor                : 'Edge 44'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19041'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '19041'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '18'
      LayoutEngineVersionMajor             : '18'
      LayoutEngineNameVersion              : 'EdgeHTML 18'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 18'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '44.19041'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Edge 44.19041'
      AgentNameVersionMajor                : 'Edge 44'


# Deliberate error: An Edge version tag where the OS build is not in the lookup
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.666'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '666'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '18'
      LayoutEngineVersionMajor             : '18'
      LayoutEngineNameVersion              : 'EdgeHTML 18'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 18'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '44.??'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Edge 44.??'
      AgentNameVersionMajor                : 'Edge 44'

# Deliberate error: An Edge version tag where the major version is not in the lookup
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/666.777'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '777'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '666'
      LayoutEngineVersionMajor             : '666'
      LayoutEngineNameVersion              : 'EdgeHTML 666'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 666'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Edge ??'
      AgentNameVersionMajor                : 'Edge ??'

# =================================================
# Edge for Android & iOS
# Specs:
# https://blogs.windows.com/msedgedev/2017/10/05/microsoft-edge-ios-android-developer/
# A few notes:
# - The app/OS identifier is chosen so that it does not contain the string “Edge.”
#   This is to avoid triggering any existing UA detection logic that might accidentally decide that
#   these browsers are Microsoft Edge for Windows 10, resulting in a desktop site or something equally confusing.
# - The version number “41” is the app version number aligned across all current versions of Microsoft Edge
#   (note that for simplicity, the app version number is not currently exposed in Microsoft Edge for PC;
#   only the EdgeHTML engine version number is exposed).
# - The sub-version number is a platform-specific version number that internal version number of
#   the app on that platform.

# Specs say:
# On Android, we are using the Blink rendering engine from the Chromium browser project.
# This approach gives us more control and better performance than using the Android WebView control,
# but means that we are shipping our own copy of the rendering engine in the app.
- matcher:
    extract:
    - 'LayoutEngineClass                   :     2015 :"Browser"'
    - 'LayoutEngineName                    :     2015 :"Blink"'
    - 'LayoutEngineVersion                 :     2015 :agent.product.name="Chrome"^.version[-2]'

    - 'AgentClass                          :     2015 :"Browser"'
    - 'AgentName                           :     2015 :"Edge"'
    - 'AgentVersion                        :     2015 :agent.product.name="EdgA"^.version'

# Specs say:
# On iOS, we are using the WebKit engine, as provided by iOS in the WKWebView control.
# That means that from a compatibility perspective, Microsoft Edge for iOS should match
# the version of Safari that is currently available for iOS.
- matcher:
    extract:
    - 'LayoutEngineClass                   :     2015 :"Browser"'
    - 'LayoutEngineName                    :     2015 :"AppleWebKit"'
    - 'LayoutEngineVersion                 :     2015 :agent.product.name="AppleWebKit"^.version'

    - 'AgentClass                          :     2050 :"Browser"'
    - 'AgentName                           :     2050 :"Edge"'
    - 'AgentVersion                        :     2050 :agent.product.name="EdgiOS"^.version'

# Blink based Edge browser on Desktop
# https://blogs.windows.com/msedgedev/2019/04/08/microsoft-edge-preview-channel-details/
# Looking at the examples it __seems__
# - the "Chrome" version is actually the Blink version.
# - the "Edg"    version is actually the Edge version.
- matcher:
    extract:
    - 'LayoutEngineClass                   :     2015 :"Browser"'
    - 'LayoutEngineName                    :     2015 :"Blink"'
    - 'LayoutEngineVersion                 :     2015 :agent.product.name="Chrome"^.version[-2]'

    - 'AgentClass                          :     2015 :"Browser"'
    - 'AgentName                           :     2015 :"Edge"'
    - 'AgentVersion                        :     2015 :agent.product.name="Edg"^.version'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.145 Mobile Safari/537.36 EdgA/41.0.0.1136'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.0'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.0'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '41.0.0.1136'
      AgentVersionMajor                    : '41'
      AgentNameVersion                     : 'Edge 41.0.0.1136'
      AgentNameVersionMajor                : 'Edge 41'

# Example from specs page
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 8.0; Pixel XL Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.0 Mobile Safari/537.36 EdgA/41.1.35.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Pixel XL'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'OPP3.170518.006'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.0'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.0'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '41.1.35.1'
      AgentVersionMajor                    : '41'
      AgentNameVersion                     : 'Edge 41.1.35.1'
      AgentNameVersionMajor                : 'Edge 41'

# Example from specs page
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_2 like Mac OS X) AppleWebKit/603.2.4 (KHTML, like Gecko) Mobile/14F89 Safari/603.2.4 EdgiOS/41.1.35.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14F89'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3.2'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '603.2.4'
      LayoutEngineVersionMajor             : '603'
      LayoutEngineNameVersion              : 'AppleWebKit 603.2.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 603'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '41.1.35.1'
      AgentVersionMajor                    : '41'
      AgentNameVersion                     : 'Edge 41.1.35.1'
      AgentNameVersionMajor                : 'Edge 41'

# ===============================================

# MSAppHost means webview

- matcher:
    require:
    - 'agent.product.name="Edge"'
    extract:
    - 'AgentClass                          :    10000 :"Browser Webview"'
    - 'AgentName                           :    10000 :"Edge Webview"'
    - 'AgentVersion                        :     2500 :agent.(1)product.(1)comments.entry.(1-4)product.name="MSAppHost"^.version'
    - 'WebviewAppName                      :        0 :"Unknown Webview App"'
    - 'WebviewAppVersion                   :        0 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.product.name="Edge"'
    extract:
    - 'AgentClass                          :    10000 :"Browser Webview"'
    - 'AgentName                           :    10000 :"Edge Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="MSAppHost"^.version'
    - 'WebviewAppName                      :        0 :"Unknown Webview App"'
    - 'WebviewAppVersion                   :        0 :"<<<null>>>"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; MSAppHost/3.0; Microsoft; Virtual) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/13.10586'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Microsoft Virtual'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows Phone 10.0'
      OperatingSystemNameVersionMajor      : 'Windows Phone 10'
      OperatingSystemVersionBuild          : '10586'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Edge Webview'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Edge Webview 3.0'
      AgentNameVersionMajor                : 'Edge Webview 3'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


# Manipulated to make it look like Windows 7. Edge only runs on Windows 10
- test:
    input:
      user_agent_string: 'Windows 7 (Internet explorer 9) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows NT 10.0'
      OperatingSystemNameVersionMajor      : 'Windows NT 10'
      OperatingSystemVersionBuild          : '10586'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '13'
      LayoutEngineVersionMajor             : '13'
      LayoutEngineNameVersion              : 'EdgeHTML 13'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 13'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '25.10586'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Edge 25.10586'
      AgentNameVersionMajor                : 'Edge 25'


# Source: https://venturebeat.com/2019/04/08/microsoft-launches-first-chromium-edge-builds-for-windows-10/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.48 Safari/537.36 Edg/74.1.96.24'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '74.0'
      LayoutEngineVersionMajor             : '74'
      LayoutEngineNameVersion              : 'Blink 74.0'
      LayoutEngineNameVersionMajor         : 'Blink 74'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '74.1.96.24'
      AgentVersionMajor                    : '74'
      AgentNameVersion                     : 'Edge 74.1.96.24'
      AgentNameVersionMajor                : 'Edge 74'


# Source: https://www.ghacks.net/2019/04/21/new-microsoft-edge-may-change-user-agent-automatically/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3763.0 Safari/537.36 Edg/75.0.131.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '75.0'
      LayoutEngineVersionMajor             : '75'
      LayoutEngineNameVersion              : 'Blink 75.0'
      LayoutEngineNameVersionMajor         : 'Blink 75'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '75.0.131.0'
      AgentVersionMajor                    : '75'
      AgentNameVersion                     : 'Edge 75.0.131.0'
      AgentNameVersionMajor                : 'Edge 75'

# https://www.microsoftedgeinsider.com/en-us/download/
# Useragent from the canary version of 2019-05-24 on Windows 10
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3800.0 Safari/537.36 Edg/76.0.168.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '76.0'
      LayoutEngineVersionMajor             : '76'
      LayoutEngineNameVersion              : 'Blink 76.0'
      LayoutEngineNameVersionMajor         : 'Blink 76'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '76.0.168.0'
      AgentVersionMajor                    : '76'
      AgentNameVersion                     : 'Edge 76.0.168.0'
      AgentNameVersionMajor                : 'Edge 76'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3800.0 Safari/537.36 Edg/76.0.168.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.14.5'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.14.5'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '76.0'
      LayoutEngineVersionMajor             : '76'
      LayoutEngineNameVersion              : 'Blink 76.0'
      LayoutEngineNameVersionMajor         : 'Blink 76'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '76.0.168.0'
      AgentVersionMajor                    : '76'
      AgentNameVersion                     : 'Edge 76.0.168.0'
      AgentNameVersionMajor                : 'Edge 76'


# https://docs.microsoft.com/en-us/microsoft-edge/web-platform/user-agent-string
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.74 Safari/537.36 Edg/79.0.309.43'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '79.0'
      LayoutEngineVersionMajor             : '79'
      LayoutEngineNameVersion              : 'Blink 79.0'
      LayoutEngineNameVersionMajor         : 'Blink 79'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '79.0.309.43'
      AgentVersionMajor                    : '79'
      AgentNameVersion                     : 'Edge 79.0.309.43'
      AgentNameVersionMajor                : 'Edge 79'

# Microsoft Edge Version 88.0.702.0 (Official build) dev (64-bit)
# running on Ubuntu 20.04 on an Intel i7 (i.e. 64 bit cpu)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4321.0 Safari/537.36 Edg/88.0.702.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '88.0'
      LayoutEngineVersionMajor             : '88'
      LayoutEngineNameVersion              : 'Blink 88.0'
      LayoutEngineNameVersionMajor         : 'Blink 88'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '88.0.702.0'
      AgentVersionMajor                    : '88'
      AgentNameVersion                     : 'Edge 88.0.702.0'
      AgentNameVersionMajor                : 'Edge 88'

# Edge on Mac
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Mac OS X ??'
      OperatingSystemNameVersionMajor      : 'Mac OS X ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '90.0'
      LayoutEngineVersionMajor             : '90'
      LayoutEngineNameVersion              : 'Blink 90.0'
      LayoutEngineNameVersionMajor         : 'Blink 90'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '90.0.818.51'
      AgentVersionMajor                    : '90'
      AgentNameVersion                     : 'Edge 90.0.818.51'
      AgentNameVersionMajor                : 'Edge 90'
