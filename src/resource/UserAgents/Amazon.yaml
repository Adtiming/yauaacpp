#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:
# https://developer.amazon.com/public/solutions/devices/kindle-fire/specifications/01-device-and-feature-specifications
# https://developer.amazon.com/public/solutions/devices/fire-tablets/specifications/04-user-agent-strings
# http://docs.aws.amazon.com/silk/latest/developerguide/user-agent.html
# http://docs.aws.amazon.com/silk/latest/developerguide/screen-size.html
# https://developer.amazon.com/public/solutions/devices/fire-phone/docs/fire-phone-user-agent-strings
# https://developer.amazon.com/docs/fire-tablets/ft-user-agent-strings.html

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.name[1]="Amazon"'
    extract:
    - 'DeviceBrand                         :      500 :"Amazon"'
    - 'DeviceCpu                           :      100 :"<<<null>>>"'
    - 'OperatingSystemClass                :     1000 :"Mobile"'
    - 'OperatingSystemName                 :     1000 :"FireOS"'
    - 'OperatingSystemVersion              :     1000 :agent.(1)product.(1)comments.entry.(1)product.name="Android"^.version'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.name[1]="Fire"'
    extract:
    - 'DeviceBrand                         :      500 :"Amazon"'
    - 'DeviceCpu                           :      100 :"<<<null>>>"'
    - 'OperatingSystemClass                :     1000 :"Mobile"'
    - 'OperatingSystemName                 :     1000 :"FireOS"'
    - 'OperatingSystemVersion              :     1000 :agent.(1)product.(1)comments.entry.(1)product.name="Android"^.version'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.name[1]="Kindle"'
    extract:
    - 'DeviceBrand                         :      500 :"Amazon"'
    - 'DeviceCpu                           :      100 :"<<<null>>>"'
    - 'OperatingSystemClass                :     1000 :"Mobile"'
    - 'OperatingSystemName                 :     1000 :"FireOS"'
    - 'OperatingSystemVersion              :     1000 :agent.(1)product.(1)comments.entry.(1)product.name="Android"^.version'

- matcher:
    variable:
    - 'Kindle                              :agent.product.name="Kindle"'
    extract:
    - 'DeviceClass                         :      500 :"eReader"'
    - 'DeviceName                          :      500 :"Kindle"'
    - 'DeviceBrand                         :      500 :"Amazon"'
    - 'DeviceVersion                       :      500 :@Kindle^.version'
    - 'OperatingSystemClass                :     1000 :"Mobile"'
    - 'OperatingSystemName                 :     1000 :"FireOS"'
    - 'OperatingSystemVersion              :     1000 :"<<<null>>>"'

# https://docs.aws.amazon.com/silk/latest/developerguide/user-agent.html
# ---------------------------
# User Agent Strings and Detection
# In the user agent request header field, Amazon Silk sends one of three user agent strings,
# depending on the view requested on the device by the customer.
# If a specific view is not requested, the view defaults to Tablet for Fire tablets,
# and Mobile for Fire phones. If a site has compatibility issues when rendered in the default view,
# a different view may be selected by the device. The templates for the Amazon Silk user agents are shown below.
#
# Tablet
#   Mozilla/5.0 (Linux; Android android-version; product-model Build/product-build)
#     AppleWebKit/webkit-version (KHTML, like Gecko)
#     Silk/browser-version like Chrome/chrome-version Safari/webkit-version
#
# Desktop
#   Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/webkit-version (KHTML, like Gecko)
#     Silk/browser-version like Chrome/chrome-version Safari/webkit-version
#
# Mobile
#   Mozilla/5.0 (Linux; Android android-version; product-model Build/product-build)
#     AppleWebKit/webkit-version (KHTML, like Gecko)
#     Silk/browser-version like Chrome/chrome-version Mobile Safari/webkit-version
# ---------------------------

# Analysis of this: The user can specify what lie the useragent should reflect to get the desired result from the website.


# All devices with Silk run on Fire OS which is an Android based system.
# https://en.wikipedia.org/wiki/Fire_OS

# Silk browser

- matcher:
    require:
    - 'agent.product.name="Safari"'
    extract:
    - 'DeviceClass                         :       98 :"Tablet"'
    - 'DeviceName                          :       98 :"Amazon Kindle Fire"'
    - 'DeviceBrand                         :       98 :"Amazon"'
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'AgentClass                          :     1000 :"Browser"'
    - 'AgentName                           :     1000 :"Silk"'
    - 'AgentVersion                        :     1000 :agent.product.name="Silk"^.version'

- matcher:
    require:
    - 'agent.product.name="Mobile Safari"'
    extract:
    - 'DeviceClass                         :       98 :"Phone"'
    - 'DeviceName                          :       98 :"Amazon Kindle Fire"'
    - 'DeviceBrand                         :       98 :"Amazon"'
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'AgentClass                          :     1000 :"Browser"'
    - 'AgentName                           :     1000 :"Silk"'
    - 'AgentVersion                        :     1000 :agent.product.name="Silk"^.version'

- matcher:
    require:
    - 'agent.product.name="Safari"'
    extract:
    - 'DeviceClass                         :       98 :"Tablet"'
    - 'DeviceName                          :       98 :"Amazon Kindle Fire"'
    - 'DeviceBrand                         :       98 :"Amazon"'
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'AgentClass                          :     1000 :"Browser"'
    - 'AgentName                           :     1000 :"Silk"'
    - 'AgentVersion                        :     1000 :agent.product.(1)comments.entry.(1)product.name="Silk"^.version'

- matcher:
    require:
    - 'agent.product.name="Mobile Safari"'
    extract:
    - 'DeviceClass                         :       98 :"Phone"'
    - 'DeviceName                          :       98 :"Amazon Kindle Fire"'
    - 'DeviceBrand                         :       98 :"Amazon"'
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'AgentClass                          :     1000 :"Browser"'
    - 'AgentName                           :     1000 :"Silk"'
    - 'AgentVersion                        :     1000 :agent.product.(1)comments.entry.(1)product.name="Silk"^.version'

- matcher:
    require:
    - 'agent.product.name="Silk"'
    extract:
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :     1000 :"Mobile"'
    - 'OperatingSystemName                 :     1000 :"FireOS"'
    - 'OperatingSystemVersion              :     1000 :agent.(1)product.(1)comments.entry.(1)product.name="Android"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.4; en-gb; SD4930UR Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko) Silk/3.58 like Chrome/37.0.2026.117 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Amazon Fire Phone'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.4.4'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '3.58'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Silk 3.58'
      AgentNameVersionMajor                : 'Silk 3'
      AgentLanguage                        : 'English (United Kingdom)'
      AgentLanguageCode                    : 'en-gb'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.3; KFTHWI Build/KTU84M) AppleWebKit/537.36 (KHTML, like Gecko) Silk/44.1.54 like Chrome/44.0.2403.63 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire HDX 7 (WI-FI) (3RD GEN-2013)'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.4.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.4.3'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'KTU84M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '44.1.54'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Silk 44.1.54'
      AgentNameVersionMajor                : 'Silk 44'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Silk/44.1.54 like Chrome/44.0.2403.63 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FireOS ??'
      OperatingSystemNameVersionMajor      : 'FireOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '44.1.54'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Silk 44.1.54'
      AgentNameVersionMajor                : 'Silk 44'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Silk/63.1.34 like Chrome/63.0.3239.111 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FireOS ??'
      OperatingSystemNameVersionMajor      : 'FireOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '63.1.34'
      AgentVersionMajor                    : '63'
      AgentNameVersion                     : 'Silk 63.1.34'
      AgentNameVersionMajor                : 'Silk 63'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.3; KFTHWI Build/KTU84M) AppleWebKit/537.36 (KHTML, like Gecko) Silk/44.1.54 like Chrome/44.0.2403.63 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire HDX 7 (WI-FI) (3RD GEN-2013)'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.4.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.4.3'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'KTU84M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '44.1.54'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Silk 44.1.54'
      AgentNameVersionMajor                : 'Silk 44'
      AgentSecurity                        : 'Strong security'




- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.2.2; Amazon Kindle Fire Build/JDQ39E) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.82 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.2.2'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'JDQ39E'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '30.0.1599.82'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome 30.0.1599.82'
      AgentNameVersionMajor                : 'Chrome 30'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; Fire Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Amazon Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.4.2'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; Fire Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/64.0.0.52.76;]'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Amazon Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.4.2'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Facebook App for Android'
      WebviewAppVersion                    : '64.0.0.52.76'
      WebviewAppVersionMajor               : '64'
      WebviewAppNameVersion                : 'Facebook App for Android 64.0.0.52.76'
      WebviewAppNameVersionMajor           : 'Facebook App for Android 64'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; Fire Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36 [Pinterest/Android]'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Amazon Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.4.2'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; Kindle Fire HDX Build/LVY48F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.83 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire HDX'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'FireOS 5.1.1'
      OperatingSystemNameVersionMajor      : 'FireOS 5'
      OperatingSystemVersionBuild          : 'LVY48F'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '47.0.2526.83'
      AgentVersionMajor                    : '47'
      AgentNameVersion                     : 'Chrome 47.0.2526.83'
      AgentNameVersionMajor                : 'Chrome 47'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.4; Fire Phone Build/KTU84Q) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/33.0.0.0 Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/86.0.0.19.69;]'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Amazon Fire Phone'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'FireOS 4.4.4'
      OperatingSystemNameVersionMajor      : 'FireOS 4'
      OperatingSystemVersionBuild          : 'KTU84Q'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '33.0.0.0'
      AgentVersionMajor                    : '33'
      AgentNameVersion                     : 'Chrome Webview 33.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 33'
      WebviewAppName                       : 'Facebook App for Android'
      WebviewAppVersion                    : '86.0.0.19.69'
      WebviewAppVersionMajor               : '86'
      WebviewAppNameVersion                : 'Facebook App for Android 86.0.0.19.69'
      WebviewAppNameVersionMajor           : 'Facebook App for Android 86'


# UA for Kindle Fire 1st Generation
# The UA for the Kindle Fire 1st Generation follows a slightly different syntax.

# Desktop/Tablet
#   Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_3; en-us; Silk/1.0.13.81_10003810)
#     AppleWebKit/533.16 (KHTML, like Gecko) Version/5.0 Safari/533.16 Silk-Accelerated=true

# Mobile
#   Mozilla/5.0 (Linux; U; Android 2.3.4; en-us; Silk/1.0.13.81_10003810)
#     AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 Silk-Accelerated=true

- matcher:
    extract:
    - 'DeviceClass                         :       99 :"Tablet"'
    - 'DeviceName                          :      100 :"Amazon Kindle Fire"'
    - 'DeviceBrand                         :      100 :"Amazon"'
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'AgentClass                          :      100 :"Browser"'
    - 'AgentName                           :      100 :"Silk"'
    - 'AgentVersion                        :      100 :agent.(1)product.(1)comments.entry.(1)product.name="Silk"^.version'

- matcher:
    require:
    - 'agent.product.name="Silk"'
    extract:
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :     1000 :"Mobile"'
    - 'OperatingSystemName                 :     1000 :"FireOS"'
    - 'OperatingSystemVersion              :       99 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.name="Silk"'
    extract:
    - 'DeviceCpu                           :     1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :     1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :     1000 :"Mobile"'
    - 'OperatingSystemName                 :     1000 :"FireOS"'
    - 'OperatingSystemVersion              :       99 :"<<<null>>>"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_3; en-us; Silk/1.0.13.81_10003810) AppleWebKit/533.16 (KHTML, like Gecko) Version/5.0 Safari/533.16 Silk-Accelerated=true'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FireOS ??'
      OperatingSystemNameVersionMajor      : 'FireOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.16'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.16'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '1.0.13.81_10003810'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Silk 1.0.13.81_10003810'
      AgentNameVersionMajor                : 'Silk 1'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 2.3.4; en-us; Silk/1.0.13.81_10003810) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 Silk-Accelerated=true'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '2.3.4'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'FireOS 2.3.4'
      OperatingSystemNameVersionMajor      : 'FireOS 2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '1.0.13.81_10003810'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Silk 1.0.13.81_10003810'
      AgentNameVersionMajor                : 'Silk 1'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'




- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_3; en-us; Silk/1.0.146.3-Gen4_12000410) AppleWebKit/533.16 (KHTML, like Gecko) Version/5.0 Safari/533.16 Silk-Accelerated=true'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FireOS ??'
      OperatingSystemNameVersionMajor      : 'FireOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.16'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.16'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '1.0.146.3-Gen4_12000410'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Silk 1.0.146.3-Gen4_12000410'
      AgentNameVersionMajor                : 'Silk 1'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Silk/67.4.1 like Chrome/67.0.3396.87 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FireOS ??'
      OperatingSystemNameVersionMajor      : 'FireOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '67.4.1'
      AgentVersionMajor                    : '67'
      AgentNameVersion                     : 'Silk 67.4.1'
      AgentNameVersionMajor                : 'Silk 67'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Silk/65.3.1 like Chrome/65.0.3325.144 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Kindle Fire'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FireOS ??'
      OperatingSystemNameVersionMajor      : 'FireOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '65.3.1'
      AgentVersionMajor                    : '65'
      AgentNameVersion                     : 'Silk 65.3.1'
      AgentNameVersionMajor                : 'Silk 65'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; KFFOWI Build/LMY47O) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/41.51020.2250.0246 Mobile Safari/537.36 cordova-amazon-fireos/3.4.0 AmazonWebAppPlatform/3.4.0;2.0'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Fire (5TH GEN-2015)'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '3.4.0'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'FireOS 3.4.0'
      OperatingSystemNameVersionMajor      : 'FireOS 3'
      OperatingSystemVersionBuild          : 'LMY47O'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '41.51020'
      LayoutEngineVersionMajor             : '41'
      LayoutEngineNameVersion              : 'Blink 41.51020'
      LayoutEngineNameVersionMajor         : 'Blink 41'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '41.51020.2250.0246'
      AgentVersionMajor                    : '41'
      AgentNameVersion                     : 'Chrome Webview 41.51020.2250.0246'
      AgentNameVersionMajor                : 'Chrome Webview 41'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; KFTRWI) AppleWebKit/537.36 (KHTML, like Gecko) Silk/93.3.46 like Chrome/93.0.4577.82 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Fire HD 10 (11TH GEN-2021) (3GB)'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'FireOS 7'
      OperatingSystemNameVersionMajor      : 'FireOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '93.3.46'
      AgentVersionMajor                    : '93'
      AgentNameVersion                     : 'Silk 93.3.46'
      AgentNameVersionMajor                : 'Silk 93'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; KFMUWI) AppleWebKit/537.36 (KHTML, like Gecko) Silk/93.3.46 like Chrome/93.0.4577.82 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Fire 7 (9TH GEN-2019)'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'FireOS 7'
      OperatingSystemNameVersionMajor      : 'FireOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '93.3.46'
      AgentVersionMajor                    : '93'
      AgentNameVersion                     : 'Silk 93.3.46'
      AgentNameVersionMajor                : 'Silk 93'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; KFMUWI) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Amazon Fire 7 (9TH GEN-2019)'
      DeviceBrand                          : 'Amazon'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '5'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'FireOS 5'
      OperatingSystemNameVersionMajor      : 'FireOS 5'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '93.0'
      LayoutEngineVersionMajor             : '93'
      LayoutEngineNameVersion              : 'Blink 93.0'
      LayoutEngineNameVersionMajor         : 'Blink 93'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '93.0.4577.82'
      AgentVersionMajor                    : '93'
      AgentNameVersion                     : 'Chrome 93.0.4577.82'
      AgentNameVersionMajor                : 'Chrome 93'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.2; AFTTIFF55) AppleWebKit/537.36 (KHTML, like Gecko) Silk/87.2.4 like Chrome/87.0.4280.141 Safari/537.36'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Onida HD/FHD-Fire TV (2020)'
      DeviceBrand                          : 'Onida'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'FireOS'
      OperatingSystemVersion               : '6'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'FireOS 6'
      OperatingSystemNameVersionMajor      : 'FireOS 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Silk'
      AgentVersion                         : '87.2.4'
      AgentVersionMajor                    : '87'
      AgentNameVersion                     : 'Silk 87.2.4'
      AgentNameVersionMajor                : 'Silk 87'
