#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

- test:
    input:
      user_agent_string: 'nessus'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Nessus'

- test:
    input:
      user_agent_string: 'NESSUS::SOAP'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Nessus'

- test:
    input:
      user_agent_string: 'Nessus SOAP v0.0.1 (Nessus.org)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      AgentInformationUrl                  : 'Nessus.org'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Nessus'

- test:
    input:
      user_agent_string: '"nessus=<!--#exec cmd=\""cat /etc/passwd\""-->"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Serverside execute'
      HackerToolkit                        : 'Nessus'

- test:
    input:
      user_agent_string: '"<!--#exec cmd=\""cat /etc/passwd\""-->"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Serverside execute'
      HackerToolkit                        : 'Unknown'

- test:
    input:
      user_agent_string: '"nessus=<!--#include file=\""nessus405480938.html\""-->"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Serverside include'
      HackerToolkit                        : 'Nessus'

- test:
    input:
      user_agent_string: '"''\""--></style></scRipt><scRipt>netsparker(0x0000D3)</scRipt>"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Code Injection'
      HackerToolkit                        : 'Netsparker'


- test:
    input:
      user_agent_string: 'a {'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'

# Completely empty --> must be hacker.
- test:
    input:
      user_agent_string: ''
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'

- test:
    input:
      user_agent_string: '"}__test|O:21:\""JDatabaseDriverMysqli\"":3:{s:2:\""fc\"";O:17:\""JSimplepieFactory\"":0:{}s:21:\" Useragent was cut"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Remote exec Joomla'
      HackerToolkit                        : 'Unknown'


- test:
    input:
      user_agent_string: '${9999072+10000055}'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


- test:
    input:
      user_agent_string: '!(()&&!|*|*|'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Fuzzing'
      HackerToolkit                        : 'Unknown'

- test:
    input:
      user_agent_string: '"&nslookup aCCYKsw4&''\\\""`0&nslookup aCCYKsw4&`''"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Code Injection'
      HackerToolkit                        : 'Unknown'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:32.0) Gecko/20100101 Firefox/32.0 BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR BLNGBAR'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Buffer overflow'
      HackerToolkit                        : 'Unknown'


# What is this? __CT_JOB_ID__ looks like a spider/hacker of some sort, but is it?
- test:
    input:
      user_agent_string: ';__CT_JOB_ID__:7c745571-46aa-43a7-a2a5-68cdf1a4e9f5;'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      AgentUuid                            : '7c745571-46aa-43a7-a2a5-68cdf1a4e9f5'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


# Deliberate syntax error AND not setting any of the values to trigger the "This is a Hacker" fallback code.
- test:
    input:
      user_agent_string: 'BA7D96A3-49DB-48AF-9166-F7043A8866A7 { x }'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      AgentUuid                            : 'BA7D96A3-49DB-48AF-9166-F7043A8866A7'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'


# Confusing edge case:
# - Just a text without version --> Hacker.
# - That contains 'bot' --> Robot
- test:
    input:
      user_agent_string: 'robots'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robots'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'robots'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'robots ??'
      LayoutEngineNameVersionMajor         : 'robots ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Robots'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Robots ??'
      AgentNameVersionMajor                : 'Robots ??'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


# Confusing edge case:
# - Just a text without version --> Hacker.
# - That contains 'bot' --> Robot
- test:
    input:
      user_agent_string: 'ServiceUptime.robot'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'ServiceUptime.robot'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'ServiceUptime.robot'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'ServiceUptime.robot ??'
      LayoutEngineNameVersionMajor         : 'ServiceUptime.robot ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'ServiceUptime.robot'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'ServiceUptime.robot ??'
      AgentNameVersionMajor                : 'ServiceUptime.robot ??'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


- test:
    input:
      user_agent_string: 'ed47e${885*910}wgadh'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'

- test:
    input:
      user_agent_string: 'eda5h{{701*381}}vwb9m'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Code Injection'

- test:
    input:
      user_agent_string: 'invalid../../../../../../../../../../etc/passwd/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././.'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Buffer overflow'
      HackerToolkit                        : 'Unknown'

- test:
    input:
      user_agent_string: '() { _; } >_[$($())] { echo Content-Type: text/plain ; echo ; echo \"bash_cve_2014_6278 Output : $((37+34))\"; }'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Code Injection'

- test:
    input:
      user_agent_string: '() { ignored; }; echo Content-Type: text/plain ; echo ; echo \"bash_cve_2014_6271_rce Output : $((70+95))\"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Code Injection'
