#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# Bing crawlers as documented on these pages:
# https://www.bing.com/webmaster/help/which-crawlers-does-bing-use-8c184ec0
# http://blogs.bing.com/webmaster/2014/11/03/meet-our-mobile-bots/


isBingPreview: &isBingPreview
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Microsoft BingPreview'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'BingPreview'
      LayoutEngineVersion                  : '1.0b'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'BingPreview 1.0b'
      LayoutEngineNameVersionMajor         : 'BingPreview 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'BingPreview'
      AgentVersion                         : '1.0b'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BingPreview 1.0b'
      AgentNameVersionMajor                : 'BingPreview 1'

isBingPreviewMobile: &isBingPreviewMobile
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Microsoft BingPreview'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'BingPreview'
      LayoutEngineVersion                  : '1.0b'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'BingPreview 1.0b'
      LayoutEngineNameVersionMajor         : 'BingPreview 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'BingPreview'
      AgentVersion                         : '1.0b'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BingPreview 1.0b'
      AgentNameVersionMajor                : 'BingPreview 1'


config:

- matcher:
    variable:
    - 'BingbotVersion                      :agent.product.name="bingbot"^.version'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"BingBot"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :"Bingbot"'
    - 'LayoutEngineVersion                 :   300000 :@BingbotVersion'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :"Bingbot"'
    - 'AgentVersion                        :   300000 :@BingbotVersion'

- matcher:
    variable:
    - 'BingbotVersion                      :agent.product.(1)comments.entry.(1-4)product.name="bingbot"^.version'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"BingBot"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :"Bingbot"'
    - 'LayoutEngineVersion                 :   300000 :@BingbotVersion'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :"Bingbot"'
    - 'AgentVersion                        :   300000 :@BingbotVersion'


- matcher:
    variable:
    - 'msnbot                              :agent.product.name[1]="msnbot"'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"MsnBot"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :@msnbot@'
    - 'LayoutEngineVersion                 :   300000 :@msnbot^.version'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :@msnbot@'
    - 'AgentVersion                        :   300000 :@msnbot^.version'

- matcher:
    variable:
    - 'msnbot                              :agent.product.(1)comments.entry.(1-4)product.name[1]="msnbot"'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"MsnBot"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :@msnbot@'
    - 'LayoutEngineVersion                 :   300000 :@msnbot^.version'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :@msnbot@'
    - 'AgentVersion                        :   300000 :@msnbot^.version'


- matcher:
    variable:
    - 'adidxbot                            :agent.product.name[1]="adidxbot"'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"Adidxbot"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :@adidxbot@'
    - 'LayoutEngineVersion                 :   300000 :@adidxbot^.version'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :@adidxbot@'
    - 'AgentVersion                        :   300000 :@adidxbot^.version'

- matcher:
    variable:
    - 'adidxbot                            :agent.product.(1)comments.entry.(1-4)product.name[1]="adidxbot"'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"Adidxbot"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :@adidxbot@'
    - 'LayoutEngineVersion                 :   300000 :@adidxbot^.version'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :@adidxbot@'
    - 'AgentVersion                        :   300000 :@adidxbot^.version'

- matcher:
    variable:
    - 'BingPreviewVersion                  :agent.product.name="BingPreview"^.version'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"BingPreview"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :"BingPreview"'
    - 'LayoutEngineVersion                 :   300000 :@BingPreviewVersion'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :"BingPreview"'
    - 'AgentVersion                        :   300000 :@BingPreviewVersion'


# There are cases where the 'bingpreview' is preceded by 'like gecko'
- matcher:
    variable:
    - 'BingPreviewVersion                  :agent.product.name[3]="BingPreview"^.version'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"BingPreview"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :"BingPreview"'
    - 'LayoutEngineVersion                 :   300000 :@BingPreviewVersion'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :"BingPreview"'
    - 'AgentVersion                        :   300000 :@BingPreviewVersion'

- matcher:
    variable:
    - 'BingPreviewVersion                  :agent.product.(1)comments.entry.(1-4)product.name="BingPreview"^.version'
    extract:
    - '__Set_ALL_Fields__                  :   299900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   300000 :"Robot"'
    - 'DeviceBrand                         :   300000 :"Microsoft"'
    - 'DeviceName                          :   300000 :"BingPreview"'
    - 'OperatingSystemClass                :   300000 :"Cloud"'
    - 'OperatingSystemName                 :   300000 :"Microsoft Cloud"'
    - 'OperatingSystemVersion              :   300000 :"Microsoft Azure"'
    - 'OperatingSystemNameVersion          :   300000 :"Microsoft Azure"'
    - 'LayoutEngineClass                   :   300000 :"Robot"'
    - 'LayoutEngineName                    :   300000 :"BingPreview"'
    - 'LayoutEngineVersion                 :   300000 :@BingPreviewVersion'
    - 'AgentClass                          :   300000 :"Robot"'
    - 'AgentName                           :   300000 :"BingPreview"'
    - 'AgentVersion                        :   300000 :@BingPreviewVersion'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="bingbot"'
    - 'agent.product.(1)comments.entry.(1)product.name="Windows Phone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="bingbot"'
    - 'agent.product.(1)comments.entry.(1)product.name="Android"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="bingbot"'
    - 'agent.product.(1)comments.entry.(1)text="iPhone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)text="iPhone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)product.name="Windows Phone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)product.name="Android"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'


- matcher:
    require:
    - 'agent.product.name="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)text="iPhone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.name="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)product.name="Windows Phone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.name="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)product.name="Android"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.name[3]="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)text="iPhone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.name[3]="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)product.name="Windows Phone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.name[3]="bingpreview"'
    - 'agent.product.(1)comments.entry.(1)product.name="Android"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="Adidxbot"'
    - 'agent.product.(1)comments.entry.(1)text="iPhone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="Adidxbot"'
    - 'agent.product.(1)comments.entry.(1)product.name="Windows Phone"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1-2)product.name="Adidxbot"'
    - 'agent.product.(1)comments.entry.(1)product.name="Android"'
    extract:
    - 'DeviceClass                         :   300100 :"Robot Mobile"'


# Bingbot is our standard crawler and handles most of our crawling needs each day.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Microsoft BingBot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Bingbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Bingbot 2.0'
      LayoutEngineNameVersionMajor         : 'Bingbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Bingbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Bingbot 2.0'
      AgentNameVersionMajor                : 'Bingbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'

# Difference is the missing semi colon
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; bingbot/2.0 +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Microsoft BingBot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Bingbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Bingbot 2.0'
      LayoutEngineNameVersionMajor         : 'Bingbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Bingbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Bingbot 2.0'
      AgentNameVersionMajor                : 'Bingbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Microsoft BingBot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Bingbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Bingbot 2.0'
      LayoutEngineNameVersionMajor         : 'Bingbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Bingbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Bingbot 2.0'
      AgentNameVersionMajor                : 'Bingbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 8.1; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; NOKIA; Lumia 530) like Gecko (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Microsoft BingBot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Bingbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Bingbot 2.0'
      LayoutEngineNameVersionMajor         : 'Bingbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Bingbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Bingbot 2.0'
      AgentNameVersionMajor                : 'Bingbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'

# MSNBot used to be our standard crawler before the advent of Bingbot and still handles some of our crawling duties.
- test:
    input:
      user_agent_string: 'msnbot/2.0b (+http://search.msn.com/msnbot.htm)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Microsoft Msnbot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'msnbot'
      LayoutEngineVersion                  : '2.0b'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'msnbot 2.0b'
      LayoutEngineNameVersionMajor         : 'msnbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Msnbot'
      AgentVersion                         : '2.0b'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Msnbot 2.0b'
      AgentNameVersionMajor                : 'Msnbot 2'
      AgentInformationUrl                  : 'http://search.msn.com/msnbot.htm'

# MSNBot-Media is our crawler for images and video.
- test:
    input:
      user_agent_string: 'msnbot-media/1.1 (+http://search.msn.com/msnbot.htm)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Microsoft Msnbot-Media'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'msnbot-media'
      LayoutEngineVersion                  : '1.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'msnbot-media 1.1'
      LayoutEngineNameVersionMajor         : 'msnbot-media 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'Msnbot-Media'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Msnbot-Media 1.1'
      AgentNameVersionMajor                : 'Msnbot-Media 1'
      AgentInformationUrl                  : 'http://search.msn.com/msnbot.htm'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; adidxbot/2.0; +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Microsoft Adidxbot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'adidxbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'adidxbot 2.0'
      LayoutEngineNameVersionMajor         : 'adidxbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Adidxbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Adidxbot 2.0'
      AgentNameVersionMajor                : 'Adidxbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'

# AdIdxBot is the crawler used by Bing Ads. AdIdxBot is responsible for crawling ads and following through to websites from those ads for quality control purposes.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53 (compatible; adidxbot/2.0; +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Microsoft Adidxbot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'adidxbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'adidxbot 2.0'
      LayoutEngineNameVersionMajor         : 'adidxbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Adidxbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Adidxbot 2.0'
      AgentNameVersionMajor                : 'Adidxbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 8.1; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; NOKIA; Lumia 530) like Gecko (compatible; adidxbot/2.0; +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Microsoft Adidxbot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'adidxbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'adidxbot 2.0'
      LayoutEngineNameVersionMajor         : 'adidxbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Adidxbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Adidxbot 2.0'
      AgentNameVersionMajor                : 'Adidxbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'


# BingPreview is used to generate page snapshots.

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534+ (KHTML, like Gecko) BingPreview/1.0b'
    expected: *isBingPreview

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 8.1; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; NOKIA; Lumia 530) like Gecko BingPreview/1.0b'
    expected: *isBingPreviewMobile

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53 BingPreview/1.0b'
    expected: *isBingPreviewMobile

# ====================================================================================
# Additional test cases

- test:
    input:
      user_agent_string: 'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36 Edge/12.0 BingPreview/1.0b'
    expected: *isBingPreview

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10561 BingPreview/1.0b'
    expected: *isBingPreview

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.11067 BingPreview/1.0b'
    expected: *isBingPreview

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534+ (KHTML, like Gecko) BingPreview/1.0b,gzip(gfe)'
    expected: *isBingPreview

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0; BingPreview/1.0b) like Gecko'
    expected: *isBingPreview

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Nokia; Lumia 520) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Mobile Safari/537.36 Edge/12.0 BingPreview/1.0b'
    expected: *isBingPreviewMobile

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; NOKIA; Nokia) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Mobile Safari/537.36 Edge/12.0 BingPreview/1.0b'
    expected: *isBingPreviewMobile

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows Phone 8.1; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; NOKIA; Nokia) like Gecko BingPreview/1.0b'
    expected: *isBingPreviewMobile

# ===========================
# From https://blogs.bing.com/webmaster/december-2019/Announcing-future-user-agents-for-Bingbot
#  Desktop
- test:
    input:
      user_agent_string: 'Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm) Chrome/80.0.345.0 Safari/537.36 Edg/80.0.345.0'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Microsoft BingBot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Bingbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Bingbot 2.0'
      LayoutEngineNameVersionMajor         : 'Bingbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Bingbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Bingbot 2.0'
      AgentNameVersionMajor                : 'Bingbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'


# Mobile
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.345.0 Mobile Safari/537.36 Edg/80.0.345.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Microsoft BingBot'
      DeviceBrand                          : 'Microsoft'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Microsoft Cloud'
      OperatingSystemVersion               : 'Microsoft Azure'
      OperatingSystemVersionMajor          : 'Microsoft Azure'
      OperatingSystemNameVersion           : 'Microsoft Azure'
      OperatingSystemNameVersionMajor      : 'Microsoft Azure'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Bingbot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Bingbot 2.0'
      LayoutEngineNameVersionMajor         : 'Bingbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Bingbot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Bingbot 2.0'
      AgentNameVersionMajor                : 'Bingbot 2'
      AgentInformationUrl                  : 'http://www.bing.com/bingbot.htm'
