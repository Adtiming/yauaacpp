#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:
# Testcases for apps

# https://user-agents.me/cfnetwork-version-list
# If you create an iOS app and retrieve data from a webserver,
# the app will create an default user agent as "AppName/version CFNetwork/version Darwin/version".

- matcher:
    variable:
    - 'Agent                               :agent.(1)product'
    - 'AgentName                           :@Agent.(1)name'
    - 'AgentVersion                        :@Agent.(1)version'
    require:
    - 'agent.(2)product.name="CFNetwork"'
    extract:
    - 'DeviceClass                         :       10 :"Mobile"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'DeviceName                          :       10 :"iOS Device"'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :"Darwin (iOS)"'
    - 'OperatingSystemVersion              :       10 :agent.(3)product.name="Darwin"^.version'
    - 'LayoutEngineClass                   :       10 :"Mobile App"'
    - 'LayoutEngineName                    :       10 :@AgentName'
    - 'LayoutEngineVersion                 :       10 :@AgentVersion'
    - 'AgentClass                          :       10 :"Mobile App"'
    - 'AgentName                           :       10 :@AgentName'
    - 'AgentVersion                        :       10 :@AgentVersion'

- matcher:
    variable:
    - 'AgentName                           :agent.(1)product.(1)name'
    require:
    - 'agent.(2)product.name="CFNetwork"'
    - 'agent.(1)product.(1)comments.(1)entry="unknown version"'
    extract:
    - 'DeviceClass                         :       10 :"Mobile"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'DeviceName                          :       10 :"iOS Device"'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :"Darwin (iOS)"'
    - 'OperatingSystemVersion              :       10 :agent.(3)product.name="Darwin"^.version'
    - 'LayoutEngineClass                   :       10 :"Mobile App"'
    - 'LayoutEngineName                    :       10 :@AgentName'
    - 'LayoutEngineVersion                 :        6 :"<<<null>>>"'
    - 'AgentClass                          :       10 :"Mobile App"'
    - 'AgentName                           :       10 :@AgentName'
    - 'AgentVersion                        :        6 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="Dalvik"'
    extract:
    - 'AgentClass                          :       10 :"Mobile App"'
    - 'AgentName                           :       10 :agent.(2)product.name'
    - 'AgentVersion                        :       10 :agent.(2)product.version'

- test:
    input:
      user_agent_string: 'bol.com/94 CFNetwork/758.2.8 Darwin/15.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '15.0.0'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'Darwin (iOS) 15.0.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'bol.com'
      LayoutEngineVersion                  : '94'
      LayoutEngineVersionMajor             : '94'
      LayoutEngineNameVersion              : 'bol.com 94'
      LayoutEngineNameVersionMajor         : 'bol.com 94'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '94'
      AgentVersionMajor                    : '94'
      AgentNameVersion                     : 'Bol.com 94'
      AgentNameVersionMajor                : 'Bol.com 94'
      AgentInformationUrl                  : 'bol.com'

- test:
    input:
      user_agent_string: 'iButler-Swift/1 CFNetwork/711.3.15 Darwin/14.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '14.0.0'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'Darwin (iOS) 14.0.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 14'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'iButler-Swift'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'iButler-Swift 1'
      LayoutEngineNameVersionMajor         : 'iButler-Swift 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'iButler-Swift'
      AgentVersion                         : '1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'iButler-Swift 1'
      AgentNameVersionMajor                : 'iButler-Swift 1'

- test:
    input:
      user_agent_string: 'GoodReader4/100 CFNetwork/711.5.6 Darwin/14.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '14.0.0'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'Darwin (iOS) 14.0.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 14'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'GoodReader4'
      LayoutEngineVersion                  : '100'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'GoodReader4 100'
      LayoutEngineNameVersionMajor         : 'GoodReader4 100'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'GoodReader4'
      AgentVersion                         : '100'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'GoodReader4 100'
      AgentNameVersionMajor                : 'GoodReader4 100'

- test:
    input:
      user_agent_string: 'iCoreService (unknown version) CFNetwork/720.2.4 Darwin/14.1.0 (x86_64)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '14.1.0'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'Darwin (iOS) 14.1.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 14'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'iCoreService'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'iCoreService ??'
      LayoutEngineNameVersionMajor         : 'iCoreService ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'iCoreService'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'iCoreService ??'
      AgentNameVersionMajor                : 'iCoreService ??'

- test:
    input:
      user_agent_string: 'MoxDocumentApplication (unknown version) CFNetwork/720.5.7 Darwin/14.5.0 (x86_64)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '14.5.0'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'Darwin (iOS) 14.5.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 14'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'MoxDocumentApplication'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'MoxDocumentApplication ??'
      LayoutEngineNameVersionMajor         : 'MoxDocumentApplication ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'MoxDocumentApplication'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'MoxDocumentApplication ??'
      AgentNameVersionMajor                : 'MoxDocumentApplication ??'

- test:
    input:
      user_agent_string: 'com.ddeville.llwebkit.linkchecker/1 CFNetwork/760.2.6 Darwin/15.3.0 (x86_64)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '15.3.0'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'Darwin (iOS) 15.3.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'com.ddeville.llwebkit.linkchecker'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'com.ddeville.llwebkit.linkchecker 1'
      LayoutEngineNameVersionMajor         : 'com.ddeville.llwebkit.linkchecker 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Com.ddeville.llwebkit.linkchecker'
      AgentVersion                         : '1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Com.ddeville.llwebkit.linkchecker 1'
      AgentNameVersionMajor                : 'Com.ddeville.llwebkit.linkchecker 1'

- test:
    input:
      user_agent_string: 'Callpod Keeper for Android 1.0 (10.3.0/245) Dalvik/2.1.0 (Linux; U; Android 6.0; MotoG3 Build/MPI24.65-33)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Motorola MOTOG3'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MPI24.65-33'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Callpod Keeper for Android'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Callpod Keeper for Android 1.0'
      AgentNameVersionMajor                : 'Callpod Keeper for Android 1'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'com.google.ios.youtube/2.6.0.11251 (iPad3,4; U; CPU iPhone OS 8_1_2 like Mac OS X; nl_NL)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad (4th gen, Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Com.google.ios.youtube'
      AgentVersion                         : '2.6.0.11251'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Com.google.ios.youtube 2.6.0.11251'
      AgentNameVersionMajor                : 'Com.google.ios.youtube 2'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'
      AgentInformationUrl                  : 'com.google.ios.youtube'

# Snapchat on Android
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.2; Redmi 4X Build/N2G47H; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 Mobile Safari/537.36 Snapchat/10.30.5.0 (Redmi 4X; Android 7.1.2#V9.5.4.0.NAMMIFA#25; gzip)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi Redmi 4X'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.2'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N2G47H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '66.0.3359.126'
      AgentVersionMajor                    : '66'
      AgentNameVersion                     : 'Chrome Webview 66.0.3359.126'
      AgentNameVersionMajor                : 'Chrome Webview 66'
      WebviewAppName                       : 'Snapchat'
      WebviewAppVersion                    : '10.30.5.0'
      WebviewAppVersionMajor               : '10'
      WebviewAppNameVersion                : 'Snapchat 10.30.5.0'
      WebviewAppNameVersionMajor           : 'Snapchat 10'


# Snapchat on IPhone
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Snapchat/10.34.1.1 (iPhone9,2; iOS 11.4; gzip)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 7 Plus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Snapchat'
      AgentVersion                         : '10.34.1.1'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Snapchat 10.34.1.1'
      AgentNameVersionMajor                : 'Snapchat 10'


#Instagram on Android 7.1.1
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Moto G (5S) Build/NPPS26.102-49-4; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 Mobile Safari/537.36 Instagram 42.0.0.19.95 Android (25/7.1.1; 480dpi; 1080x1776; motorola; Moto G (5S); montana_n; qcom; nl_BE; 104766900)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Motorola Moto G (5S)'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NPPS26.102-49-4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '66.0.3359.126'
      AgentVersionMajor                    : '66'
      AgentNameVersion                     : 'Chrome Webview 66.0.3359.126'
      AgentNameVersionMajor                : 'Chrome Webview 66'
      WebviewAppName                       : 'Instagram'
      WebviewAppVersion                    : '42.0.0.19.95'
      WebviewAppVersionMajor               : '42'
      WebviewAppNameVersion                : 'Instagram 42.0.0.19.95'
      WebviewAppNameVersionMajor           : 'Instagram 42'

#Instagram on iPhone
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_5 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G36 Instagram 43.0.0.13.91 (iPhone8,1; iPhone OS 9_3_5; nl_NL; nl-NL; scale=2.00; gamut=normal; 750x1334)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G36'
      DeviceVersion                        : 'iPhone 6s'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.5'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Instagram'
      AgentVersion                         : '43.0.0.13.91'
      AgentVersionMajor                    : '43'
      AgentNameVersion                     : 'Instagram 43.0.0.13.91'
      AgentNameVersionMajor                : 'Instagram 43'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'

- matcher:
    extract:
    - 'AgentClass                          :       50 :"Special"'
    - 'AgentName                           :       50 :"iTunes"'
    - 'AgentVersion                        :       50 :agent.(1)product.name="iTunes"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; ONEPLUS A6003 Build/PKQ1.180716.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/73.0.3683.90 Mobile Safari/537.36 Instagram 89.0.0.21.101 Android (28/9; 420dpi; 1080x2074; OnePlus; ONEPLUS A6003; OnePlus6; qcom; nl_BE; 150338067)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Oneplus A6003'
      DeviceBrand                          : 'Oneplus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PKQ1.180716.001'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '73.0'
      LayoutEngineVersionMajor             : '73'
      LayoutEngineNameVersion              : 'Blink 73.0'
      LayoutEngineNameVersionMajor         : 'Blink 73'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '73.0.3683.90'
      AgentVersionMajor                    : '73'
      AgentNameVersion                     : 'Chrome Webview 73.0.3683.90'
      AgentNameVersionMajor                : 'Chrome Webview 73'
      WebviewAppName                       : 'Instagram'
      WebviewAppVersion                    : '89.0.0.21.101'
      WebviewAppVersionMajor               : '89'
      WebviewAppNameVersion                : 'Instagram 89.0.0.21.101'
      WebviewAppNameVersionMajor           : 'Instagram 89'
# TODO: Extracting the language from  agent.(7)product.(1)comments.(8)entry.(1)text="nl_BE" is possible but digging this deep will also impact all useragents that do not have this.

- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Macintosh; OS X 10.13.4) AppleWebKit/605.1.33.1.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.13.4'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.13.4'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.33.1.4'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.33.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


# NOTE: iTunes makes a complete mess of the Windows desktop OS names
- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 10 x64 Home Premium Edition (Build 16299); x64) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'

- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 10 x64 Home Premium Edition (Build 17134); x64) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 10 x64 Professional Edition (Build 16299); x64) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 7 Home Premium Edition Service Pack 1 (Build 7601)) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


- test:
    input:
      user_agent_string: 'iTunes/12.7 (Windows; Microsoft Windows 8.1 x64 Home Premium Edition (Build 9600); x64) AppleWebKit/7604.1038.1006.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8.1'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7604.1038.1006.6'
      LayoutEngineVersionMajor             : '7604'
      LayoutEngineNameVersion              : 'AppleWebKit 7604.1038.1006.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7604'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7'
      AgentNameVersionMajor                : 'iTunes 12'


- lookup:
    name: 'AliAppNames'
    map:
      "AP"        : "AlipayClient"
      "TUnionSDK" : "AliApp"

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[1]="AliApp"^.comments.(1)entry.(1)product'
    require:
    - 'IsNull[LookUp[AliAppNames;@AliApp.name]]'
    extract:
    - 'AgentClass                          :     2118 :"Browser Webview"'
    - 'WebviewAppName                      :     2118 :Concat["Alibaba ";NormalizeBrand[@AliApp.name]]'
    - 'WebviewAppVersion                   :     2118 :@AliApp.version'

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[2]="AliApp"^.comments.(1)entry.(1)product'
    require:
    - 'IsNull[LookUp[AliAppNames;@AliApp.name]]'
    extract:
    - 'AgentClass                          :     2118 :"Browser Webview"'
    - 'WebviewAppName                      :     2118 :Concat["Alibaba ";NormalizeBrand[@AliApp.name]]'
    - 'WebviewAppVersion                   :     2118 :@AliApp.version'

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[1]="AliApp"^.comments.(1)entry.(1)product'
    - 'AliAppName                          :LookUp[AliAppNames;@AliApp.name]'
    extract:
    - 'AgentClass                          :     2119 :"Browser Webview"'
    - 'WebviewAppName                      :     2119 :Concat["Alibaba ";@AliAppName]'
    - 'WebviewAppVersion                   :     2119 :@AliApp.version'

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[2]="AliApp"^.comments.(1)entry.(1)product'
    - 'AliAppName                          :LookUp[AliAppNames;@AliApp.name]'
    extract:
    - 'AgentClass                          :     2119 :"Browser Webview"'
    - 'WebviewAppName                      :     2119 :Concat["Alibaba ";@AliAppName]'
    - 'WebviewAppVersion                   :     2119 :@AliApp.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 9; zh-CN; Pixel Build/PPR2.181005.003) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 UCBrowser/11.9.4.974 UWS/2.13.2.36 Mobile Safari/537.36 AliApp(DingTalk/4.5.18.1) com.alibaba.android.rimet/10652535 Channel/10002068 language/zh-CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Pixel'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PPR2.181005.003'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.18.1'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.18.1'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 8.1.0; zh-CN; EML-AL00 Build/HUAWEIEML-AL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 baidu.sogo.uc.UCBrowser/11.9.4.974 UWS/2.13.1.48 Mobile Safari/537.36 AliApp(DingTalk/4.5.11) com.alibaba.android.rimet/10487439 Channel/227200 language/zh-CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei EML-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.1.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.1.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'HUAWEIEML-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.11'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.11'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_2_1 like Mac OS X) AppleWebKit/604.4.7 (KHTML, like Gecko) Mobile/15C153 AliApp(DingTalk/3.5.6) com.laiwang.DingTalk/2697521 Channel/201200 language/en-PT'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15C153'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.1'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.4.7'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.4.7'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '604.4.7'
      AgentVersionMajor                    : '604'
      AgentNameVersion                     : 'AppleWebKit 604.4.7'
      AgentNameVersionMajor                : 'AppleWebKit 604'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '3.5.6'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'Alibaba DingTalk 3.5.6'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 3'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_3_1 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15E302 UCBrowser/11.8.8.1060 Mobile AliApp(TUnionSDK/0.1.20.2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E302'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.3.1'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.8.8.1060'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.8.8.1060'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.8.8.1060'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.8.8.1060'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20.2'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20.2'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iOS 11_2_6 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Mobile/15D100 ChannelId(3) Nebula AliApp(CLOUDMAIL/2.6.8)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.5.6'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.5.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '604.5.6'
      AgentVersionMajor                    : '604'
      AgentNameVersion                     : 'AppleWebKit 604.5.6'
      AgentNameVersionMajor                : 'AppleWebKit 604'
      WebviewAppName                       : 'Alibaba Cloudmail'
      WebviewAppVersion                    : '2.6.8'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Alibaba Cloudmail 2.6.8'
      WebviewAppNameVersionMajor           : 'Alibaba Cloudmail 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15F79 AliApp(DingTalk/4.5.1) com.laiwang.DingTalk/10127809 Channel/201200 language/zh-Hans-CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15F79'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'AppleWebKit 605.1.15'
      AgentNameVersionMajor                : 'AppleWebKit 605'
      AgentLanguage                        : 'Chinese (Simplified Han, China)'
      AgentLanguageCode                    : 'zh-hans-cn'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.1'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.1'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_1_2 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15B202 UCBrowser/11.8.1.1043 Mobile AliApp(TUnionSDK/0.1.20)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15B202'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.1.2'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.8.1.1043'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.8.1.1043'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.8.1.1043'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.8.1.1043'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_3 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/14G60 UCBrowser/11.4.7.931 Mobile AliApp(TUnionSDK/0.1.12) AliApp(TUnionSDK/0.1.12)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14G60'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.4.7.931'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.4.7.931'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.4.7.931'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.4.7.931'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.12'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.12'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E230 ChannelId(3) Nebula PSDType(1) AlipayDefined(nt:WIFI,ws:320|504|2.0) AliApp(AP/9.9.0.000001) AlipayClient/9.9.0.000001 Language/zh-Hans ProductType/dev'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13E230'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '601.1.46'
      AgentVersionMajor                    : '601'
      AgentNameVersion                     : 'AppleWebKit 601.1.46'
      AgentNameVersionMajor                : 'AppleWebKit 601'
      AgentLanguage                        : 'Chinese (Simplified)'
      AgentLanguageCode                    : 'zh-hans'
      WebviewAppName                       : 'Alibaba AlipayClient'
      WebviewAppVersion                    : '9.9.0.000001'
      WebviewAppVersionMajor               : '9'
      WebviewAppNameVersion                : 'Alibaba AlipayClient 9.9.0.000001'
      WebviewAppNameVersionMajor           : 'Alibaba AlipayClient 9'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iOS 11_2_6 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Mobile/15D100 ChannelId(2) Nebula AliApp(CLOUDMAIL/5.1.0)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.5.6'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.5.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '604.5.6'
      AgentVersionMajor                    : '604'
      AgentNameVersion                     : 'AppleWebKit 604.5.6'
      AgentNameVersionMajor                : 'AppleWebKit 604'
      WebviewAppName                       : 'Alibaba Cloudmail'
      WebviewAppVersion                    : '5.1.0'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'Alibaba Cloudmail 5.1.0'
      WebviewAppNameVersionMajor           : 'Alibaba Cloudmail 5'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4_1 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15G77 UCBrowser/12.1.2.1096 Mobile AliApp(TUnionSDK/0.1.20.3)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15G77'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4.1'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '12.1.2.1096'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'UCBrowser 12.1.2.1096'
      LayoutEngineNameVersionMajor         : 'UCBrowser 12'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '12.1.2.1096'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'UCBrowser 12.1.2.1096'
      AgentNameVersionMajor                : 'UCBrowser 12'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20.3'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20.3'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15F79 AliApp(DingTalk/4.5.1) com.laiwang.DingTalk/10127809 Channel/201200 language/en-DE'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15F79'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'AppleWebKit 605.1.15'
      AgentNameVersionMajor                : 'AppleWebKit 605'
      AgentLanguage                        : 'English (Germany)'
      AgentLanguageCode                    : 'en-de'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.1'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.1'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; SM-N9008 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36 AliApp(AP/8.5.3.012601) AlipayClient/8.5.3.012601'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N9008'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Alibaba AlipayClient'
      WebviewAppVersion                    : '8.5.3.012601'
      WebviewAppVersionMajor               : '8'
      WebviewAppNameVersion                : 'Alibaba AlipayClient 8.5.3.012601'
      WebviewAppNameVersionMajor           : 'Alibaba AlipayClient 8'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.4; M353 Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/33.0.0.0 Mobile Safari/537.36 AliApp(AP/8.5.3.012601) AlipayClient/8.5.3.012601'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Meizu M353'
      DeviceBrand                          : 'Meizu'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '33.0.0.0'
      AgentVersionMajor                    : '33'
      AgentNameVersion                     : 'Chrome Webview 33.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 33'
      WebviewAppName                       : 'Alibaba AlipayClient'
      WebviewAppVersion                    : '8.5.3.012601'
      WebviewAppVersionMajor               : '8'
      WebviewAppNameVersion                : 'Alibaba AlipayClient 8.5.3.012601'
      WebviewAppNameVersionMajor           : 'Alibaba AlipayClient 8'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_2_6 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15D100 UCBrowser/11.9.3.1064 Mobile AliApp(TUnionSDK/0.1.20.2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15D100'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.9.3.1064'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.9.3.1064'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.9.3.1064'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.9.3.1064'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20.2'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20.2'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


# According to https://twitter.com/dannysullivan/status/1092531647319142400
# A new Google useragent spotted named google-speakr - @JohnMu or @dannysullivan any ideas what this is? https://www.seroundtable.com/new-google-useragent-google-speakr-27056.html …  via @VorticonCmdr and @gfiorelli1
# That's an useragent used when Google Go fetches a page to make sure it has the most up-to-date information before it translates it to read aloud. We'll see about adding documentation. More info here: https://www.blog.google/technology/next-billion-users/make-google-read-it/

# "Today, we’re launching a new feature which will let everyone using Google Go’s browser listen to webpages out loud."

- test:
    input:
      user_agent_string: 'google-speakr'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google Read Aloud'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Google Read Aloud'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Google Read Aloud ??'
      LayoutEngineNameVersionMajor         : 'Google Read Aloud ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Google Read Aloud'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google Read Aloud ??'
      AgentNameVersionMajor                : 'Google Read Aloud ??'


- test:
    input:
      user_agent_string: 'GeenStijlAndroidApp/2.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'GeenStijlAndroidApp'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'GeenStijlAndroidApp 2.0'
      AgentNameVersionMajor                : 'GeenStijlAndroidApp 2'

- test:
    input:
      user_agent_string: 'SafeBrowser/1.11.0.38 CFNetwork/974.2.1 Darwin/18.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '18.0.0'
      OperatingSystemVersionMajor          : '18'
      OperatingSystemNameVersion           : 'Darwin (iOS) 18.0.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 18'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'SafeBrowser'
      LayoutEngineVersion                  : '1.11.0.38'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'SafeBrowser 1.11.0.38'
      LayoutEngineNameVersionMajor         : 'SafeBrowser 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'SafeBrowser'
      AgentVersion                         : '1.11.0.38'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'SafeBrowser 1.11.0.38'
      AgentNameVersionMajor                : 'SafeBrowser 1'

#
# This is used by iOS to know which app to call for which URL.
# https://shinesolutions.com/2017/06/15/universal-linking-a-few-things-to-be-prepared-for/
#
- matcher:
    require:
    - 'agent.(1)product.name="swcd"'
    extract:
    - 'LayoutEngineClass                   :      100 : "<<<null>>>"' # This thing downloads a single specific Json file.
    - 'LayoutEngineName                    :      100 : "<<<null>>>"'
    - 'LayoutEngineVersion                 :      100 : "<<<null>>>"'
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "Apple iOS Universal Links updater"'
    - 'AgentVersion                        :      100 : agent.product.name="Darwin"^.version'

- test:
    input:
      user_agent_string: 'swcd (unknown version) CFNetwork/758.5.3 Darwin/15.6.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '15.6.0'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'Darwin (iOS) 15.6.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 15'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Apple iOS Universal Links updater'
      AgentVersion                         : '15.6.0'
      AgentVersionMajor                    : '15'
      AgentNameVersion                     : 'Apple iOS Universal Links updater 15.6.0'
      AgentNameVersionMajor                : 'Apple iOS Universal Links updater 15'


- matcher:
    extract:
    - 'AgentClass                          :      100 :"Mobile App"'
    - 'AgentName                           :      100 : "EmbeddedBrowser"'
    - 'AgentVersion                        :      100 : agent.product.name="EmbeddedBrowser"^.(2)version'

- matcher:
    variable:
    - 'Product                             :agent.(1-3)product.version="EmbeddedBrowser"^'
    extract:
    - 'AgentClass                          :      100 :"Mobile App"'
    - 'AgentName                           :      100 : Concat["EmbeddedBrowser ";@Product.name]'
    - 'AgentVersion                        :      100 : "<<<null>>>"'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G34 EmbeddedBrowser/Delfi/440 DELFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G34'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.3'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'EmbeddedBrowser'
      AgentVersion                         : '440'
      AgentVersionMajor                    : '440'
      AgentNameVersion                     : 'EmbeddedBrowser 440'
      AgentNameVersionMajor                : 'EmbeddedBrowser 440'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 LaProvince/ EmbeddedBrowser (iPhone; CPU iPhone OS 10_3_3 like Mac OS X) AppleWebKit/603.3.8 (KHTML, like Gecko) Mobile/14G60 DeviceUID: 6835ACD1-B86D-4687-AA67-3DD24B1952EB'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14G60'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '603.3.8'
      LayoutEngineVersionMajor             : '603'
      LayoutEngineNameVersion              : 'AppleWebKit 603.3.8'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 603'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'EmbeddedBrowser LaProvince'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'EmbeddedBrowser LaProvince ??'
      AgentNameVersionMajor                : 'EmbeddedBrowser LaProvince ??'
      AgentUuid                            : '6835ACD1-B86D-4687-AA67-3DD24B1952EB'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 NordEclair/ EmbeddedBrowser (iPhone; CPU iPhone OS 12_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 DeviceUID: 4AEB9FB8-F815-4150-9B25-7CAED49F185C'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.3.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'EmbeddedBrowser NordEclair'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'EmbeddedBrowser NordEclair ??'
      AgentNameVersionMajor                : 'EmbeddedBrowser NordEclair ??'
      AgentUuid                            : '4AEB9FB8-F815-4150-9B25-7CAED49F185C'


- matcher:
    require:
    - 'IsNull[agent.(1)product.name="Mozilla"]'
    - 'agent.(2)product.name="Mozilla"'
    - 'agent.(2)product.version="5.0"'
    - 'agent.product.name="EmbeddedBrowser"'
    extract:
    - 'AgentClass                          :      100 : "Mobile App"'
    - 'AgentName                           :      100 : agent.(1)product.name'
    - 'AgentVersion                        :      100 : agent.(1)product.version'


- matcher:
    variable:
    - 'EmbeddedBrowser                     :agent.product.name="EmbeddedBrowser"'
    extract:
    - 'AgentUuid                           :      100 : @EmbeddedBrowser^.version.(1)keyvalue.(2)uuid'


- test:
    input:
      user_agent_string: '15min/3.2.18 Mozilla/5.0 (iPhone; CPU iPhone OS 13_1_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 EmbeddedBrowser DeviceUID: 4111C299-2E0A-430D-994A-E63AC824065F'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.1'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : '15MIN'
      AgentVersion                         : '3.2.18'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : '15MIN 3.2.18'
      AgentNameVersionMajor                : '15MIN 3'
      AgentUuid                            : '4111C299-2E0A-430D-994A-E63AC824065F'


- test:
    input:
      user_agent_string: 'Autoplius.lt/4.4.0 Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 EmbeddedBrowser DeviceUID: CEDA6E92-1204-4630-BA16-61871A213A10'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Autoplius.lt'
      AgentVersion                         : '4.4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Autoplius.lt 4.4.0'
      AgentNameVersionMajor                : 'Autoplius.lt 4'
      AgentInformationUrl                  : 'Autoplius.lt'
      AgentUuid                            : 'CEDA6E92-1204-4630-BA16-61871A213A10'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 HLNApp/4.8.6.1 EmbeddedBrowser (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16B92 DeviceUID: 1E0EE834-D7CB-4B6F-A5B7-50555D41A7AB'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16B92'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'HLNApp'
      AgentVersion                         : '4.8.6.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'HLNApp 4.8.6.1'
      AgentNameVersionMajor                : 'HLNApp 4'
      AgentUuid                            : '1E0EE834-D7CB-4B6F-A5B7-50555D41A7AB'


- matcher:
    require:
    - 'agent.(1)product.name[1]="ntvmobil"'
    - 'agent.(2)product.name="Mozilla"'
    - 'agent.(2)product.version="5.0"'
    extract:
    - 'AgentClass                          :      100 : "Mobile App"'
    - 'AgentName                           :      100 : "ntvmobil"'
    - 'AgentVersion                        :      100 : "<<<null>>>"'


  ## Really special with json part.
- test:
    input:
      user_agent_string: 'ntvmobil iPhone 7.0 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; de-DE) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: '"ntvmobil iPhone 7.1 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; de-DE) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: '"ntvmobil iPhone 6.35 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; en-NL) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'English (Netherlands)'
      AgentLanguageCode                    : 'en-nl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: '"ntvmobil iPhone 6.35 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; de-DE) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'
      AgentSecurity                        : 'Strong security'


- matcher:
    variable:
    - 'GMMClient:agent.(4)product.(1)name="GmmClient:google_ios"^'
    extract:
    - 'AgentClass                          :      100 : "Browser Webview"'
    - 'WebviewAppName                      :      100 : @GMMClient.(1)version'
    - 'WebviewAppVersion                   :      100 : @GMMClient.(2)version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 12.4.1; en_US; ) AppleWebKit/0.0 (KHTML, like Gecko) Version/0.0; GmmClient:google_ios/com.google.Maps/5.27.8/Mobile/ios:iPhone10,5/iOS-AppStore'
    #    - 'agent.(4)product="GmmClient:google_ios/com.google.Maps/5.27.8/"'
    #    - 'agent.(4)product.(1)name.(1)keyvalue="GmmClient:google_ios"'
    #    - 'agent.(4)product.(1)name="GmmClient:google_ios"'
    #    - 'agent.(4)product.(1)name.(1)keyvalue.(1)key="GmmClient"'
    #    - 'agent.(4)product.(1)name.(1)keyvalue.(2)text="google_ios"'
    #    - 'agent.(4)product.(1)version="com.google.Maps"'
    #    - 'agent.(4)product.(2)version="5.27.8"'
    #    - 'agent.(5)product="Mobile/ios:iPhone10,5/iOS-AppStore"'
    #    - 'agent.(5)product.(1)name="Mobile"'
    #    - 'agent.(5)product.(1)version="ios:iPhone10,5"'
    #    - 'agent.(5)product.(1)version.(1)keyvalue="ios:iPhone10,5"'
    #    - 'agent.(5)product.(1)version.(1)keyvalue.(1)key="ios"'
    #    - 'agent.(5)product.(1)version.(1)keyvalue.(1)version="iPhone10,5"'
    #    - 'agent.(5)product.(2)version="iOS-AppStore"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 8 Plus (A1897)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '0.0'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'AppleWebKit 0.0'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 0'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '0.0'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'UIWebView 0.0'
      AgentNameVersionMajor                : 'UIWebView 0'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'com.google.Maps'
      WebviewAppVersion                    : '5.27.8'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'com.google.Maps 5.27.8'
      WebviewAppNameVersionMajor           : 'com.google.Maps 5'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 12.2; en_US; ) AppleWebKit/0.0 (KHTML, like Gecko) Version/0.0; GmmClient:google_ios/com.google.Maps/5.15.11/Mobile/ios:iPhone11,8/iOS-AppStore'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone XR'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.2'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.2'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '0.0'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'AppleWebKit 0.0'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 0'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '0.0'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'UIWebView 0.0'
      AgentNameVersionMajor                : 'UIWebView 0'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'com.google.Maps'
      WebviewAppVersion                    : '5.15.11'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'com.google.Maps 5.15.11'
      WebviewAppNameVersionMajor           : 'com.google.Maps 5'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 11.4; en_US; ) AppleWebKit/0.0 (KHTML, like Gecko) Version/0.0; GmmClient:google_ios/com.google.Maps/4.53.3/Mobile/ios:iPhone10,6/iOS-AppStore'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone X (A1901)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '0.0'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'AppleWebKit 0.0'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 0'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '0.0'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'UIWebView 0.0'
      AgentNameVersionMajor                : 'UIWebView 0'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'com.google.Maps'
      WebviewAppVersion                    : '4.53.3'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'com.google.Maps 4.53.3'
      WebviewAppNameVersionMajor           : 'com.google.Maps 4'


- test:
    input: # QR Scanner app
      user_agent_string: 'ZXing (Android)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'ZXing'
      AgentVersion                         : 'Android'
      AgentVersionMajor                    : 'Android'
      AgentNameVersion                     : 'ZXing Android'
      AgentNameVersionMajor                : 'ZXing Android'


# =========================================
# Some testcases that are NOT BlackBerry
# =========================================

- test: # Constructed test case
    input:
      user_agent_string: 'LeapApp-AppStore/4.75.0.1 CFNetwork/1107.1 Darwin/19.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '19.0.0'
      OperatingSystemVersionMajor          : '19'
      OperatingSystemNameVersion           : 'Darwin (iOS) 19.0.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 19'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'LeapApp-AppStore'
      LayoutEngineVersion                  : '4.75.0.1'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'LeapApp-AppStore 4.75.0.1'
      LayoutEngineNameVersionMajor         : 'LeapApp-AppStore 4'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'LeapApp-AppStore'
      AgentVersion                         : '4.75.0.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'LeapApp-AppStore 4.75.0.1'
      AgentNameVersionMajor                : 'LeapApp-AppStore 4'


- test: # Constructed test case
    input:
      user_agent_string: 'App/1.57.0.1 (iPad4,4; iOS 12.4.2) LeapLMN/36.2.0 LeapHTTPClient/8.0.2'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad mini 2 (Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.2'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.2'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'App'
      AgentVersion                         : '1.57.0.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'App 1.57.0.1'
      AgentNameVersionMajor                : 'App 1'



- test: # Constructed test case
    input:
      user_agent_string: 'Leap/5.9.0 DashVideoOnDemandMediaDecoder/0.0.7 leapExoPlayer/0.0.5'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Leap'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Leap 5.9.0'
      AgentNameVersionMajor                : 'Leap 5'


- test: # Constructed test case
    input:
      user_agent_string: 'LeapAndroid/5.9.0 (110807 uk)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'LeapAndroid'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'LeapAndroid 5.9.0'
      AgentNameVersionMajor                : 'LeapAndroid 5'
      AgentLanguage                        : 'Ukrainian'
      AgentLanguageCode                    : 'uk'


- test:
    input:
      user_agent_string: 'BBCNewsAndroid/5.9.0 (110807)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCNewsAndroid'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'BBCNewsAndroid 5.9.0'
      AgentNameVersionMajor                : 'BBCNewsAndroid 5'


- test:
    input:
      user_agent_string: 'iPlayerKids/1.57.0.1 (iPad4,4; iOS 12.4.2) BBCSMP/36.2.0 BBCHTTPClient/8.0.2'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad mini 2 (Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.2'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.2'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'iPlayerKids'
      AgentVersion                         : '1.57.0.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'iPlayerKids 1.57.0.1'
      AgentNameVersionMajor                : 'iPlayerKids 1'


- test:
    input:
      user_agent_string: 'BBCiPlayer/4.75.0.1 (iPad2,5; iPhone OS 9.3.5) BBCSMP/36.2.0 BBCHTTPClient/8.0.2'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad mini (Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.5'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCiPlayer'
      AgentVersion                         : '4.75.0.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'BBCiPlayer 4.75.0.1'
      AgentNameVersionMajor                : 'BBCiPlayer 4'


- test:
    input:
      user_agent_string: 'BBCiPlayer-AppStore/4.75.0.1 CFNetwork/1107.1 Darwin/19.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '19.0.0'
      OperatingSystemVersionMajor          : '19'
      OperatingSystemNameVersion           : 'Darwin (iOS) 19.0.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 19'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'BBCiPlayer-AppStore'
      LayoutEngineVersion                  : '4.75.0.1'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'BBCiPlayer-AppStore 4.75.0.1'
      LayoutEngineNameVersionMajor         : 'BBCiPlayer-AppStore 4'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'BBCiPlayer-AppStore'
      AgentVersion                         : '4.75.0.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'BBCiPlayer-AppStore 4.75.0.1'
      AgentNameVersionMajor                : 'BBCiPlayer-AppStore 4'

- test:
    input:
      user_agent_string: 'BBCNewsAndroid/5.9.0 DashVideoOnDemandMediaDecoder/0.0.7 bbcExoPlayer/0.0.5 (Android 9)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCNewsAndroid'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'BBCNewsAndroid 5.9.0'
      AgentNameVersionMajor                : 'BBCNewsAndroid 5'

- test:
    input:
      user_agent_string: 'BBC News Android 4.7.1.29/107998 uk smpAndroid/29.4535-dev (android_os/4.4.4)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBC News Android'
      AgentVersion                         : '4.7.1.29'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'BBC News Android 4.7.1.29'
      AgentNameVersionMajor                : 'BBC News Android 4'

- test:
    input:
      user_agent_string: 'BBCiPlayerRadio-International/2.15.7.11054 (SM-G930F; Android 8.0.0)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G930F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCiPlayerRadio-International'
      AgentVersion                         : '2.15.7.11054'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'BBCiPlayerRadio-International 2.15.7.11054'
      AgentNameVersionMajor                : 'BBCiPlayerRadio-International 2'


- test:
    input:
      user_agent_string: 'BBCNews/172 (iPhone10,4; iOS 13.1.3) BBCSMP/36.1.0 BBCHTTPClient/7.1.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 8 (A1905)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.3'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.3'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCNews'
      AgentVersion                         : '172'
      AgentVersionMajor                    : '172'
      AgentNameVersion                     : 'BBCNews 172'
      AgentNameVersionMajor                : 'BBCNews 172'

- test:
    input:
      user_agent_string: 'BBCiPlayer-Kids-AppStore/1.57.0.1 CFNetwork/978.0.7 Darwin/18.7.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Darwin (iOS)'
      OperatingSystemVersion               : '18.7.0'
      OperatingSystemVersionMajor          : '18'
      OperatingSystemNameVersion           : 'Darwin (iOS) 18.7.0'
      OperatingSystemNameVersionMajor      : 'Darwin (iOS) 18'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'BBCiPlayer-Kids-AppStore'
      LayoutEngineVersion                  : '1.57.0.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'BBCiPlayer-Kids-AppStore 1.57.0.1'
      LayoutEngineNameVersionMajor         : 'BBCiPlayer-Kids-AppStore 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'BBCiPlayer-Kids-AppStore'
      AgentVersion                         : '1.57.0.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BBCiPlayer-Kids-AppStore 1.57.0.1'
      AgentNameVersionMajor                : 'BBCiPlayer-Kids-AppStore 1'

- test:
    input:
      user_agent_string: 'bbcmediaplayer/3.1.12 (sm-g960f; Android 9) AdobeAIR/23.0.0.246'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G960F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Bbcmediaplayer'
      AgentVersion                         : '3.1.12'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Bbcmediaplayer 3.1.12'
      AgentNameVersionMajor                : 'Bbcmediaplayer 3'

- test:
    input:
      user_agent_string: 'BBCSounds/1.13.2 (SM-G950F; Android 9) smpAndroid/38.1.0 (android_os/9)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G950F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCSounds'
      AgentVersion                         : '1.13.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BBCSounds 1.13.2'
      AgentNameVersionMajor                : 'BBCSounds 1'

# ===========================
# The useragent created by the https://www.mytheresa.com/ App.

- matcher:
    require:
    - 'agent.product.name="mythapp"'
    - 'IsNull[agent.product.name="Chrome"]'
    extract:
    - 'AgentClass                          :       42 :"Browser Webview"'
    - 'AgentName                           :       42 :"UIWebView"'
    - 'WebviewAppName                      :        1 :"Mytheresa App"'
    - 'WebviewAppVersion                   :        1 :agent.product.name="mythapp"^.comments.(1)entry'

- matcher:
    require:
    - 'agent.product.name="mythapp"'
    - 'agent.product.name="Chrome"'
    extract:
    - 'AgentClass                          :       42 :"Browser Webview"'
    - 'AgentName                           :       42 :"Chrome Webview"'
    - 'WebviewAppName                      :        1 :"Mytheresa App"'
    - 'WebviewAppVersion                   :        1 :agent.product.name="mythapp"^.comments.(1)entry'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; SM-N960N Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/79.0.3945.93 Mobile Safari/537.36 mythapp (3.9.0 build 201905272; samsung SM-N960N; ko_KR; Android 9)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N960N'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PPR1.180610.011'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '79.0'
      LayoutEngineVersionMajor             : '79'
      LayoutEngineNameVersion              : 'Blink 79.0'
      LayoutEngineNameVersionMajor         : 'Blink 79'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '79.0.3945.93'
      AgentVersionMajor                    : '79'
      AgentNameVersion                     : 'Chrome Webview 79.0.3945.93'
      AgentNameVersionMajor                : 'Chrome Webview 79'
      AgentLanguage                        : 'Korean (South Korea)'
      AgentLanguageCode                    : 'ko-kr'
      WebviewAppName                       : 'Mytheresa App'
      WebviewAppVersion                    : '3.9.0 build 201905272'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'Mytheresa App 3.9.0 build 201905272'
      WebviewAppNameVersionMajor           : 'Mytheresa App 3'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_1_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 mythapp (2.12.2 build 2110016; iPhone 7; en-US; iOS 13.1.2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : '7'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.2'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'UIWebView 605.1.15'
      AgentNameVersionMajor                : 'UIWebView 605'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      WebviewAppName                       : 'Mytheresa App'
      WebviewAppVersion                    : '2.12.2 build 2110016'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Mytheresa App 2.12.2 build 2110016'
      WebviewAppNameVersionMajor           : 'Mytheresa App 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; SM-G955F Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.62 Mobile Safari/537.36 mythapp (4.0.21.202000013 build 202000013 react-native; samsung SM-G955F; null; Android 9)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PPR1.180610.011'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '78.0'
      LayoutEngineVersionMajor             : '78'
      LayoutEngineNameVersion              : 'Blink 78.0'
      LayoutEngineNameVersionMajor         : 'Blink 78'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '78.0.3904.62'
      AgentVersionMajor                    : '78'
      AgentNameVersion                     : 'Chrome Webview 78.0.3904.62'
      AgentNameVersionMajor                : 'Chrome Webview 78'
      WebviewAppName                       : 'Mytheresa App'
      WebviewAppVersion                    : '4.0.21.202000013 build 202000013 react-native'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Mytheresa App 4.0.21.202000013 build 202000013 react-native'
      WebviewAppNameVersionMajor           : 'Mytheresa App 4'


- matcher:
    require:
    - 'agent.(1)product.(1)name="bol.com"'
    extract:
    - 'AgentClass                          :      100 : "Mobile App"'

- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (Android 9; SM-G955F; Phone)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'



- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (Android 9; SM-G955F; Tablet)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (iOS 4.5.6; iPad; Tablet)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.5.6'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.5.6'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (iOS 4.5.6; iPhone; Phone)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.5.6'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.5.6'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/3.10.0-461 (Android 9; SM-G955F; Phone; nl_NL )'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '3.10.0-461'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Bol.com 3.10.0-461'
      AgentNameVersionMajor                : 'Bol.com 3'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/3.10.0-461 (iOS 10.1.2.3; iPad ; Tablet ; fr_be )'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.1.2.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.1.2.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '3.10.0-461'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Bol.com 3.10.0-461'
      AgentNameVersionMajor                : 'Bol.com 3'
      AgentLanguage                        : 'French (Belgium)'
      AgentLanguageCode                    : 'fr-be'
      AgentInformationUrl                  : 'Bol.com'

- matcher:
    require:
    - 'agent.product.(1)comments.(1)entry.(1)text="LinkedInApp"'
    extract:
    - 'WebviewAppName                      :       10 :                   "LinkedIn"'


# 2020-10-20: When clicking on a link in the LinkedIn chat on an iPhone
#             On Android you do not get an annotation indicating the LinkedApp is used.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_8 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 [LinkedInApp]'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.8'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.8'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'UIWebView 605.1.15'
      AgentNameVersionMajor                : 'UIWebView 605'
      WebviewAppName                       : 'LinkedIn'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'LinkedIn ??'
      WebviewAppNameVersionMajor           : 'LinkedIn ??'


- matcher:
    variable:
    - 'NRC                                 :agent.product.(1)name="NRC Digitale Editie, nl.nrc.nrcapp"'
    require:
    - '@NRC^.(2)version="iOS"'
    extract:
    - 'OperatingSystemName                 :      200 : "iOS"'
    - 'OperatingSystemVersion              :      200 : @NRC^>.text'

- test:
    input:
      user_agent_string: 'iPad (compatible; Smartphone2.0) NRC Digitale Editie, nl.nrc.nrcapp 9.14 (156) / iOS 13.1.2'
      #    - 'agent.(2)product="NRC Digitale Editie, nl.nrc.nrcapp 9.14 (156) / iOS"'
      #    - 'agent.(2)product.(1)name="NRC Digitale Editie, nl.nrc.nrcapp"'
      #    - 'agent.(2)product.(1)version="9.14"'
      #    - 'agent.(2)product.(1)comments="(156)"'
      #    - 'agent.(2)product.(1)comments.(1)entry="156"'
      #    - 'agent.(2)product.(1)comments.(1)entry.(1)text="156"'
      #    - 'agent.(2)product.(2)version="iOS"'
      #    - 'agent.(3)text="13.1.2"'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.2'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'iPad'
      AgentVersion                         : 'compatible'
      AgentVersionMajor                    : 'compatible'
      AgentNameVersion                     : 'iPad compatible'
      AgentNameVersionMajor                : 'iPad compatible'
