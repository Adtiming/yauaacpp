#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:

- matcher:
    variable:
    - 'UbuntuName                          :agent.text[1]~"buntu"'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :       96 :"Desktop"'
    - 'OperatingSystemName                 :       96 :@UbuntuName'
    - 'OperatingSystemVersion              :       96 :"<<<null>>>"'

- matcher:
    variable:
    - 'UbuntuName                          :agent.product.name[1]~"buntu"'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :       97 :"Desktop"'
    - 'OperatingSystemName                 :       97 :@UbuntuName'
    - 'OperatingSystemVersion              :       97 :"<<<null>>>"'

- matcher:
    variable:
    - 'UbuntuName                          :agent.product.comments.entry[1]~"buntu"'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :       97 :"Desktop"'
    - 'OperatingSystemName                 :       97 :@UbuntuName'
    - 'OperatingSystemVersion              :       97 :"<<<null>>>"'

- matcher:
    variable:
    - 'UbuntuName                          :agent.product.comments.entry[1]~"buntu"'
    require:
    - 'IsNull[@UbuntuName@[2]="package"]'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :       98 :"Desktop"'
    - 'OperatingSystemName                 :       98 :@UbuntuName'
    - 'OperatingSystemVersion              :       98 :@UbuntuName.product.version'

- matcher:
    variable:
    - 'UbuntuProduct                       :agent.product.name[1]~"buntu"^'
    - 'UbuntuName                          :LookUpPrefix[UbuntuOSName;@UbuntuProduct]'
    - 'UbuntuVersion                       :LookUpPrefix[UbuntuOSVersion;@UbuntuProduct]'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :      204 :"Desktop"'
    - 'OperatingSystemName                 :      204 :@UbuntuName'
    - 'OperatingSystemVersion              :      204 :@UbuntuVersion'

- matcher:
    variable:
    - 'UbuntuName                          :agent.product.name[1]~"buntu"'
    - 'UbuntuVersion                       :@UbuntuName^.version'
    require:
    - 'IsNull[@UbuntuName@[2]]'
    - 'IsNull[@UbuntuVersion?UbuntuOSVersion]'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :      204 :"Desktop"'
    - 'OperatingSystemName                 :      204 :@UbuntuName'
    - 'OperatingSystemVersion              :      204 :@UbuntuName^.version'

- matcher:
    variable:
    - 'UbuntuName                          :agent.product.name~"buntu"'
    - 'UbuntuVersion                       :@UbuntuName^.version'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :      203 :"Desktop"'
    - 'OperatingSystemName                 :      203 :@UbuntuName[1]'
    - 'OperatingSystemVersion              :      203 :LookUp[UbuntuOSVersion;@UbuntuVersion]'

- matcher:
    variable:
    - 'UbuntuName                          :agent.product.name~"buntu"'
    - 'UbuntuVersion                       :@UbuntuName^.comments.entry'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :      202 :"Desktop"'
    - 'OperatingSystemName                 :      202 :@UbuntuName[1]'
    - 'OperatingSystemVersion              :      202 :LookUp[UbuntuOSVersion;@UbuntuVersion]'

- matcher:
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :      201 :"Desktop"'
    - 'OperatingSystemName                 :      201 :"Ubuntu"'
    - 'OperatingSystemVersion              :      201 :LookUp[UbuntuOSVersion;agent.(1-4)product.comments.entry.(1)text]'


# NOTE: Most useragents in this file have modified version numbers.
#       This was done to find the examples of different patterns to test against.

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/7.10 (gutsy) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '7.10'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Ubuntu 7.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Firefox/8.8.8 (Ubuntu-feisty)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '7.04'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Ubuntu 7.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Kubuntu/8.10 (intrepid) Minefield/3.2a1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Kubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Kubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Minefield'
      AgentVersion                         : '3.2a1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Minefield 3.2a1'
      AgentNameVersionMajor                : 'Minefield 3'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/8.04 (hardy) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.04'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/8.10 (intrepid) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu (intrepid) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/3.1415926 (intrepid) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '3.1415926'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'Ubuntu 3.1415926'
      OperatingSystemNameVersionMajor      : 'Ubuntu 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/8.10 (intrepid) Namoroka/7.7.7'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Namoroka'
      AgentVersion                         : '7.7.7'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Namoroka 7.7.7'
      AgentNameVersionMajor                : 'Namoroka 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/8.04 (hardy) Firefox/8.8.8 MEGAUPLOAD 1.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.04'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'MEGAUPLOAD'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'MEGAUPLOAD 1.0'
      AgentNameVersionMajor                : 'MEGAUPLOAD 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/8.10 (intrepid) Firefox/8.8.8 FirePHP/0.2.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'FirePHP'
      AgentVersion                         : '0.2.4'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'FirePHP 0.2.4'
      AgentNameVersionMajor                : 'FirePHP 0'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/8.10 (intrepid) Firefox/8.8.8 GTB5'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/7.10 (gutsy) Firefox/8.8.8 (Linux Mint)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '7.10'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Ubuntu 7.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.001 (X11; Linux i686; rv:12.3; de-ch) Gecko/2000000000 (ubuntu-feisty)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '7.04'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Ubuntu 7.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Gecko'
      AgentVersion                         : '12.3'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Gecko 12.3'
      AgentNameVersionMajor                : 'Gecko 12'
      AgentLanguage                        : 'German (Switzerland)'
      AgentLanguageCode                    : 'de-ch'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.4; Linux) KHTML/3.4.3 (like Gecko) (Kubuntu package 4:3.4.3-0ubuntu1)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Kubuntu ??'
      OperatingSystemNameVersionMajor      : 'Kubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'KHTML'
      LayoutEngineVersion                  : '3.4'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'KHTML 3.4'
      LayoutEngineNameVersionMajor         : 'KHTML 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'Konqueror'
      AgentVersion                         : '3.4'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Konqueror 3.4'
      AgentNameVersionMajor                : 'Konqueror 3'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.5; Linux; en_US) KHTML/3.5.6 (like Gecko) (Kubuntu)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Kubuntu ??'
      OperatingSystemNameVersionMajor      : 'Kubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'KHTML'
      LayoutEngineVersion                  : '3.5'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'KHTML 3.5'
      LayoutEngineNameVersionMajor         : 'KHTML 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'Konqueror'
      AgentVersion                         : '3.5'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Konqueror 3.5'
      AgentNameVersionMajor                : 'Konqueror 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.5; Linux; X11) KHTML/3.5.3 (like Gecko) Kubuntu 6.06 Dapper'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '6.06'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Kubuntu 6.06'
      OperatingSystemNameVersionMajor      : 'Kubuntu 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'KHTML'
      LayoutEngineVersion                  : '3.5'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'KHTML 3.5'
      LayoutEngineNameVersionMajor         : 'KHTML 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'Konqueror'
      AgentVersion                         : '3.5'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Konqueror 3.5'
      AgentNameVersionMajor                : 'Konqueror 3'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/4.4; Linux 2.6.32-22-generic; X11; en_US) KHTML/4.4.3 (like Gecko) Kubuntu'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Kubuntu ??'
      OperatingSystemNameVersionMajor      : 'Kubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'KHTML'
      LayoutEngineVersion                  : '4.4'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'KHTML 4.4'
      LayoutEngineNameVersionMajor         : 'KHTML 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Konqueror'
      AgentVersion                         : '4.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Konqueror 4.4'
      AgentNameVersionMajor                : 'Konqueror 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Ubuntu 15.04) AppleWebKit/1.1.1 Chromium/2.2.2 Safari/5.5.5'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '15.04'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'Ubuntu 15.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '1.1.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'AppleWebKit 1.1.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '2.2.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Chromium 2.2.2'
      AgentNameVersionMajor                : 'Chromium 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Ubuntu 15.04 like Android 4.4) AppleWebKit/1.1.1 Chromium/2.2.2 Mobile Safari/5.5.5'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Linux Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Ubuntu Touch'
      OperatingSystemVersion               : '15.04'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'Ubuntu Touch 15.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu Touch 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '1.1.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'AppleWebKit 1.1.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '2.2.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Chromium 2.2.2'
      AgentNameVersionMajor                : 'Chromium 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Ubuntu 16.04) AppleWebKit/1.1.1 Chromium/2.2.2 Safari/5.5.5'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '16.04'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'Ubuntu 16.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 16'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '1.1.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'AppleWebKit 1.1.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '2.2.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Chromium 2.2.2'
      AgentNameVersionMajor                : 'Chromium 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Epiphany/4.4.4 Firefox/8.8.8 (Ubuntu-feisty)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '7.04'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Ubuntu 7.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '4.4.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Epiphany 4.4.4'
      AgentNameVersionMajor                : 'Epiphany 4'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Epiphany/4.4.4 (Ubuntu)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '4.4.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Epiphany 4.4.4'
      AgentNameVersionMajor                : 'Epiphany 4'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Epiphany/4.4.4 (Ubuntu) (Ubuntu package 1.0.7)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '4.4.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Epiphany 4.4.4'
      AgentNameVersionMajor                : 'Epiphany 4'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Firefox/8.8.8 (Kubuntu)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Kubuntu ??'
      OperatingSystemNameVersionMajor      : 'Kubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Firefox/8.8.8 Ubuntu'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Firefox/8.8.8 (Ubuntu-edgy)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '6.10'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Ubuntu 6.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Firefox/8.8.8 (Ubuntu package 1.0.2)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Galeon/2.0.1 (Ubuntu package 2.0.1-1ubuntu2) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Galeon'
      AgentVersion                         : '2.0.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Galeon 2.0.1'
      AgentNameVersionMajor                : 'Galeon 2'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Iceape/1.1.5 (Ubuntu-1.1.5-1ubuntu0.7.10)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Iceape'
      AgentVersion                         : '1.1.5'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Iceape 1.1.5'
      AgentNameVersionMajor                : 'Iceape 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Kubuntu/8.10 (intrepid) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Kubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Kubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 MEGAUPLOAD 1.0 (Ubuntu-feisty)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '7.04'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Ubuntu 7.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'MEGAUPLOAD'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'MEGAUPLOAD 1.0'
      AgentNameVersionMajor                : 'MEGAUPLOAD 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 SeaMonkey/1.1.9 (Ubuntu-1.1.9+nobinonly-0ubuntu1)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'SeaMonkey'
      AgentVersion                         : '1.1.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'SeaMonkey 1.1.9'
      AgentNameVersionMajor                : 'SeaMonkey 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/10.04 (lucid) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '10.04'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Ubuntu 10.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/10.04 (lucid) Namoroka/7.7.7'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '10.04'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Ubuntu 10.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Namoroka'
      AgentVersion                         : '7.7.7'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Namoroka 7.7.7'
      AgentNameVersionMajor                : 'Namoroka 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/1.4.0 (hardy) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '1.4.0'
      OperatingSystemVersionMajor          : '1'
      OperatingSystemNameVersion           : 'Ubuntu 1.4.0'
      OperatingSystemNameVersionMajor      : 'Ubuntu 1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/1.5.dfsg-4ubuntu6 Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '1.5.dfsg-4ubuntu6'
      OperatingSystemVersionMajor          : '1'
      OperatingSystemNameVersion           : 'Ubuntu 1.5.dfsg-4ubuntu6'
      OperatingSystemNameVersionMajor      : 'Ubuntu 1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/8.10 (intrepid) Shiretoko/3.3.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Ubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Shiretoko'
      AgentVersion                         : '3.3.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Shiretoko 3.3.3'
      AgentNameVersionMajor                : 'Shiretoko 3'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/9.04 (jaunty) Iceweasel/3.0.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '9.04'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Ubuntu 9.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Iceweasel'
      AgentVersion                         : '3.0.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Iceweasel 3.0.2'
      AgentNameVersionMajor                : 'Iceweasel 3'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/9.04 (jaunty) Minefield/3.2a1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '9.04'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Ubuntu 9.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Minefield'
      AgentVersion                         : '3.2a1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Minefield 3.2a1'
      AgentNameVersionMajor                : 'Minefield 3'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/9.04 (jaunty) Namoroka/7.7.7'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '9.04'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Ubuntu 9.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Namoroka'
      AgentVersion                         : '7.7.7'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Namoroka 7.7.7'
      AgentNameVersionMajor                : 'Namoroka 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; en; rv:12.3) Gecko/2000000000 Ubuntu/9.25 (jaunty) Firefox/8.8.8'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '9.25'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Ubuntu 9.25'
      OperatingSystemNameVersionMajor      : 'Ubuntu 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '12.3'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'Gecko 12.3'
      LayoutEngineNameVersionMajor         : 'Gecko 12'
      LayoutEngineBuild                    : '2000000000'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '8.8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Firefox 8.8.8'
      AgentNameVersionMajor                : 'Firefox 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

