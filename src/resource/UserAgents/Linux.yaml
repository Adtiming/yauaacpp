#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:

# We see the following patterns
# Linux <version>
# Linux <cpu>
# Linux <version> <cpu>

# Default in case there is a very bare set of comments.
- matcher:
    require:
    - 'agent.(1)product.comments.entry.(1-2)text="X11"'
    - 'IsNull[agent.(1)product.(1)comments.(2)entry]'
    extract:
    - 'DeviceClass                         :        1 :"Desktop"'
    - 'DeviceName                          :        1 :"Linux Desktop"'
    - 'OperatingSystemClass                :        1 :"Desktop"'
    - 'OperatingSystemName                 :        1 :"Linux"'

- matcher:
    require:
    - 'IsNull[agent.(1-2)product.comments.entry.(1-2)text="Android"]'
    extract:
    - 'DeviceClass                         :        5 :"Desktop"'
    - 'DeviceName                          :        5 :"Linux Desktop"'
    - 'OperatingSystemClass                :        5 :"Desktop"'
    - 'OperatingSystemName                 :        5 :"Linux"'
    - 'OperatingSystemVersion              :        4 :agent.(1-2)product.(1)comments.entry.(1-2)product.name="Linux"^.version?!UnwantedVersionValues'

- matcher:
    require:
    - 'IsNull[agent.(1-2)product.comments.entry.(1-2)text="Android"]'
    extract:
    - 'DeviceClass                         :        5 :"Desktop"'
    - 'DeviceName                          :        5 :"Linux Desktop"'
    - 'OperatingSystemClass                :        5 :"Desktop"'
    - 'OperatingSystemName                 :        5 :"Linux"'
    - 'OperatingSystemVersion              :        3 :agent.product.name="Linux"^.version?!UnwantedVersionValues'

- matcher:
    require:
    - 'IsNull[agent.(1-2)product.comments.entry.(1-2)text="Android"]'
    - 'agent.(1-2)product.(1)comments.entry.(1-2)text[1]="Linux"'
    extract:
    - 'DeviceClass                         :        5 :"Desktop"'
    - 'DeviceName                          :        5 :"Linux Desktop"'
    - 'OperatingSystemClass                :        5 :"Desktop"'
    - 'OperatingSystemName                 :        5 :"Linux"'
    - 'OperatingSystemVersion              :        1 :"<<<null>>>"'

- matcher:
    variable:
    - 'LinuxVersion                        :agent.(1-2)product.(1)comments.entry.product.name="Linux"^.(1)version?!UnwantedVersionValues'
    require:
    - 'IsNull[LookUp[CPUArchitectures;@LinuxVersion]]'
    extract:
#        - 'DeviceCpu             :   1:"<<<null>>>"'
    - 'OperatingSystemVersion              :        5 :@LinuxVersion'

- matcher:
    variable:
    - 'Linux                               :agent.(1-2)product.(1)comments.entry.product.name="Linux"^'
    extract:
    - 'DeviceCpu                           :       15 :LookUp[CPUArchitectures;@Linux.(2)version]'
    - 'OperatingSystemVersion              :       15 :@Linux.(1)version?!UnwantedVersionValues'

- matcher:
    require:
    - 'agent.product.(1)comments.entry[1-1]="Linux"'
    - 'IsNull[agent.product.(1)comments.entry[1-1]="Android"]'
    - 'IsNull[agent.product.(1)comments.entry[1-1]="Windows"]'
    extract:
    - 'DeviceClass                         :        4 :"Desktop"'
    - 'DeviceName                          :        4 :"Linux Desktop"'
    - 'OperatingSystemClass                :        3 :"Desktop"'
    - 'OperatingSystemName                 :        3 :"Linux"'
    - 'OperatingSystemVersion              :        3 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry[1-1]="Wine64"'
    extract:
    - 'DeviceClass                         :     3004 :"Desktop"'
    - 'DeviceName                          :     3004 :"Linux Desktop"'
    - 'OperatingSystemClass                :     3003 :"Desktop"'
    - 'OperatingSystemName                 :     3003 :"Linux"'
    - 'OperatingSystemVersion              :     3000 :"<<<null>>>"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; rv:1.7.3) Gecko/20040919 Firefox/0.10'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.7.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.7.3'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20040919'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '0.10'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Firefox 0.10'
      AgentNameVersionMajor                : 'Firefox 0'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/7.54 (Linux 2.4.18-xfs i686; U)  [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '2.4.18-xfs'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Linux 2.4.18-xfs'
      OperatingSystemNameVersionMajor      : 'Linux 2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '7.54'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera 7.54'
      AgentNameVersionMajor                : 'Opera 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; X11; Linux ppc; en) Opera 8.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'PowerPC'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Opera 8.0'
      AgentNameVersionMajor                : 'Opera 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64; U) Opera 7.54  [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '7.54'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera 7.54'
      AgentNameVersionMajor                : 'Opera 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Links (2.1pre17; Linux 2.4.18-rmk7-pxa3-embedix armv5tel; 73x33)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv5tel'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '2.4.18-rmk7-pxa3-embedix'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Linux 2.4.18-rmk7-pxa3-embedix'
      OperatingSystemNameVersionMajor      : 'Linux 2'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Links'
      AgentVersion                         : '2.1pre17'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Links 2.1pre17'
      AgentNameVersionMajor                : 'Links 2'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Qt embedded; Linux armv5tel; 640x480) Opera 7.30  [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv5tel'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '7.30'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera 7.30'
      AgentNameVersionMajor                : 'Opera 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '35.0'
      LayoutEngineVersionMajor             : '35'
      LayoutEngineNameVersion              : 'Gecko 35.0'
      LayoutEngineNameVersionMajor         : 'Gecko 35'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '35.0'
      AgentVersionMajor                    : '35'
      AgentNameVersion                     : 'Firefox 35.0'
      AgentNameVersionMajor                : 'Firefox 35'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/39.0.2171.65 Chrome/39.0.2171.65 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '39.0.2171.65'
      AgentVersionMajor                    : '39'
      AgentNameVersion                     : 'Chromium 39.0.2171.65'
      AgentNameVersionMajor                : 'Chromium 39'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/538.15 (KHTML, like Gecko) Version/8.0 Safari/538.15 Ubuntu/14.10 (3.10.3-0ubuntu3) Epiphany/3.10.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '14.10'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'Ubuntu 14.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 14'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.15'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.10.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.10.3'
      AgentNameVersionMajor                : 'Epiphany 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Safari/605.1.15 Ubuntu/16.04 (3.18.11-0ubuntu1) Epiphany/3.18.11'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '16.04'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'Ubuntu 16.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu 16'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.18.11'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.18.11'
      AgentNameVersionMajor                : 'Epiphany 3'


- matcher:
    extract:
    - 'OperatingSystemClass                :     2010 :"Desktop"'
    - 'OperatingSystemName                 :     2010 :"Elementary OS"'
    - 'OperatingSystemVersion              :     2010 :agent.product.name="Elementary OS"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/604.1 (KHTML, like Gecko) Version/11.0 Safari/604.1 elementary OS/0.4 (Loki) Epiphany/3.18.11'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Elementary OS'
      OperatingSystemVersion               : '0.4'
      OperatingSystemVersionMajor          : '0'
      OperatingSystemNameVersion           : 'Elementary OS 0.4'
      OperatingSystemNameVersionMajor      : 'Elementary OS 0'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.1'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.18.11'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.18.11'
      AgentNameVersionMajor                : 'Epiphany 3'


- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; FreeBSD 9.1-RELEASE-p7 amd64) Presto/2.12.388 Version/12.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'AMD64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '9.1-RELEASE-p7'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'FreeBSD 9.1-RELEASE-p7'
      OperatingSystemNameVersionMajor      : 'FreeBSD 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '12.16'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera 12.16'
      AgentNameVersionMajor                : 'Opera 12'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; OpenBSD i386; rv:34.0) Gecko/20100101 Firefox/34.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'OpenBSD ??'
      OperatingSystemNameVersionMajor      : 'OpenBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '34.0'
      LayoutEngineVersionMajor             : '34'
      LayoutEngineNameVersion              : 'Gecko 34.0'
      LayoutEngineNameVersionMajor         : 'Gecko 34'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '34.0'
      AgentVersionMajor                    : '34'
      AgentNameVersion                     : 'Firefox 34.0'
      AgentNameVersionMajor                : 'Firefox 34'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; NetBSD i386; rv:17.0) Gecko/20121224 Firefox/17.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Netbsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'NetBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'NetBSD ??'
      OperatingSystemNameVersionMajor      : 'NetBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '17.0'
      LayoutEngineVersionMajor             : '17'
      LayoutEngineNameVersion              : 'Gecko 17.0'
      LayoutEngineNameVersionMajor         : 'Gecko 17'
      LayoutEngineBuild                    : '20121224'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '17.0'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Firefox 17.0'
      AgentNameVersionMajor                : 'Firefox 17'

- matcher:
    variable:
    - 'MozillaVersion                      :agent.(1)product.name="Mozilla"^.version'
    extract:
    - 'LayoutEngineClass                   :        3 :"Browser"'
    - 'LayoutEngineName                    :        3 :"Mozilla"'
    - 'LayoutEngineVersion                 :        3 :@MozillaVersion'
    - 'AgentClass                          :        3 :"Browser"'
    - 'AgentName                           :        3 :"Netscape"'
    - 'AgentVersion                        :        3 :@MozillaVersion'

- test:
    input:
      user_agent_string: 'Mozilla 1.7.2 (FreeBSD 5.2.1) [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '5.2.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'FreeBSD 5.2.1'
      OperatingSystemNameVersionMajor      : 'FreeBSD 5'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '1.7.2'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Mozilla 1.7.2'
      LayoutEngineNameVersionMajor         : 'Mozilla 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '1.7.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Netscape 1.7.2'
      AgentNameVersionMajor                : 'Netscape 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; DragonFly i386; de; rv:1.9.1) Gecko/20090720 Firefox/3.5.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'DragonFly BSD Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'DragonFly BSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'DragonFly BSD ??'
      OperatingSystemNameVersionMajor      : 'DragonFly BSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.1'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20090720'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.5.1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.5.1'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'German'
      AgentLanguageCode                    : 'de'
      AgentSecurity                        : 'Strong security'

# Joli
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Jolicloud Linux i686) AppleWebKit/537.6 (KHTML, like Gecko) Joli OS/1.2 Chromium/23.0.1240.0 Chrome/23.0.1240.0 Safari/537.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Joli OS'
      OperatingSystemVersion               : '1.2'
      OperatingSystemVersionMajor          : '1'
      OperatingSystemNameVersion           : 'Joli OS 1.2'
      OperatingSystemNameVersionMajor      : 'Joli OS 1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.6'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '23.0.1240.0'
      AgentVersionMajor                    : '23'
      AgentNameVersion                     : 'Chromium 23.0.1240.0'
      AgentNameVersionMajor                : 'Chromium 23'

# Linux Mint
- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; Linux i686; Edition Linux Mint) Presto/2.12.388 Version/12.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux Mint'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux Mint ??'
      OperatingSystemNameVersionMajor      : 'Linux Mint ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '12.16'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera 12.16'
      AgentNameVersionMajor                : 'Opera 12'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.1.3) Gecko/20091020 Linux Mint/8 (Helena) Firefox/3.5.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux Mint'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Linux Mint 8'
      OperatingSystemNameVersionMajor      : 'Linux Mint 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.1.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.1.3'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20091020'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.5.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.5.3'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.10) Gecko/20100922 Linux Mint/10 (Julia) Firefox/3.6.10'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux Mint'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Linux Mint 10'
      OperatingSystemNameVersionMajor      : 'Linux Mint 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.10'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.10'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20100922'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.10'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.10'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

# Detect the patterns in the second product
- test:
    input:
      user_agent_string: 'Mozilla/5.0 Galeon/1.2.0 (X11; Linux i686; U;) Gecko/20020326'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Galeon'
      AgentVersion                         : '1.2.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Galeon 1.2.0'
      AgentNameVersionMajor                : 'Galeon 1'
      AgentSecurity                        : 'Strong security'


# https://wiki.ubuntu.com/UbuntuFlavors
# - Ubuntu
# - Kubuntu
# - Edubuntu
# - Xubuntu
# - Mythbuntu
# - UbuntuStudio
# - Lubuntu
# - Ubuntu GNOME
# - Ubuntu Kylin
# - Ubuntu MATE

- matcher:
    variable:
    - 'UbuntuProductName                   :agent.(1)product.(1)comments.entry.(1)product.name~"buntu"'
    extract:
    - 'OperatingSystemName                 :      100 :@UbuntuProductName'
    - 'OperatingSystemVersion              :      100 :@UbuntuProductName^.version="14.04.1"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.5; Linux) KHTML/3.5.9 (like Gecko) (Kubuntu)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Kubuntu ??'
      OperatingSystemNameVersionMajor      : 'Kubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'KHTML'
      LayoutEngineVersion                  : '3.5'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'KHTML 3.5'
      LayoutEngineNameVersionMajor         : 'KHTML 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'Konqueror'
      AgentVersion                         : '3.5'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Konqueror 3.5'
      AgentNameVersionMajor                : 'Konqueror 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/4.4; Linux) KHTML/4.4.5 (like Gecko) Kubuntu'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Kubuntu ??'
      OperatingSystemNameVersionMajor      : 'Kubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'KHTML'
      LayoutEngineVersion                  : '4.4'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'KHTML 4.4'
      LayoutEngineNameVersionMajor         : 'KHTML 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Konqueror'
      AgentVersion                         : '4.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Konqueror 4.4'
      AgentNameVersionMajor                : 'Konqueror 4'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64; ChaletOS based on Xubuntu 14.04.1 LTS) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.0 Maxthon/1.0.5.3 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'ChaletOS based on Xubuntu'
      OperatingSystemVersion               : '14.04.1'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'ChaletOS based on Xubuntu 14.04.1'
      OperatingSystemNameVersionMajor      : 'ChaletOS based on Xubuntu 14'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser'
      AgentName                            : 'Maxthon'
      AgentVersion                         : '1.0.5.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Maxthon 1.0.5.3'
      AgentNameVersionMajor                : 'Maxthon 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.0.7) Gecko/2009030422 Kubuntu/8.10 (intrepid) Firefox/3.0.9'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Kubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Kubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.0.7'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.0.7'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '2009030422'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.0.9'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.0.9'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'Polish (Poland)'
      AgentLanguageCode                    : 'pl-pl'
      AgentSecurity                        : 'Strong security'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.2a1pre) Gecko/20090128 Kubuntu/8.10 (intrepid) Minefield/3.2a1pre'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Kubuntu'
      OperatingSystemVersion               : '8.10'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Kubuntu 8.10'
      OperatingSystemNameVersionMajor      : 'Kubuntu 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2a1pre'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2a1pre'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20090128'
      AgentClass                           : 'Browser'
      AgentName                            : 'Minefield'
      AgentVersion                         : '3.2a1pre'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Minefield 3.2a1pre'
      AgentNameVersionMajor                : 'Minefield 3'
      AgentLanguage                        : 'Polish (Poland)'
      AgentLanguageCode                    : 'pl-pl'
      AgentSecurity                        : 'Strong security'


#
#  - matcher:
#      require:
#        - 'agent.(1)product.(1)comments.entry.(1-2)text="Fedora"'
#      extract:
#        - 'DeviceClass           :   5:"Desktop"'
#        - 'DeviceName            :   5:"Linux Desktop"'
#        - 'OperatingSystemClass  :   100:"Desktop"'
#        - 'OperatingSystemName   :   100:"Fedora Linux"'
#        - 'OperatingSystemVersion:   100:"<<<null>>>"'
#
#  - matcher:
#      extract:
#        - 'DeviceClass           :   5:"Desktop"'
#        - 'DeviceName            :   5:"Linux Desktop"'
#        - 'OperatingSystemClass  :   100:"Desktop"'
#        - 'OperatingSystemName   :   100:"Fedora Linux"'
#        - 'OperatingSystemVersion:   100:agent.(1)product.(1)comments.entry.product.name="Fedora"^.version'
#
#  - matcher:
#      extract:
#        - 'DeviceClass           :   5:"Desktop"'
#        - 'DeviceName            :   5:"Linux Desktop"'
#        - 'OperatingSystemClass  :   100:"Desktop"'
#        - 'OperatingSystemName   :   100:"Fedora Linux"'
#        - 'OperatingSystemVersion:   100:agent.product.name="Fedora"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:36.0) Gecko/20100101 Firefox/36.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Fedora'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Fedora ??'
      OperatingSystemNameVersionMajor      : 'Fedora ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '36.0'
      LayoutEngineVersionMajor             : '36'
      LayoutEngineNameVersion              : 'Gecko 36.0'
      LayoutEngineNameVersionMajor         : 'Gecko 36'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '36.0'
      AgentVersionMajor                    : '36'
      AgentNameVersion                     : 'Firefox 36.0'
      AgentNameVersionMajor                : 'Firefox 36'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Fedora 20; rv:31.0) Gecko/31.0 Firefox/31.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Fedora'
      OperatingSystemVersion               : '20'
      OperatingSystemVersionMajor          : '20'
      OperatingSystemNameVersion           : 'Fedora 20'
      OperatingSystemNameVersionMajor      : 'Fedora 20'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '31.0'
      LayoutEngineVersionMajor             : '31'
      LayoutEngineNameVersion              : 'Gecko 31.0'
      LayoutEngineNameVersionMajor         : 'Gecko 31'
      LayoutEngineBuild                    : '31.0'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '31.0'
      AgentVersionMajor                    : '31'
      AgentNameVersion                     : 'Firefox 31.0'
      AgentNameVersionMajor                : 'Firefox 31'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.17) Gecko/20110428 Fedora/3.6.17-1.fc13 Firefox/3.6.17'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Fedora'
      OperatingSystemVersion               : '3.6.17-1.fc13'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'Fedora 3.6.17-1.fc13'
      OperatingSystemNameVersionMajor      : 'Fedora 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.17'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.17'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20110428'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.17'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.17'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

#Centos
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.15) Gecko/20110330 CentOS/3.6-1.el5.centos Firefox/3.6.15'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'CentOS'
      OperatingSystemVersion               : '3.6-1.el5.centos'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'CentOS 3.6-1.el5.centos'
      OperatingSystemNameVersionMajor      : 'CentOS 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.15'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.15'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20110330'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.15'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.15'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

#Suse
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; nl; rv:1.9.2.3) Gecko/20100401 SUSE/3.6.3-1.2 Firefox/3.6.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '3.6.3-1.2'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'SUSE 3.6.3-1.2'
      OperatingSystemNameVersionMajor      : 'SUSE 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.3'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20100401'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.3'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; nl; rv:1.9.0.4) Gecko/2008103100 SUSE/3.0.4-4.6 Firefox/3.0.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '3.0.4-4.6'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'SUSE 3.0.4-4.6'
      OperatingSystemNameVersionMajor      : 'SUSE 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.0.4'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.0.4'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '2008103100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.0.4'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.0.4'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.4) Gecko/20091016 SUSE/3.5.4-1.1.2 Firefox/3.5.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '3.5.4-1.1.2'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'SUSE 3.5.4-1.1.2'
      OperatingSystemNameVersionMajor      : 'SUSE 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.1.4'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.1.4'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20091016'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.5.4'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.5.4'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; nl; rv:1.9.2.24) Gecko/20111101 SUSE/3.6.24-0.2.1 Firefox/3.6.24'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '3.6.24-0.2.1'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'SUSE 3.6.24-0.2.1'
      OperatingSystemNameVersionMajor      : 'SUSE 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.24'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.24'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20111101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.24'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.24'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.32 (KHTML, like Gecko) Chrome/27.0.1425.0 Safari/537.32 SUSE/27.0.1425.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '27.0.1425.0'
      OperatingSystemVersionMajor          : '27'
      OperatingSystemNameVersion           : 'SUSE 27.0.1425.0'
      OperatingSystemNameVersionMajor      : 'SUSE 27'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.32'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.32'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '27.0.1425.0'
      AgentVersionMajor                    : '27'
      AgentNameVersion                     : 'Chrome 27.0.1425.0'
      AgentNameVersionMajor                : 'Chrome 27'

- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; Linux x86_64; Suse) Presto/2.12.388 Version/12.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'SUSE ??'
      OperatingSystemNameVersionMajor      : 'SUSE ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '12.16'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera 12.16'
      AgentNameVersionMajor                : 'Opera 12'

- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; Linux x86_64; CenToS) Presto/2.12.388 Version/12.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'CentOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'CentOS ??'
      OperatingSystemNameVersionMajor      : 'CentOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '12.16'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera 12.16'
      AgentNameVersionMajor                : 'Opera 12'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; ARM Mac OS X) AppleWebKit/538.15 (KHTML, like Gecko) Safari/538.15 Version/6.0 Debian/7.8 (3.8.2.0-0rpi18rpi1) Epiphany/3.8.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARM'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Debian'
      OperatingSystemVersion               : '7.8'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Debian 7.8'
      OperatingSystemNameVersionMajor      : 'Debian 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.15'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.8.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.8.2'
      AgentNameVersionMajor                : 'Epiphany 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; Debian GNU/Linux 7.8 (wheezy)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.0 Maxthon/1.0.5.3 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Debian'
      OperatingSystemVersion               : '7.8'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Debian 7.8'
      OperatingSystemNameVersionMajor      : 'Debian 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser'
      AgentName                            : 'Maxthon'
      AgentVersion                         : '1.0.5.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Maxthon 1.0.5.3'
      AgentNameVersionMajor                : 'Maxthon 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux armv7l) AppleWebKit/537.6+ (KHTML, like Gecko) Chromium/23.0.1271.95 Chrome/23.0.1271.95 Safari/537.6+ SugarLabs/0.98'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SugarLabs'
      OperatingSystemVersion               : '0.98'
      OperatingSystemVersionMajor          : '0'
      OperatingSystemNameVersion           : 'SugarLabs 0.98'
      OperatingSystemNameVersionMajor      : 'SugarLabs 0'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.6'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '23.0.1271.95'
      AgentVersionMajor                    : '23'
      AgentNameVersion                     : 'Chromium 23.0.1271.95'
      AgentNameVersionMajor                : 'Chromium 23'

# Ubuntu Touch
- matcher:
    require:
    - 'agent.(1)product.(1)comments.(2)entry.(2)product.name="like Android"'
    extract:
    - 'DeviceName                          :      160 :"Linux Mobile"'
    - 'OperatingSystemClass                :      160 :"Mobile"'
    - 'OperatingSystemName                 :      160 :"Ubuntu Touch"'
    - 'OperatingSystemVersion              :      160 :agent.(1)product.(1)comments.(2)entry.(1)product.name="Ubuntu"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Ubuntu 15.04 like Android 4.4) AppleWebKit/537.36 Chromium/51.0.2704.79 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Linux Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Ubuntu Touch'
      OperatingSystemVersion               : '15.04'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'Ubuntu Touch 15.04'
      OperatingSystemNameVersionMajor      : 'Ubuntu Touch 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '51.0.2704.79'
      AgentVersionMajor                    : '51'
      AgentNameVersion                     : 'Chromium 51.0.2704.79'
      AgentNameVersionMajor                : 'Chromium 51'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)text="hp-tablet"'
    extract:
    - 'DeviceClass                         :      360 :"Tablet"'
    - 'DeviceName                          :      360 :"HP TouchPad"'
    - 'DeviceBrand                         :      360 :"HP"'
    - 'DeviceVersion                       :      360 :agent.product.name="TouchPad"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.5; U; en-US) AppleWebKit/534.6 (KHTML, like Gecko) wOSBrowser/234.83 Safari/534.6 TouchPad/1.0'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'HP TouchPad'
      DeviceBrand                          : 'HP'
      DeviceVersion                        : '1.0'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'HP WebOS'
      OperatingSystemVersion               : '3.0.5'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'HP WebOS 3.0.5'
      OperatingSystemNameVersionMajor      : 'HP WebOS 3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.6'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'wOSBrowser'
      AgentVersion                         : '234.83'
      AgentVersionMajor                    : '234'
      AgentNameVersion                     : 'wOSBrowser 234.83'
      AgentNameVersionMajor                : 'wOSBrowser 234'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


# Chromium on a Raspberry PI 3B+
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux armv7l) AppleWebKit/537.36 (KHTML, like Gecko) Raspbian Chromium/74.0.3729.157 Chrome/74.0.3729.157 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Raspberry PI'
      DeviceBrand                          : 'Raspberry'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Raspbian'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Raspbian ??'
      OperatingSystemNameVersionMajor      : 'Raspbian ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '74.0'
      LayoutEngineVersionMajor             : '74'
      LayoutEngineNameVersion              : 'Blink 74.0'
      LayoutEngineNameVersionMajor         : 'Blink 74'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '74.0.3729.157'
      AgentVersionMajor                    : '74'
      AgentNameVersion                     : 'Chromium 74.0.3729.157'
      AgentNameVersionMajor                : 'Chromium 74'

- test:
    input:
      user_agent_string: 'Kodi/14.1 (X11; Linux armv6l) Raspbian GNU/Linux/7 HW_RaspberryPi/1.0 App_Bitness/32 Version/14.1-Git:2015-02-02-81c4046-dirty'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Raspberry PI'
      DeviceBrand                          : 'Raspberry'
      DeviceCpu                            : 'ARMv6l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Raspbian'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Raspbian ??'
      OperatingSystemNameVersionMajor      : 'Raspbian ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'Kodi'
      AgentVersion                         : '14.1'
      AgentVersionMajor                    : '14'
      AgentNameVersion                     : 'Kodi 14.1'
      AgentNameVersionMajor                : 'Kodi 14'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux armv6l) AppleWebKit/538.15 (KHTML, like Gecko) Version/8.0 Safari/538.15 Raspbian/9.0 (1:3.8.2.0-0rpi28) Epiphany/3.8.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Raspberry PI'
      DeviceBrand                          : 'Raspberry'
      DeviceCpu                            : 'ARMv6l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Raspbian'
      OperatingSystemVersion               : '9.0'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Raspbian 9.0'
      OperatingSystemNameVersionMajor      : 'Raspbian 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.15'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.8.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.8.2'
      AgentNameVersionMajor                : 'Epiphany 3'

#Mozilla/5.0 (X11; U; Linux i686; nl-nl) AppleWebKit/531.2+ (KHTML, like Gecko) Version/5.0 Safari/531.2+ Debian/squeeze (2.30.6-1) Epiphany/2.30.6
#Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.16) Gecko/2009121609 Iceweasel/3.0.6 (Debian-3.0.6-3)

#34      228     Mozilla/5.0 (X11; Linux x86_64) KHTML/4.8.5 (like Gecko) Konqueror/4.8 Fedora/4.8.5-2.fc16
#18      91      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) konqueror/4.14.3 Safari/537.21
#8       24      Mozilla/5.0 (X11; Linux x86_64) KHTML/4.8.4 (like Gecko) Konqueror/4.8
#7       67      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) konqueror/4.14.4 Safari/537.21
#6       35      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) konqueror/4.14.2 Safari/537.21
#5       86      Mozilla/5.0 (X11; Linux i686) AppleWebKit/534.34 (KHTML, like Gecko) konqueror/4.10.5 Safari/534.34
#5       14      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.34 (KHTML, like Gecko) konqueror/4.10.5 Safari/534.34
#5       13      Mozilla/5.0 (compatible; Konqueror/4.4; Linux) KHTML/4.4.5 (like Gecko)
#5       12      Mozilla/5.0 (X11; Linux 3.8-6.dmz.1-liquorix-686) KHTML/4.8.4 (like Gecko) Konqueror/4.8
#4       8       Mozilla/5.0 (X11; Linux x86_64) KHTML/4.14.2 (like Gecko) Konqueror/4.14
#4       6       Mozilla/5.0 (compatible; Konqueror/4.4; Linux 2.6.32-22-generic; X11; en_US) KHTML/4.4.3 (like Gecko) Kubuntu
#4       5       Mozilla/5.0 (X11; FreeBSD) KHTML/4.9.1 (like Gecko) Konqueror/4.9
#4       4       Mozilla/5.0 (compatible; Konqueror/3.2; FreeBSD) (KHTML, like Gecko)
#3       7       Mozilla/5.0 (X11; Linux x86_64) KHTML/4.13.3 (like Gecko) Konqueror/4.13
#3       7       Mozilla/5.0 (X11; Linux i686) KHTML/4.13.3 (like Gecko) Konqueror/4.13
#3       6       Mozilla/5.0 (compatible; Konqueror/3.5; Darwin)  KHTML/3.5.6 (like Gecko)
#Opera/9.80 (X11; FreeBSD 10.1-RELEASE-p17 amd64) Presto/2.12.388 Version/12.16
#Opera/9.80 (X11; FreeBSD 10.1-RELEASE-p5 amd64) Presto/2.12.388 Version/12.16
#Opera/9.80 (X11; FreeBSD 7.4-RELEASE amd64) Presto/2.12.388 Version/12.14
#Opera/9.80 (X11; FreeBSD 8.1-RELEASE i386; Edition Next) Presto/2.12.388 Version/12.10
#Opera/9.80 (X11; FreeBSD 8.4-RELEASE amd64) Presto/2.12.388 Version/12.16

