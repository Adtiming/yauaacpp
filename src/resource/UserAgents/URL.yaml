#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:

# In almost all cases the presence of a URL indicates that it is a Robot/Spider with an information URL
- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1502100 :agent.(1-10)keyvalue.(2)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1502100 :agent.(1-10)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1502200 :agent.(1-5)product.name.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1502300 :agent.(1-5)product.(1)version.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1502400 :agent.(1-5)product.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1504200 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)product.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1504300 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)product.name.(1)url'


- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1504400 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)product.(1-2)version.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1504500 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)keyvalue.(2)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1504600 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1503100 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1503200 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)product.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1503300 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)product.name.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1503400 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)product.version.(1)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationUrl                 :  1503500 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)keyvalue.(2)url'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1502100 :agent.(1-10)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1502200 :agent.(1-5)product.name.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1502300 :agent.(1-5)product.(1)version.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1502400 :agent.(1-5)product.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1501100 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1501200 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)product.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1501300 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)product.name.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1501400 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)product.(1-2)version.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1501500 :agent.(1-5)product.(1-2)comments.(1-10)entry.(1-3)keyvalue.(2)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1500100 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1500200 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)product.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1500300 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)product.name.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1500400 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)product.(1)version.(1)email'

- matcher:
    extract:
    - 'DeviceClass                         :        0 :"Robot"'
    - 'DeviceName                          :        0 :"Robot"'
    - 'OperatingSystemClass                :        0 :"Cloud"'
    - 'OperatingSystemName                 :        0 :"Cloud"'
    - 'OperatingSystemVersion              :        0 :"<<<null>>>"'
    - 'AgentClass                          :        0 :"Robot"'
    - 'AgentInformationEmail               :  1500500 :agent.(1-5)product.(1-2)comments.(1-5)entry.(1)product.(1)comments.(1-2)entry.(1-3)keyvalue.(2)email'



- test:
    input:
      user_agent_string: 'Mozilla/4.0 (http://example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'http://example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (www.example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'www.example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (URL=http://example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'http://example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (URL:http://example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'http://example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (info@example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationEmail                : 'info@example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (URL=info@example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationEmail                : 'info@example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (URL:info@example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationEmail                : 'info@example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ( Something (www.example.nl); else ... )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'www.example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ( Something (http://example.nl); else ... )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'http://example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ( Something (URL=http://example.nl); else ... )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'http://example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ( Something (URL:http://example.nl); else ... )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationUrl                  : 'http://example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ( Something (info@example.nl); else ... )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationEmail                : 'info@example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ( Something (URL=info@example.nl); else ... )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationEmail                : 'info@example.nl'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ( Something (URL:info@example.nl); else ... )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationEmail                : 'info@example.nl'

- test:
    input:
      user_agent_string: 'www.basjes.nl /info@basj.es'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Basjes Robot'
      DeviceBrand                          : 'Basjes'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Www.basjes.nl'
      AgentVersion                         : 'info@basj.es'
      AgentVersionMajor                    : 'info@basj.es'
      AgentNameVersion                     : 'Www.basjes.nl info@basj.es'
      AgentNameVersionMajor                : 'Www.basjes.nl info@basj.es'
      AgentInformationEmail                : 'info@basj.es'
      AgentInformationUrl                  : 'www.basjes.nl'

# With '+' signs in front.
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (+www.example.nl ; +info@example.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Example Robot'
      DeviceBrand                          : 'Example'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'
      AgentInformationEmail                : 'info@example.nl'
      AgentInformationUrl                  : 'www.example.nl'

- test:
    input:
      user_agent_string: 'Twikle/1.0 , http://twikle.com , contact@twikle.com'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Twikle Robot'
      DeviceBrand                          : 'Twikle'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Twikle'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Twikle 1.0'
      AgentNameVersionMajor                : 'Twikle 1'
      AgentInformationEmail                : 'contact@twikle.com'
      AgentInformationUrl                  : 'http://twikle.com'
