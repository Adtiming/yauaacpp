#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh); Intel Mac OS X 10_7_5) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.7.5'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.7.5'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.11'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.11'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '23.0.1271.97'
      AgentVersionMajor                    : '23'
      AgentNameVersion                     : 'Chrome 23.0.1271.97'
      AgentNameVersionMajor                : 'Chrome 23'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.2.2; nl-; YC-3135D Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'YC 3135D'
      DeviceBrand                          : 'YC'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JDQ39'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; HUAWEI P7-L10/HuaweiP7-L10C02B129 Browser/Browser/4.4.2) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei P7-L10'
      DeviceBrand                          : 'Huawei'
      DeviceVersion                        : 'HuaweiP7-L10C02B129'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'PB0.6b Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '23.0'
      LayoutEngineVersionMajor             : '23'
      LayoutEngineNameVersion              : 'Gecko 23.0'
      LayoutEngineNameVersionMajor         : 'Gecko 23'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'PirateBrowser'
      AgentVersion                         : 'PB0.6b'
      AgentVersionMajor                    : 'PB0'
      AgentNameVersion                     : 'PirateBrowser PB0.6b'
      AgentNameVersionMajor                : 'PirateBrowser PB0'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; BTRS31753; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E; staticlogin:product=cboxf2010&act=login&info=ZmlsZW5hbWU9UG93ZXJXb3JkMjAxME94Zl9VbHRpbWF0ZS5leGUmbWFjPTBGRTRFMzZCMUZBNTQ1RTQ5QUZGOEE1QzZDRkNERUEwJnBhc3Nwb3J0PSZ2ZXJzaW9uPTIwMTAuNi4zLjYuMiZjcmFzaHR5cGU9MQ==&verify=cced4bb7457606add430a1b6be544f30; InfoPath.3)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Internet Explorer 8.0'
      AgentNameVersionMajor                : 'Internet Explorer 8'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT; Win64; x64; rv:26.0) Gecko/20100101 Firefox/26.0 Waterfox/26.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '26.0'
      LayoutEngineVersionMajor             : '26'
      LayoutEngineNameVersion              : 'Gecko 26.0'
      LayoutEngineNameVersionMajor         : 'Gecko 26'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Waterfox'
      AgentVersion                         : '26.0'
      AgentVersionMajor                    : '26'
      AgentNameVersion                     : 'Waterfox 26.0'
      AgentNameVersionMajor                : 'Waterfox 26'

# Notice the SLASHES !!! Must make sure the javacode actually sees them this way !!!
- test:
    input:
      user_agent_string: 'Mozilla/5.0 \\(iPhone; CPU iPhone OS 7_0 like Mac OS X; en-us\\) AppleWebKit/537.51.1 \\(KHTML, like Gecko\\) Version/7.0 Mobile/11A465 Safari/9537.53'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11A465'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.0'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Safari 7.0'
      AgentNameVersionMajor                : 'Safari 7'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'

# Those { } gave a parse error that hid the rest.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0; {World Online})'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Vista'
      OperatingSystemVersionMajor          : 'Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      OperatingSystemNameVersionMajor      : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Trident 5.0'
      LayoutEngineNameVersionMajor         : 'Trident 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Internet Explorer 9.0'
      AgentNameVersionMajor                : 'Internet Explorer 9'

# These gave syntax errors in the 2016-04-01 version
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_2_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13D15; DDG-iOS-709'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13D15'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.2.1'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '709'
      AgentVersionMajor                    : '709'
      AgentNameVersion                     : 'DuckDuckGo 709'
      AgentNameVersionMajor                : 'DuckDuckGo 709'

# The random text in the comment caused problems
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; @Oj~?JYJ4Uig}MTTl|@Jr6js/DrNZl@zO/se+/; GTB7.5; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; Tablet PC 2.0)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Tablet PC'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Internet Explorer 8.0'
      AgentNameVersionMajor                : 'Internet Explorer 8'

# The lone '-' causes parse errors
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.1.2; -; GT-S6810 Build/JZO54K) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung GT-S6810'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.1.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.1.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JZO54K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.2.1; zh-cn; HUAWEI G610-U00 Build/HuaweiG610-U00) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 SogouMSE,SogouMobileBrowser/4.0.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei G610-U00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.1'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.1'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'HuaweiG610-U00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'SogouMobileBrowser'
      AgentVersion                         : '4.0.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'SogouMobileBrowser 4.0.0'
      AgentNameVersionMajor                : 'SogouMobileBrowser 4'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'

# This caused a NullPointerException in a previous version.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0.1) Gecko/ /10.0.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '10.0.1'
      LayoutEngineVersionMajor             : '10'
      LayoutEngineNameVersion              : 'Gecko 10.0.1'
      LayoutEngineNameVersionMajor         : 'Gecko 10'
      LayoutEngineBuild                    : '10.0.1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Gecko'
      AgentVersion                         : '10.0.1'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Gecko 10.0.1'
      AgentNameVersionMajor                : 'Gecko 10'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/538.1 (KHTML, like Gecko) index.html?Referrer=ADVNLGOO0020270001kop Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '538.1'
      AgentVersionMajor                    : '538'
      AgentNameVersion                     : 'Safari 538.1'
      AgentNameVersionMajor                : 'Safari 538'
      AgentInformationUrl                  : 'index.html?Referrer=ADVNLGOO0020270001kop'

  # Caused a syntax error because of the = in the version of Build
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.2.2; WETAB07D04B Build/=WETAB07D04B20140312) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.83 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'WETAB07D04B'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'WETAB07D04B20140312'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '47.0.2526.83'
      AgentVersionMajor                    : '47'
      AgentNameVersion                     : 'Chrome 47.0.2526.83'
      AgentNameVersionMajor                : 'Chrome 47'

  # Has { } parts
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0; {12Move})'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Vista'
      OperatingSystemVersionMajor          : 'Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      OperatingSystemNameVersionMajor      : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Trident 5.0'
      LayoutEngineNameVersionMajor         : 'Trident 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Internet Explorer 9.0'
      AgentNameVersionMajor                : 'Internet Explorer 9'

  # Has { } parts
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; Noldus B.V. {www.Noldus.com}; rv:11.0) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Noldus Desktop'
      DeviceBrand                          : 'Noldus'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8.1'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '11.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Internet Explorer 11.0'
      AgentNameVersionMajor                : 'Internet Explorer 11'
      AgentInformationUrl                  : 'www.Noldus.com'

# Too many spaces
- test:
    input:
      user_agent_string: 'Mozilla / 5.0 (iPhone; CPU iPhone OS 8_1_2 like Mac OS X) AppleWebKit / 600.1.4 (KHTML, like Gecko) Version / 8.0 Mobile / 12B440 Safari / 600.1.4'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12B440'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Safari 8.0'
      AgentNameVersionMajor                : 'Safari 8'

# Missing product name
- test:
    input:
      user_agent_string: '/5.0 (Windows; U; Windows NT 5.1; en-ZW) AppleWebKit/534.34 (KHTML, like Gecko)  QtWeb Internet Browser/3.8.5 http://www.QtWeb.net'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Qtweb Desktop'
      DeviceBrand                          : 'Qtweb'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'QtWeb Internet Browser'
      AgentVersion                         : '3.8.5'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'QtWeb Internet Browser 3.8.5'
      AgentNameVersionMajor                : 'QtWeb Internet Browser 3'
      AgentLanguage                        : 'English (Zimbabwe)'
      AgentLanguageCode                    : 'en-zw'
      AgentInformationUrl                  : 'http://www.QtWeb.net'
      AgentSecurity                        : 'Strong security'

## Barely anything
#  - test:
#      input:
#        user_agent_string: 'HttpClient'
#      expected:
#        AgentClass                         : 'Special'
#        AgentName                          : 'HttpClient'

## Barely anything
#  - test:
#      input:
#        user_agent_string: 'Go http package'
#      expected:
#        AgentClass                         : 'Special'
#        AgentName                          : 'Go http package'

## Barely anything
#  - test:
#      input:
#        user_agent_string: 'Java1.3.0'
#      expected:
#        AgentClass                         : 'Special'
#        AgentName                          : 'Java1.3.0'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; SM-N920S Build/LMY47X; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/47.0.2526.100 Mobile Safari/537.36;KAKAOTALK 1400218'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N920S'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LMY47X'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '47.0.2526.100'
      AgentVersionMajor                    : '47'
      AgentNameVersion                     : 'Chrome Webview 47.0.2526.100'
      AgentNameVersionMajor                : 'Chrome Webview 47'
      WebviewAppName                       : 'Kakaotalk'
      WebviewAppVersion                    : '1400218'
      WebviewAppVersionMajor               : '1400218'
      WebviewAppNameVersion                : 'Kakaotalk 1400218'
      WebviewAppNameVersionMajor           : 'Kakaotalk 1400218'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.4; MI NOTE LTE Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/33.0.0.0 Mobile Safari/537.36; leidianbrowser (100.0.2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi MI Note LTE'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '33.0.0.0'
      AgentVersionMajor                    : '33'
      AgentNameVersion                     : 'Chrome Webview 33.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 33'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1; Z820 Build/LMY47D); AppleWebkit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/37.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Z820'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LMY47D'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '37.0'
      LayoutEngineVersionMajor             : '37'
      LayoutEngineNameVersion              : 'Blink 37.0'
      LayoutEngineNameVersionMajor         : 'Blink 37'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '37.0.0.0'
      AgentVersionMajor                    : '37'
      AgentNameVersion                     : 'Chrome Webview 37.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 37'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0) 88XI4n5O'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Generic Windows Phone'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '7.5'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows Phone 7.5'
      OperatingSystemNameVersionMajor      : 'Windows Phone 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Trident 5.0'
      LayoutEngineNameVersionMajor         : 'Trident 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'IE Mobile'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'IE Mobile 9.0'
      AgentNameVersionMajor                : 'IE Mobile 9'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows Phone OS 7.0; Trident/3.1; IEMobile/7.0; Nokia;N70) 88XI4n5O'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia N70'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows Phone 7.0'
      OperatingSystemNameVersionMajor      : 'Windows Phone 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Internet Explorer 7.0'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'IE Mobile'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'IE Mobile 7.0'
      AgentNameVersionMajor                : 'IE Mobile 7'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70 - iOSWebview'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12F70'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.3'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.3'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '600.1.4'
      AgentVersionMajor                    : '600'
      AgentNameVersion                     : 'UIWebView 600.1.4'
      AgentNameVersionMajor                : 'UIWebView 600'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Java1.0.21.0'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Java'
      AgentVersion                         : '1.0.21.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Java 1.0.21.0'
      AgentNameVersionMajor                : 'Java 1'

- test:
    input:
      user_agent_string: 'WordPress/3.5; http://smartphone.ro'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Smartphone Robot'
      DeviceBrand                          : 'Smartphone'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'WordPress'
      AgentVersion                         : '3.5'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'WordPress 3.5'
      AgentNameVersionMajor                : 'WordPress 3'
      AgentInformationUrl                  : 'http://smartphone.ro'


- test:
    input:
      user_agent_string: 'WordPress.com; http://momspiration.nl'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Momspiration Robot'
      DeviceBrand                          : 'Momspiration'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'WordPress.com'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'WordPress.com ??'
      AgentNameVersionMajor                : 'WordPress.com ??'
      AgentInformationUrl                  : 'http://momspiration.nl'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.3; -nl; LT30p Build/9.2.A.1.205) AppleWebKit/537.16 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.16'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Sony LT30P'
      DeviceBrand                          : 'Sony'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.3'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : '9.2.A.1.205'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.16'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.16'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentSecurity                        : 'Strong security'

# iOSWebview --> We classify this as a webview
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Mobile/11D201 - iOSWebview'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11D201'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.2'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '537.51.2'
      AgentVersionMajor                    : '537'
      AgentNameVersion                     : 'UIWebView 537.51.2'
      AgentNameVersionMajor                : 'UIWebView 537'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Abonti/0.91 - http://www.abonti.com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Abonti Robot'
      DeviceBrand                          : 'Abonti'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Abonti'
      AgentVersion                         : '0.91'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Abonti 0.91'
      AgentNameVersionMajor                : 'Abonti 0'
      AgentInformationUrl                  : 'http://www.abonti.com'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; compatible; Abonti/0.91 - http://www.abonti.com ; Android 4.3; -nl; LT30p Build/9.2.A.1.205) AppleWebKit/537.51.2 (KHTML, like Gecko) Mobile/11D201 - iOSWebview'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Sony LT30P'
      DeviceBrand                          : 'Sony'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.3'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : '9.2.A.1.205'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.2'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Abonti'
      AgentVersion                         : '0.91'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Abonti 0.91'
      AgentNameVersionMajor                : 'Abonti 0'
      AgentInformationUrl                  : 'http://www.abonti.com'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

# Contains __ that breaks the parser
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70 Weibo (iPhone6,2__weibo__5.7.1__iphone__os8.3)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12F70'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.3'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.3'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '600.1.4'
      AgentVersionMajor                    : '600'
      AgentNameVersion                     : 'AppleWebKit 600.1.4'
      AgentNameVersionMajor                : 'AppleWebKit 600'

#The loose '-' in "SM - G900H" caused a parse error
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; SM - G900H Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G900H'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

# Parse errors due to missing version values
- test:
    input:
      user_agent_string: 'Lenovo-A750/S102 Linux/2.6.35.7 Android/2.3 Release/12.12.2011 Browser/AppleWebKit533.1 Profile/ Configuration/'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Lenovo A750'
      DeviceBrand                          : 'Lenovo'
      DeviceFirmwareVersion                : '12.12.2011'
      DeviceVersion                        : 'S102'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '2.3'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Android 2.3'
      OperatingSystemNameVersionMajor      : 'Android 2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : 'AppleWebKit533.1'
      LayoutEngineVersionMajor             : 'AppleWebKit533'
      LayoutEngineNameVersion              : 'AppleWebKit533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '2.3'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Stock Android Browser 2.3'
      AgentNameVersionMajor                : 'Stock Android Browser 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_2_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13D15 MOBILE-LEQUIPE/IOS/PHONE/6.9.3/(null)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13D15'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.2.1'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'MOBILE-LEQUIPE'
      AgentVersion                         : 'IOS'
      AgentVersionMajor                    : 'IOS'
      AgentNameVersion                     : 'MOBILE-LEQUIPE IOS'
      AgentNameVersionMajor                : 'MOBILE-LEQUIPE IOS'

# Multiple different browser names... eenie meenie minie moe
- test:
    input:
      user_agent_string: 'Opera/9.80 (Android; Opera Mini/7.28879/27.1662; U; en-us) Presto/2.8.119 Version/11.10 UCBrowser/8.4.1.204/145/33567/'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.8.119'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.8.119'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '8.4.1.204'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'UCBrowser 8.4.1.204'
      AgentNameVersionMajor                : 'UCBrowser 8'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

# Parse error due to value that looks like a BASE64
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_0_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12A405 rabbit%2F1.0 baiduboxapp/0_0.1.1.7_enohpi_4331_057/2.0.8_2C2%257enohPi/1099a/75301144EBD727E95FF2FCCE44CE285869CC516F1ORDGCCTNPA/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12A405'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.0.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.0.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Rabbit'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Rabbit 1.0'
      AgentNameVersionMajor                : 'Rabbit 1'

# Parse error about the " 480X854 motorola DROIDX" at the end
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 2.2.1; en-us; DROIDX Build/VZW) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 480X854 motorola DROIDX'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Droidx'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '2.2.1'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Android 2.2.1'
      OperatingSystemNameVersionMajor      : 'Android 2'
      OperatingSystemVersionBuild          : 'VZW'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0; iPhone; CPU iPhone OS 8_1_2 like Mac OS X; AppleWebKit/600.1.4; KHTML, like Gecko; Version/8.0 Mobile/12B440 Safari/600.1.4'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12B440'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Safari 8.0'
      AgentNameVersionMajor                : 'Safari 8'

# Parse errors due to the "{...}" parts
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 6.1; ar; rv:1.9.1) Gecko/20090624 AskTb{TB_NAME}/{TB_VERSION} Firefox/3.5'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.1'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20090624'
      AgentClass                           : 'Browser'
      AgentName                            : 'AskTb{TB_NAME}'
      AgentVersion                         : '{TB_VERSION}'
      AgentVersionMajor                    : '{TB'
      AgentNameVersion                     : 'AskTb{TB_NAME} {TB_VERSION}'
      AgentNameVersionMajor                : 'AskTb{TB_NAME} {TB'
      AgentLanguage                        : 'Arabic'
      AgentLanguageCode                    : 'ar'
      AgentSecurity                        : 'Strong security'

# With url encoding ...
- test:
    input:
      user_agent_string: 'Mozilla/5.0%20%28Linux%3B%20Android%206.0.1%3B%20SM-G920F%20Build/MMB29K%29%20AppleWebKit/537.36%20%28KHTML%2C%20like%20Gecko%29%20Chrome/49.0.2623.91%20Mobile%20Safari/537.36 Requester IP: 94.226.145.25'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G920F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '49.0'
      LayoutEngineVersionMajor             : '49'
      LayoutEngineNameVersion              : 'Blink 49.0'
      LayoutEngineNameVersionMajor         : 'Blink 49'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '49.0.2623.91'
      AgentVersionMajor                    : '49'
      AgentNameVersion                     : 'Chrome 49.0.2623.91'
      AgentNameVersionMajor                : 'Chrome 49'


# With broken url encoding ...
- test:
    input:
      user_agent_string: 'Mozilla/5.0(%20 %'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'

  # With broken url encoding ...
- test:
    input:
      user_agent_string: 'Mozilla/5.0(%20 %%'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'

  # With broken url encoding ...
- test:
    input:
      user_agent_string: 'Mozilla/5.0(%20 %ZZ'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'

  # Lots of quotes half way the useragent
- test:
    input:
      user_agent_string: '"""Mozilla/5.0 (Linux; U; Android 4.2.2; en-us; Lenco 7\"""" tablet Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30"""'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Lenco 7\"""" Tablet'
      DeviceBrand                          : 'Lenco'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JDQ39'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: '"Mozilla/5.0 (Linux; U; Android 4.2.2; de-de; PocketBook SURFpad 3 (7,85\"") Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30"'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'PocketBook Surfpad 3 (7,85\"")'
      DeviceBrand                          : 'PocketBook'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JDQ39'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'
      AgentSecurity                        : 'Strong security'

## TODO (Low prio): Json wrapped useragent
#  - test:
#      input:
#        user_agent_string: "{'User-Agent': 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)'}"

#  - test:
#       input:
#         user_agent_string: "{u'User-Agent': u'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'}"

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows 6.3; WOW64; Trident/5.0)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8.1'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Trident 5.0'
      LayoutEngineNameVersionMajor         : 'Trident 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Internet Explorer 9.0'
      AgentNameVersionMajor                : 'Internet Explorer 9'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (illumOS; rv:38.0) Gecko/20100101 Firefox/38.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenSolaris Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'illumOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'illumOS ??'
      OperatingSystemNameVersionMajor      : 'illumOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '38.0'
      LayoutEngineVersionMajor             : '38'
      LayoutEngineNameVersion              : 'Gecko 38.0'
      LayoutEngineNameVersionMajor         : 'Gecko 38'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '38.0'
      AgentVersionMajor                    : '38'
      AgentNameVersion                     : 'Firefox 38.0'
      AgentNameVersionMajor                : 'Firefox 38'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Mac; rv:44.0) Gecko/20100101 Firefox/44.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : 'before 10'
      OperatingSystemVersionMajor          : 'before 10'
      OperatingSystemNameVersion           : 'Mac OS before 10'
      OperatingSystemNameVersionMajor      : 'Mac OS before 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '44.0'
      LayoutEngineVersionMajor             : '44'
      LayoutEngineNameVersion              : 'Gecko 44.0'
      LayoutEngineNameVersionMajor         : 'Gecko 44'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '44.0'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Firefox 44.0'
      AgentNameVersionMajor                : 'Firefox 44'

# Both mac and sunos ... i.e. manually modified.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (MSIE 7.0; Macintosh; U; SunOS; X11; gu; SV1; InfoPath.2; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648) 88XI4n5O'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'SUN Microsystems Desktop'
      DeviceBrand                          : 'SUN Microsystems'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SunOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'SunOS ??'
      OperatingSystemNameVersionMajor      : 'SunOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Internet Explorer 7.0'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Internet Explorer 7.0'
      AgentNameVersionMajor                : 'Internet Explorer 7'
      AgentLanguage                        : 'Gujarati'
      AgentLanguageCode                    : 'gu'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: '(Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      OperatingSystemVersionBuild          : '10240'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'EdgeHTML'
      LayoutEngineVersion                  : '12'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'EdgeHTML 12'
      LayoutEngineNameVersionMajor         : 'EdgeHTML 12'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '20.10240'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'Edge 20.10240'
      AgentNameVersionMajor                : 'Edge 20'

- test:
    input:
      user_agent_string: '(Windows NT 6.1; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '17.0'
      LayoutEngineVersionMajor             : '17'
      LayoutEngineNameVersion              : 'Gecko 17.0'
      LayoutEngineNameVersionMajor         : 'Gecko 17'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '17.0'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Firefox 17.0'
      AgentNameVersionMajor                : 'Firefox 17'


- test: #NOTE: There is a limit to what we are going to parse. This is beyond that limit.
    input:
      user_agent_string: 'device_id={763835ca-1b38-48ef-9693-ad6bef1c60b6}&brand=bebook&model=neo&access=wlan'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Device_ID={763835CA-1B38-48EF-9693-AD6BEF1C60B6}'
      AgentVersion                         : '&brand=bebook&model=neo&access=wlan'
      AgentVersionMajor                    : '&brand=bebook&model=neo&access=wlan'
      AgentNameVersion                     : 'Device_ID={763835CA-1B38-48EF-9693-AD6BEF1C60B6} &brand=bebook&model=neo&access=wlan'
      AgentNameVersionMajor                : 'Device_ID={763835CA-1B38-48EF-9693-AD6BEF1C60B6} &brand=bebook&model=neo&access=wlan'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (LG-T385 AppleWebkit/531 Browser/Phantom/V2.0 Widget/LGMW/3.0 MMS/LG-MMS-V1.0/1.2 Java/ASVM/1.1 Profile/MIDP-2.1 Configuration/CLDC-1.1)'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'LG T385'
      DeviceBrand                          : 'LG'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Phantom'
      AgentVersion                         : 'V2.0'
      AgentVersionMajor                    : 'V2'
      AgentNameVersion                     : 'Phantom V2.0'
      AgentNameVersionMajor                : 'Phantom V2'


- test:
    input:
      user_agent_string: '( ;  ; ; Trident/7.0; rv:11.0) like Gecko'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '11.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Internet Explorer 11.0'
      AgentNameVersionMajor                : 'Internet Explorer 11'

- test:
    input:
      user_agent_string: '(compatible; MSIE 9.0; ; Trident/5.0; BOIE9;NLBE)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Trident 5.0'
      LayoutEngineNameVersionMajor         : 'Trident 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Internet Explorer 9.0'
      AgentNameVersionMajor                : 'Internet Explorer 9'
      AgentLanguage                        : 'Dutch (Belgium)'
      AgentLanguageCode                    : 'nl-be'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 2.1; en-us; Nexus One Build/ERD62) AppleWebKit/530.17 (KHTML, like Gecko) Version/4.0Mobile Safari/530.17'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus ONE'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '2.1'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Android 2.1'
      OperatingSystemNameVersionMajor      : 'Android 2'
      OperatingSystemVersionBuild          : 'ERD62'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '530.17'
      LayoutEngineVersionMajor             : '530'
      LayoutEngineNameVersion              : 'AppleWebKit 530.17'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 530'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


# Disputable if this is a hacker or not; I say it is a hacker.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; xx; ${ro.product.subbrand} ${ro.product.submodel} Build/E0005.00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Safari/537.36'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


- test:
    input:
      user_agent_string: 'mozilla/5.0 (linux; android 6.0.1; sm-g920f build/mmb29k) applewebkit/537.36 (khtml, like gecko) chrome/48.0.2564.95 mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G920F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'mmb29k'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '48.0'
      LayoutEngineVersionMajor             : '48'
      LayoutEngineNameVersion              : 'Blink 48.0'
      LayoutEngineNameVersionMajor         : 'Blink 48'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '48.0.2564.95'
      AgentVersionMajor                    : '48'
      AgentNameVersion                     : 'Chrome 48.0.2564.95'
      AgentNameVersionMajor                : 'Chrome 48'

# Useragent that has a monster length (but happens in production!)
# This one contains "all" flags so the result of this one tends to change occasionally when adding new rules.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1 ;Win64; x64; Trident/6.0;  ; ARM; Touch; WPDesktopSLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3; Tablet PC 2.0SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET CLR 1.1.4322; .NET4.0C; .NET4.0E; MS-RTC LM 8SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E; MS-RTC LM 8; .NET CLR 1.1.4322InfoPath.2; SV1; .NET CLR 2.0.50727; WOW64.NET4.0E; .NET4.0C; .NET CLR 3.5.30729; .NET CLR 2.0.50727; .NET CLR 3.0.30729; MATMJS.NET4.0E; .NET4.0C; Media Center PC 6.0; .NET CLR 3.5.30729; .NET CLR 2.0.50727; .NET CLR 3.0.30729; InfoPath.3SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E; AskTB5.6; EIE10;NLNLWOLSLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; MS-RTC LM 8SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3; .NET4.0E)'
    expected:
      DeviceClass                          : 'Tablet' # Because it explicitly says it is a "Tablet PC"
      DeviceName                           : 'Windows Phone'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows Phone 7'
      OperatingSystemNameVersionMajor      : 'Windows Phone 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Trident 6.0'
      LayoutEngineNameVersionMajor         : 'Trident 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '10.0'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Internet Explorer 10.0'
      AgentNameVersionMajor                : 'Internet Explorer 10'

# This used to trigger an NPE
# The 'spaces' before ltx71 are in reality unicode 0x2002 a.k.a. "EN SPACE"
# See  http://www.unicodemap.org/details/0x2002/index.html
- test:
    input:
      user_agent_string: '"      ltx71 - (http://ltx71.com/)"'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'LTX71 Robot'
      DeviceBrand                          : 'LTX71'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'LTX71'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'LTX71 ??'
      AgentNameVersionMajor                : 'LTX71 ??'
      AgentInformationUrl                  : 'http://ltx71.com/'


# The OWASMIME plugin damages the useragent.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0 OWASMIME/4.0500'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '31.0'
      LayoutEngineVersionMajor             : '31'
      LayoutEngineNameVersion              : 'Gecko 31.0'
      LayoutEngineNameVersionMajor         : 'Gecko 31'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '31.0'
      AgentVersionMajor                    : '31'
      AgentNameVersion                     : 'Firefox 31.0'
      AgentNameVersionMajor                : 'Firefox 31'



# Copied problem case from https://github.com/before/uadetector/issues/132
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Buffer overflow'
      HackerToolkit                        : 'Unknown'

# Shortened variant of https://github.com/before/uadetector/issues/132
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500 OWASMIME/4.0500'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '38.0'
      LayoutEngineVersionMajor             : '38'
      LayoutEngineNameVersion              : 'Gecko 38.0'
      LayoutEngineNameVersionMajor         : 'Gecko 38'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '38.0'
      AgentVersionMajor                    : '38'
      AgentNameVersion                     : 'Firefox 38.0'
      AgentNameVersionMajor                : 'Firefox 38'

# Normal OWASMIME example
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2; .NET4.0C; .NET4.0E; OWASMIME/4.0500)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '11.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Internet Explorer 11.0'
      AgentNameVersionMajor                : 'Internet Explorer 11'
      IECompatibilityVersion               : '7.0'
      IECompatibilityVersionMajor          : '7'
      IECompatibilityNameVersion           : 'Internet Explorer 7.0'
      IECompatibilityNameVersionMajor      : 'Internet Explorer 7'


# Very special case that makes the parser fail (unbalanced braces) and occurs a LOT
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Microsoft Windows NT 6.2.9200.0); rv:22.0) Gecko/20130405 Firefox/22.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Firefox OS'
      OperatingSystemVersion               : '22.0'
      OperatingSystemVersionMajor          : '22'
      OperatingSystemNameVersion           : 'Firefox OS 22.0'
      OperatingSystemNameVersionMajor      : 'Firefox OS 22'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '22.0'
      LayoutEngineVersionMajor             : '22'
      LayoutEngineNameVersion              : 'Gecko 22.0'
      LayoutEngineNameVersionMajor         : 'Gecko 22'
      LayoutEngineBuild                    : '20130405'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '22.0'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Firefox 22.0'
      AgentNameVersionMajor                : 'Firefox 22'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.0.4; nl-nl; %ModelName% Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : '%modelName%' # Looks strange but this is the "correct" value
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'IMM76D'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

# The thinkpad is an Android device ONLY. This useragent is probably modified to look like Windows.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.1 ; pl-pl; ThinkPad Tablet Build/ThinkPadTablet_A310_02) AppleWebKit/534.13 (KHTML, like Gecko) Version/4.0 Safari/534.13'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Lenovo ThinkPad Tablet'
      DeviceBrand                          : 'Lenovo'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      OperatingSystemVersionBuild          : 'ThinkPadTablet_A310_02'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.13'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.13'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Safari 4.0'
      AgentNameVersionMajor                : 'Safari 4'
      AgentLanguage                        : 'Polish (Poland)'
      AgentLanguageCode                    : 'pl-pl'
      AgentSecurity                        : 'Strong security'

# No Gecko version?
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Android; Linux armv7l; rv:9.0) Gecko/ Firefox/9.0 Fennec/9.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '9.0'
      LayoutEngineVersionMajor             : '9'
      LayoutEngineNameVersion              : 'Gecko 9.0'
      LayoutEngineNameVersionMajor         : 'Gecko 9'
      LayoutEngineBuild                    : 'Firefox'
      AgentClass                           : 'Browser'
      AgentName                            : 'Fennec'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Fennec 9.0'
      AgentNameVersionMajor                : 'Fennec 9'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Android; Linux armv7l; rv:2.0b8) Gecko/ Firefox/4.0b8 Fennec/4.0b3'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '2.0b8'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Gecko 2.0b8'
      LayoutEngineNameVersionMajor         : 'Gecko 2'
      LayoutEngineBuild                    : 'Firefox'
      AgentClass                           : 'Browser'
      AgentName                            : 'Fennec'
      AgentVersion                         : '4.0b3'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Fennec 4.0b3'
      AgentNameVersionMajor                : 'Fennec 4'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Android; Linux armv7l; rv:2.1) Gecko/20110318 Firefox/4.0b13pre Fennec/4.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Gecko 2.1'
      LayoutEngineNameVersionMajor         : 'Gecko 2'
      LayoutEngineBuild                    : '20110318'
      AgentClass                           : 'Browser'
      AgentName                            : 'Fennec'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Fennec 4.0'
      AgentNameVersionMajor                : 'Fennec 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Android; Linux armv7l; rv:10.0.3) Gecko/20120302 Firefox/10.0.3 Fennec/10.0.3'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '10.0.3'
      LayoutEngineVersionMajor             : '10'
      LayoutEngineNameVersion              : 'Gecko 10.0.3'
      LayoutEngineNameVersionMajor         : 'Gecko 10'
      LayoutEngineBuild                    : '20120302'
      AgentClass                           : 'Browser'
      AgentName                            : 'Fennec'
      AgentVersion                         : '10.0.3'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Fennec 10.0.3'
      AgentNameVersionMajor                : 'Fennec 10'

# Many rules do not fire because of "Android Android 6.0"
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android Android 6.0) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Focus/4.0.1 Chrome/64.0.3282.123 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '64.0'
      LayoutEngineVersionMajor             : '64'
      LayoutEngineNameVersion              : 'Blink 64.0'
      LayoutEngineNameVersionMajor         : 'Blink 64'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '64.0.3282.123'
      AgentVersionMajor                    : '64'
      AgentNameVersion                     : 'Chrome Webview 64.0.3282.123'
      AgentNameVersionMajor                : 'Chrome Webview 64'
      WebviewAppName                       : 'Firefox Focus'
      WebviewAppVersion                    : '4.0.1'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Firefox Focus 4.0.1'
      WebviewAppNameVersionMajor           : 'Firefox Focus 4'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android Android 6.0) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Focus/4.0.2 Chrome/43.0.2357.121 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '43.0'
      LayoutEngineVersionMajor             : '43'
      LayoutEngineNameVersion              : 'Blink 43.0'
      LayoutEngineNameVersionMajor         : 'Blink 43'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '43.0.2357.121'
      AgentVersionMajor                    : '43'
      AgentNameVersion                     : 'Chrome Webview 43.0.2357.121'
      AgentNameVersionMajor                : 'Chrome Webview 43'
      WebviewAppName                       : 'Firefox Focus'
      WebviewAppVersion                    : '4.0.2'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Firefox Focus 4.0.2'
      WebviewAppNameVersionMajor           : 'Firefox Focus 4'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android Android 6.0; Qualcore 1027 3G Build/LMY47I; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/43.0.2357.121 Safari/537.36 OPR/32.0.2254.123747'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Qualcore 1027 3G'
      DeviceBrand                          : 'Qualcore'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'LMY47I'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '43.0'
      LayoutEngineVersionMajor             : '43'
      LayoutEngineNameVersion              : 'Blink 43.0'
      LayoutEngineNameVersionMajor         : 'Blink 43'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '43.0.2357.121'
      AgentVersionMajor                    : '43'
      AgentNameVersion                     : 'Chrome Webview 43.0.2357.121'
      AgentNameVersionMajor                : 'Chrome Webview 43'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Opera'
      WebviewAppVersion                    : '32.0.2254.123747'
      WebviewAppVersionMajor               : '32'
      WebviewAppNameVersion                : 'Opera 32.0.2254.123747'
      WebviewAppNameVersionMajor           : 'Opera 32'


# Last part seems missing
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET CLR 3.0.04506; Media Center PC 5.0; SLCC1; OfficeLiveConnector.1.5; OfficeLivePatch.1.3; Tablet P'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Trident 6.0'
      LayoutEngineNameVersionMajor         : 'Trident 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '10.0'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Internet Explorer 10.0'
      AgentNameVersionMajor                : 'Internet Explorer 10'

# Android phone running a custom rom called "Zoe ROM"
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android Zoe ROM 7.7 - CM7.2 - SDSL v4; pl-pl; LG-GT540 Build/GWK74; -=Zoe ROM=-) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'LG GT540'
      DeviceBrand                          : 'LG'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.7'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'GWK74'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'Polish (Poland)'
      AgentLanguageCode                    : 'pl-pl'
      AgentSecurity                        : 'Strong security'

# This vendor sends out broken useragents by default: missing ')' just after the "Build/VM".
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android ; VM_Vertis 4010 You Build/VM AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'VM Vertis 4010 YOU'
      DeviceBrand                          : 'VM'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      OperatingSystemVersionBuild          : 'VM'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


# We assume FireFox OS so "Mobile"
- test:
    input:
      user_agent_string: 'Mozilla/5.0 Gecko/20100101 Firefox/16.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Firefox OS'
      OperatingSystemVersion               : '16.0'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'Firefox OS 16.0'
      OperatingSystemNameVersionMajor      : 'Firefox OS 16'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '16.0'
      AgentVersionMajor                    : '16'
      AgentNameVersion                     : 'Firefox 16.0'
      AgentNameVersionMajor                : 'Firefox 16'

- test:
    input:
      user_agent_string: 'ELEMENT10 1 Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.34 Safari/534.24'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Odys ELEMENT10' # Current best guess without breaking everything else
      DeviceBrand                          : 'Odys'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.24'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.24'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '11.0.696.34'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Chrome 11.0.696.34'
      AgentNameVersionMajor                : 'Chrome 11'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; rv:54.0) Gecko/20100101 Firefox/@PKGVER@'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '54.0'
      LayoutEngineVersionMajor             : '54'
      LayoutEngineNameVersion              : 'Gecko 54.0'
      LayoutEngineNameVersionMajor         : 'Gecko 54'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '@PKGVER@'
      AgentVersionMajor                    : '@PKGVER@'
      AgentNameVersion                     : 'Firefox @PKGVER@'
      AgentNameVersionMajor                : 'Firefox @PKGVER@'

# Deliberately modified to ensure having too many spaces still works
- test:
    input:
      user_agent_string: 'Mozilla    /    5.0      (      Linux      ;         Android         7.1.1         ;         Nexus            6         Build       /          N6F27M         )            AppleWebKit / 537.36   (KHTML,   like   Gecko)   Chrome / 66.0.3359.181   YaBrowser / 18.6.0.683.00   Mobile   Safari / 537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser'
      AgentName                            : 'YaBrowser'
      AgentVersion                         : '18.6.0.683.00'
      AgentVersionMajor                    : '18'
      AgentNameVersion                     : 'YaBrowser 18.6.0.683.00'
      AgentNameVersionMajor                : 'YaBrowser 18'


# Manipulated
- test:
    input:
      user_agent_string: 'Mozilla/61748879 (FreeBSD NT 92.6; Win1213; x1510; rv:79.4) Safari/14.9 IZShJuZST 6BVq0FJm9L u89x7bai5NHiU yZ4x9LWDZ1f'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FreeBSD ??'
      OperatingSystemNameVersionMajor      : 'FreeBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '61748879'
      LayoutEngineVersionMajor             : '61748879'
      LayoutEngineNameVersion              : 'Mozilla 61748879'
      LayoutEngineNameVersionMajor         : 'Mozilla 61748879'
      AgentClass                           : 'Browser'
      AgentName                            : 'IZShJuZST'
      AgentVersion                         : '6BVq0FJm9L'
      AgentVersionMajor                    : '6BVq0FJm9L'
      AgentNameVersion                     : 'IZShJuZST 6BVq0FJm9L'
      AgentNameVersionMajor                : 'IZShJuZST 6BVq0FJm9L'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.1; ru; rv:1.9.0.1) Gecko/2008070208'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.0.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.0.1'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '2008070208'
      AgentClass                           : 'Browser'
      AgentName                            : 'Gecko'
      AgentVersion                         : '1.9.0.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Gecko 1.9.0.1'
      AgentNameVersionMajor                : 'Gecko 1'
      AgentLanguage                        : 'Russian'
      AgentLanguageCode                    : 'ru'
      AgentSecurity                        : 'Strong security'




- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '2.2'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Gecko 2.2'
      LayoutEngineNameVersionMajor         : 'Gecko 2'
      LayoutEngineBuild                    : '20110201'
      AgentClass                           : 'Browser'
      AgentName                            : 'Gecko'
      AgentVersion                         : '2.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Gecko 2.2'
      AgentNameVersionMajor                : 'Gecko 2'
      AgentSecurity                        : 'Strong security'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '537.36'
      AgentVersionMajor                    : '537'
      AgentNameVersion                     : 'AppleWebKit 537.36'
      AgentNameVersionMajor                : 'AppleWebKit 537'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.78.2 (KHTML, like Gecko)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.9.5'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.9.5'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.78.2'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.78.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '537.78.2'
      AgentVersionMajor                    : '537'
      AgentNameVersion                     : 'AppleWebKit 537.78.2'
      AgentNameVersionMajor                : 'AppleWebKit 537'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X) AppleWebKit (KHTML, like Gecko)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.?'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.?'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 Chrome/68.0.3440.106 Safari/537.36'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '68.0'
      LayoutEngineVersionMajor             : '68'
      LayoutEngineNameVersion              : 'Blink 68.0'
      LayoutEngineNameVersionMajor         : 'Blink 68'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '68.0.3440.106'
      AgentVersionMajor                    : '68'
      AgentNameVersion                     : 'Chrome 68.0.3440.106'
      AgentNameVersionMajor                : 'Chrome 68'

- test: # The ${USR_AGNT} part triggers the 'hacker' classification. Is this really a hacker? I think it is.
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/5.0; SLCC1; ${USR_AGNT}; .NET CLR 3.5.30729; .NET4.0C; BRI/2; McAfee)'
    expected:
      DeviceClass                          : 'Hacker'      # Should be 'Desktop' ?
      DeviceName                           : 'Hacker'      # Should be 'Desktop' ?
      DeviceBrand                          : 'Hacker'      # Should be 'Unknown' ?
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'      # Should be 'Desktop' ?
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'      # Should be 'Windows Vista' ?
      LayoutEngineClass                    : 'Hacker'      # Should be 'Browser' ?
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'      # Should be 'Trident 5.0' ?
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'      # Should be 'Browser' ?
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'      # Should be 'Internet Explorer 9.0' ?
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


# Broken in 2 ways:
# - "MSIE8.0" is missing a space in between.
# - A ')' too many.
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE8.0; Windows NT 6.0) .NET CLR 2.0.50727)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Vista'
      OperatingSystemVersionMajor          : 'Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      OperatingSystemNameVersionMajor      : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Internet Explorer 8.0'
      AgentNameVersionMajor                : 'Internet Explorer 8'


- test:
    input:
      user_agent_string: 'Mozilla/5.0'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 ()'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible;)'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Mozilla 4.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Netscape 4.0'
      AgentNameVersionMajor                : 'Netscape 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible)'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'


# https://github.com/nielsbasjes/yauaa/issues/176
# Parse error due to value that looks like a BASE64
- test:
    input:
      user_agent_string: 'Android/9/G960FXXU5CSF2/28/samsung/samsung/SM-G960F/starlte (mNetwork/1.13.0)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G960F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'AppleWebKit ??'
      LayoutEngineNameVersionMajor         : 'AppleWebKit ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '9'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Stock Android Browser 9'
      AgentNameVersionMajor                : 'Stock Android Browser 9'

- test:
    input:
      user_agent_string: 'Android/9.0/G960FXXU5CSF2/28/samsung/samsung/SM-G960F/starlte (mNetwork/1.13.0)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G960F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9.0'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9.0'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'AppleWebKit ??'
      LayoutEngineNameVersionMajor         : 'AppleWebKit ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Stock Android Browser 9.0'
      AgentNameVersionMajor                : 'Stock Android Browser 9'

- test: # Windows? Solaris?
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0; Solaris 9)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Solaris 9'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Solaris'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Solaris 9'
      OperatingSystemNameVersionMajor      : 'Solaris 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Trident 6.0'
      LayoutEngineNameVersionMajor         : 'Trident 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '10.0'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Internet Explorer 10.0'
      AgentNameVersionMajor                : 'Internet Explorer 10'


- test:
    input:
      user_agent_string: 'Mozilla%2F5.0+%28Windows+NT+6.1%29+AppleWebKit%2F537.36+%28KHTML%2C+like+Gecko%29+Chrome%2F79.0.3945.130+Safari%2F537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '79.0'
      LayoutEngineVersionMajor             : '79'
      LayoutEngineNameVersion              : 'Blink 79.0'
      LayoutEngineNameVersionMajor         : 'Blink 79'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '79.0.3945.130'
      AgentVersionMajor                    : '79'
      AgentNameVersion                     : 'Chrome 79.0.3945.130'
      AgentNameVersionMajor                : 'Chrome 79'

# No ; to separate the entries in the comment block
- test: # Somewhat messy result yet the best we can do.
    input:
      user_agent_string: 'Mozilla/5.0 (Linux U Android 4.4.4 en-US XT1022 Build/KXC21.5-40) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 UCBrowser/10.7.0.636 U3/0.8.0 Mobile Safari/534.30'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Linux U Android 4.4.4'
      DeviceBrand                          : 'Linux'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      OperatingSystemVersionBuild          : 'KXC21.5-40'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U3'
      LayoutEngineVersion                  : '0.8.0'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'UCBrowser U3 0.8.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U3 0'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '10.7.0.636'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'UCBrowser 10.7.0.636'
      AgentNameVersionMajor                : 'UCBrowser 10'

# Apparently the "Mobile/" flag is an indication it is a mobile device and not a desktop.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.2 Mobile/15E148 Safari/604.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.15.6'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.15.6'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '14.0.2'
      AgentVersionMajor                    : '14'
      AgentNameVersion                     : 'Safari 14.0.2'
      AgentNameVersionMajor                : 'Safari 14'

# Clearly manipulated
- test:
    input:
      user_agent_string: 'Mozilla/1.0 (Windows NT 4.0, Windows NT 5.0, Windows NT 5.1, Windows NT 6.0, Windows NT 6.1, Windows NT 6.2, Windows NT 10.0) AppleWebKit (KHTML, like Gecko) Safari/1 Chrome/1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '4.0'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Windows NT 4.0'
      OperatingSystemNameVersionMajor      : 'Windows NT 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Mozilla 1.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Chrome 1'
      AgentNameVersionMajor                : 'Chrome 1'

