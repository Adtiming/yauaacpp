#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# These are examples of robot/spider/bot useragents that imitate a different robot we have seen.

config:

- matcher:
    require:
    - 'agent.text="Googlebot"'
    extract:
    - 'DeviceClass                         :   320100 : "Robot Imitator"'
    - 'DeviceName                          :   320100 : "Googlebot Imitator"'
    - 'OperatingSystemClass                :   320100 : "Cloud"'
    - 'OperatingSystemName                 :   320100 : "Cloud"'
    - 'OperatingSystemVersion              :   320100 : "<<<null>>>"'
    - 'LayoutEngineName                    :   320100 : "Googlebot Imitator"'
    - 'AgentName                           :   320100 : "Googlebot Imitator"'

- matcher:
    require:
    - 'agent.(1-10)product.(1-2)comments.(1-8)entry.(1-4)product.name="Googlebot"'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="http://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="https://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url~"googlebot.com"]'
    extract:
    - 'DeviceClass                         :   320100 : "Robot Imitator"'
    - 'DeviceName                          :   320100 : "Googlebot Imitator"'
    - 'OperatingSystemClass                :   320100 : "Cloud"'
    - 'OperatingSystemName                 :   320100 : "Cloud"'
    - 'OperatingSystemVersion              :   320100 : "<<<null>>>"'
    - 'LayoutEngineName                    :   320100 : "Googlebot Imitator"'
    - 'AgentName                           :   320100 : "Googlebot Imitator"'


- matcher:
    require:
    - 'IsNull[agent.(1)product.version.url]'
    - 'agent.(1-10)product.(1-2)comments.(1-8)entry.(1-4)product.name="Googlebot"'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="http://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="https://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url~"googlebot.com"]'
    variable:
    - 'RealAgent                           :agent.(1)product.name!="Mozilla"'
    extract:
    - 'AgentName                           :   320200 : @RealAgent'
    - 'AgentVersion                        :   320200 : @RealAgent^.version'

- matcher:
    require:
    - 'agent.(1)product.version.url'
    - 'agent.(1-10)product.(1-2)comments.(1-8)entry.(1-4)product.name="Googlebot"'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="http://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="https://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url~"googlebot.com"]'
    variable:
    - 'RealAgent                           :agent.(1)product.name!="Mozilla"'
    extract:
    - 'AgentName                           :   320200 : @RealAgent'
    - 'AgentVersion                        :   320200 : "<<<null>>>"'


- matcher:
    variable:
    - 'RealAgent                           :agent.(1)product.comments.entry.product.name!="GoogleBot"'
    - 'RealAgentVersion                    :@RealAgent^.version'
    require:
    - 'IsNull[@RealAgentVersion.url]'
    - 'agent.(1-10)product.(1-2)comments.(1-8)entry.(1-4)product.name="Googlebot"'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="http://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="https://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url~"googlebot.com"]'
    extract:
    - 'AgentName                           :   320200 : @RealAgent'
    - 'AgentVersion                        :   320200 : @RealAgentVersion'

- matcher:
    variable:
    - 'RealAgent                           :agent.(1)product.comments.entry.product.name!="GoogleBot"'
    - 'RealAgentVersion                    :@RealAgent^.version'
    require:
    - '@RealAgentVersion.url'
    - 'agent.(1-10)product.(1-2)comments.(1-8)entry.(1-4)product.name="Googlebot"'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="http://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="https://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url~"googlebot.com"]'
    extract:
    - 'AgentName                           :   320200 : @RealAgent'
    - 'AgentVersion                        :   320200 : "<<<null>>>"'


- matcher:
    require:
    - 'agent.product.name="Googlebot"'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="http://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="https://www.google.com/bot.html"]'
    extract:
    - 'DeviceClass                         :   320100 : "Robot Imitator"'
    - 'DeviceName                          :   320100 : "Googlebot Imitator"'
    - 'OperatingSystemClass                :   320100 : "Cloud"'
    - 'OperatingSystemName                 :   320100 : "Cloud"'
    - 'OperatingSystemVersion              :   320100 : "<<<null>>>"'
    - 'LayoutEngineName                    :   320100 : "Googlebot Imitator"'
    - 'AgentName                           :   320100 : "Googlebot Imitator"'

- matcher:
    require:
    - 'agent.product.name="Googlebot"'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="http://www.google.com/bot.html"]'
    - 'IsNull[agent.(1-10)product.(1-2)comments.(1-8)entry.(1-2)url="https://www.google.com/bot.html"]'
    extract:
    - 'DeviceClass                         :   320100 : "Robot Imitator"'
    - 'DeviceName                          :   320100 : "Googlebot Imitator"'
    - 'OperatingSystemClass                :   320100 : "Cloud"'
    - 'OperatingSystemName                 :   320100 : "Cloud"'
    - 'OperatingSystemVersion              :   320100 : "<<<null>>>"'
    - 'LayoutEngineName                    :   320100 : "Googlebot Imitator"'
    - 'AgentName                           :   320300 : agent.text'
    - 'AgentVersion                        :   320300 : "<<<null>>>"'


- matcher:
    require:
    # Although this is a domain related to the GoogleBot, this is NOT used by Google this way.
    - 'agent.product.comments.entry.url~"googlebot.com"'
    extract:
    - 'DeviceClass                         :   320100 : "Robot Imitator"'
    - 'DeviceName                          :   320100 : "Googlebot Imitator"'
    - 'DeviceBrand                         :   320100 : "Unknown"'
    - 'OperatingSystemClass                :   320100 : "Cloud"'
    - 'OperatingSystemName                 :   320100 : "Cloud"'
    - 'OperatingSystemVersion              :   320100 : "<<<null>>>"'
    - 'LayoutEngineName                    :   320100 : "Googlebot Imitator"'
    - 'AgentName                           :   320100 : "Googlebot Imitator"'


# Robots imitating googlebot
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1 +http://www.googlebot.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'http://www.googlebot.com/bot.html'


- test:
    input:
      user_agent_string: 'Googlebot/2.1 (+http://www.googlebot.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot Imitator Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'http://www.googlebot.com/bot.html'


# Googlebots that are NOT from Google ...
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://import.io)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Import Googlebot Imitator'
      DeviceBrand                          : 'Import'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'http://import.io'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; https://deepcrawl.com/bot)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Deepcrawl Googlebot Imitator'
      DeviceBrand                          : 'Deepcrawl'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'https://deepcrawl.com/bot'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1;)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'


- test:
    input:
      user_agent_string: 'Googlebot'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Googlebot Imitator ??'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Googlebot Imitator ??'
      AgentNameVersionMajor                : 'Googlebot Imitator ??'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; startmebot/1.0; +https://start.me/bot)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Start Googlebot Imitator'
      DeviceBrand                          : 'Start'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Startmebot'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Startmebot 1.0'
      AgentNameVersionMajor                : 'Startmebot 1'
      AgentInformationUrl                  : 'https://start.me/bot'

- test:
    input:
      user_agent_string: 'OnPageBot (compatible; Googlebot 2.1; +https://bot.onpage.org/)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Onpage Googlebot Imitator'
      DeviceBrand                          : 'Onpage'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'https://bot.onpage.org/'

- test:
    input:
      user_agent_string: 'ArchiveTeam; Googlebot/2.1'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'ArchiveTeam'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'ArchiveTeam ??'
      AgentNameVersionMajor                : 'ArchiveTeam ??'

- test:
    input:
      user_agent_string: 'secssobrowser (compatible; Googlebot/2.1; +https://sts.secsso.net)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Secsso Googlebot Imitator'
      DeviceBrand                          : 'Secsso'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'https://sts.secsso.net'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://localhost)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'http://localhost'

- test:
    input:
      user_agent_string: 'BuckyOHare/1.3 (Googlebot/2.1; +https://hypefactors.com/webcrawler)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Hypefactors Googlebot Imitator'
      DeviceBrand                          : 'Hypefactors'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'BuckyOHare'
      AgentVersion                         : '1.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BuckyOHare 1.3'
      AgentNameVersionMajor                : 'BuckyOHare 1'
      AgentInformationUrl                  : 'https://hypefactors.com/webcrawler'

- test:
    input:
      user_agent_string: 'Happening.im (Client) Googlebot/2.1'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Happening Googlebot Imitator'
      DeviceBrand                          : 'Happening'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'Happening.im'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; +https://whatis.contentkingapp.com/)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Contentkingapp Googlebot Imitator'
      DeviceBrand                          : 'Contentkingapp'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'https://whatis.contentkingapp.com/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; +https://www.contentkingapp.com/)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Contentkingapp Googlebot Imitator'
      DeviceBrand                          : 'Contentkingapp'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'https://www.contentkingapp.com/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; BeforeYouClick/1.0; +https://beforeyouclick.info/bot)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Beforeyouclick Googlebot Imitator'
      DeviceBrand                          : 'Beforeyouclick'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'BeforeYouClick'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BeforeYouClick 1.0'
      AgentNameVersionMajor                : 'BeforeYouClick 1'
      AgentInformationUrl                  : 'https://beforeyouclick.info/bot'


- test:
    input:
      user_agent_string: 'Ryderspider/1.0 (Googlebot/2.1)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Googlebot Imitator'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Ryderspider'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Ryderspider 1.0'
      AgentNameVersionMajor                : 'Ryderspider 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; https://www.deepcrawl.com/bot)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Deepcrawl Googlebot Imitator'
      DeviceBrand                          : 'Deepcrawl'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'https://www.deepcrawl.com/bot'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/1.0; +http://www.migliorsitoweb.it)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Migliorsitoweb Googlebot Imitator'
      DeviceBrand                          : 'Migliorsitoweb'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Googlebot Imitator 1.0'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Googlebot Imitator 1.0'
      AgentNameVersionMajor                : 'Googlebot Imitator 1'
      AgentInformationUrl                  : 'http://www.migliorsitoweb.it'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; actually this is http://ismyblogworking.com/)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Ismyblogworking Googlebot Imitator'
      DeviceBrand                          : 'Ismyblogworking'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Actually This IS'                                #  Really silly, but can't do better
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Actually This IS ??'
      AgentNameVersionMajor                : 'Actually This IS ??'
      AgentInformationUrl                  : 'http://ismyblogworking.com/'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; http://deepcrawl.co.uk/bot.html)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Deepcrawl Googlebot Imitator'
      DeviceBrand                          : 'Deepcrawl'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot Imitator'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Googlebot Imitator 2.1'
      LayoutEngineNameVersionMajor         : 'Googlebot Imitator 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot Imitator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot Imitator 2.1'
      AgentNameVersionMajor                : 'Googlebot Imitator 2'
      AgentInformationUrl                  : 'http://deepcrawl.co.uk/bot.html'

#- test: #TODO: Implement
#    input:
#      user_agent_string: 'Googlebot/Nutch-1.7'
#    expected:
#      DeviceClass                          : 'Robot Imitator'
#      DeviceName                           : 'Googlebot Imitator'
#      DeviceBrand                          : 'Apache'
#      OperatingSystemClass                 : 'Cloud'
#      OperatingSystemName                  : 'Cloud'
#      OperatingSystemVersion               : '??'
#      OperatingSystemNameVersion           : 'Cloud ??'
#      OperatingSystemNameVersionMajor      : 'Cloud ??'
#      LayoutEngineClass                    : 'Robot'
#      LayoutEngineName                     : 'Googlebot Imitator'
#      LayoutEngineVersion                  : 'Googlebot'
#      LayoutEngineVersionMajor             : 'Googlebot'
#      LayoutEngineNameVersion              : 'Googlebot Imitator Googlebot'
#      LayoutEngineNameVersionMajor         : 'Googlebot Imitator Googlebot'
#      AgentClass                           : 'Robot'
#      AgentName                            : 'Googlebot Imitator'
#      AgentVersion                         : 'Nutch-1.7'
#      AgentVersionMajor                    : 'Nutch'
#      AgentNameVersion                     : 'Googlebot Imitator Nutch-1.7'
#      AgentNameVersionMajor                : 'Googlebot Imitator Nutch'


#- matcher:
#    require:
#      - '__SyntaxError__="true"'
#      - 'agent.product.name="GoogleBot"'
#    extract:
#      - 'DeviceBrand          : 100 : "Googlebot Imitator"'
#      - 'LayoutEngineName     : 100 : "Googlebot Imitator"'
#      - 'AgentName            : 100 : "Googlebot Imitator"'
#
#
#- test: # FIXME: This is really an imitator because of the missing ')' at the end.
#    options:
#      - 'only'
#    input:
#      user_agent_string: 'Googlebot/2.1 (+http://www.google.com/bot.html'
#    expected:
#      DeviceClass                           : 'Robot'
#      DeviceName                            : 'Google Imitator GoogleBOT'
#      DeviceBrand                           : 'Google Imitator'
#      OperatingSystemClass                  : 'Cloud'
#      OperatingSystemName                   : 'Google'
#      OperatingSystemVersion                : 'Google'
#      OperatingSystemVersionMajor           : 'Google'
#      OperatingSystemNameVersion            : 'Google'
#      OperatingSystemNameVersionMajor       : 'Google'
#      LayoutEngineClass                     : 'Robot'
#      LayoutEngineName                      : 'Googlebot'
#      LayoutEngineVersion                   : 'Googlebot'
#      LayoutEngineVersionMajor              : 'Googlebot'
#      LayoutEngineNameVersion               : 'Googlebot'
#      LayoutEngineNameVersionMajor          : 'Googlebot'
#      AgentClass                            : 'Robot'
#      AgentName                             : 'Googlebot Imitator'
#      AgentVersion                          : '2.1'
#      AgentVersionMajor                     : '2'
#      AgentNameVersion                      : 'Googlebot Imitator 2.1'
#      AgentNameVersionMajor                 : 'Googlebot Imitator 2'
#      AgentInformationUrl                   : 'http://www.google.com/bot.html'
#


#- test: # FIXME: This is really an imitator because of the missing spaces.
#    input:
#      user_agent_string: 'Mozilla/5.0(compatible;Googlebot/2.1; +http://www.google.com/bot.html)'

#- test: #TODO: Implement
#    input:
#      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; compatible; Googlebot/2.0; +http://www.google.com/bot.html)'

#- test: #TODO: Implement
#    input:
#      user_agent_string: 'Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; Googlebot/2.1; +http://www.google.com/bot.html) Chrome/75.0.3761.0 Safari/537.36'

#- test: #TODO: Implement
#    input:
#      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html) https://deepcrawl.com/bot'


- matcher:
    variable:
    - 'NonGoogleBotURL: agent.product.comments.entry.url!="http://www.google.com/bot.html"'
    require:
    - 'agent.product.comments.entry.url="http://www.google.com/bot.html"'
    extract:
    - 'DeviceClass                         :   380101 : "Robot Imitator"'
    - 'DeviceBrand                         :   380101 : "<<<null>>>"'
    - 'DeviceName                          :   380101 : "<<<null>>>"'
    - 'OperatingSystemClass                :   380101 : "Cloud"'
    - 'OperatingSystemName                 :   380101 : "Cloud"'
    - 'OperatingSystemVersion              :   380101 : "<<<null>>>"'
    - 'LayoutEngineName                    :   380101 : "<<<null>>>"'
    - 'LayoutEngineVersion                 :   380101 : "<<<null>>>"'
    - 'AgentName                           :   380101 : "<<<null>>>"'
    - 'AgentVersion                        :   380101 : "<<<null>>>"'
    - 'AgentInformationUrl                 :  1504700 : @NonGoogleBotURL'

- test:
    input:
      user_agent_string: 'Googlebot v2.1 (+http://www.google.com/bot.html) (http://www.openwebspider.org/)'
    expected:
      DeviceClass                          : 'Robot Imitator'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Openwebspider'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Openwebspider'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Openwebspider ??'
      AgentNameVersionMajor                : 'Openwebspider ??'
      AgentInformationUrl                  : 'http://www.openwebspider.org/'

