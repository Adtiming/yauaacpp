#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

- matcher:
    require:
    - 'agent.product.comments.entry[1]="Smartphone"'
    extract:
    - 'DeviceClass                         :       10 :"Phone"'

- matcher:
    require:
    - 'agent.product.name="Profile"'
    - 'agent.product.name="Configuration"'
    extract:
    - 'DeviceClass                         :      300 :"Mobile"'
    - 'DeviceName                          :      300 :agent.(1)product.name'
    - 'DeviceVersion                       :      300 :agent.(1)product.version'
    - 'AgentClass                          :        4 :"<<<null>>>"'
    - 'AgentName                           :        4 :"<<<null>>>"'
    - 'AgentVersion                        :        4 :"<<<null>>>"'

- matcher:
    extract:
    - 'DeviceClass                         :      302 :"Mobile"'
    - 'DeviceName                          :      402 :agent.(1)product.name[2]="Linux"@[-1]'
    - 'DeviceFirmwareVersion               :      402 :agent.product.name="Release"^.version'
    - 'AgentClass                          :        4 :"<<<null>>>"'
    - 'AgentName                           :        4 :"<<<null>>>"'
    - 'AgentVersion                        :        4 :"<<<null>>>"'

- matcher:
    extract:
    - 'DeviceClass                         :      302 :"Mobile"'
    - 'DeviceName                          :      402 :agent.(1)product.name[3]="Linux"@[-2]'
    - 'DeviceFirmwareVersion               :      402 :agent.product.name="Release"^.version'
    - 'AgentClass                          :        4 :"<<<null>>>"'
    - 'AgentName                           :        4 :"<<<null>>>"'
    - 'AgentVersion                        :        4 :"<<<null>>>"'

- matcher:
    extract:
    - 'DeviceClass                         :      302 :"Mobile"'
    - 'DeviceName                          :      402 :agent.(1)product.name[4]="Linux"@[-3]'
    - 'DeviceFirmwareVersion               :      402 :agent.product.name="Release"^.version'
    - 'AgentClass                          :        4 :"<<<null>>>"'
    - 'AgentName                           :        4 :"<<<null>>>"'
    - 'AgentVersion                        :        4 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.product.name="Browser"'
    extract:
    - 'DeviceClass                         :      301 :"Mobile"'
    - 'DeviceName                          :      300 :agent.(1)product.name'
    - 'DeviceVersion                       :      300 :agent.(1)product.(1)version'
    - 'AgentClass                          :        4 :"<<<null>>>"'
    - 'AgentName                           :        4 :"<<<null>>>"'
    - 'AgentVersion                        :        4 :"<<<null>>>"'

- matcher:
    extract:
    - 'DeviceClass                         :      301 :"Mobile"'
    - 'DeviceName                          :      301 :agent.(1)product.name'
    - 'DeviceVersion                       :      301 :agent.(1)product.(1)version'
    - 'DeviceFirmwareVersion               :      301 :agent.product.name="Release"^.version'
    - 'AgentClass                          :        4 :"<<<null>>>"'
    - 'AgentName                           :        4 :"<<<null>>>"'
    - 'AgentVersion                        :        4 :"<<<null>>>"'

- matcher:
    extract:
    - 'DeviceClass                         :      302 :"Mobile"'
    - 'DeviceName                          :      302 :agent.(1)product[-2]'
    - 'DeviceVersion                       :      302 :agent.(1)product.(2)version'
    - 'DeviceFirmwareVersion               :      302 :agent.product.name="Release"^.version'

- matcher:
    variable:
    - 'BrowserVersion                      :agent.product.name="Browser"^.version'
    require:
    - 'agent.product.(1)version{"AppleWebKit"'
    - '@BrowserVersion{"AppleWebKit"'
    extract:
    - 'LayoutEngineClass                   :        1 :"Browser"'
    - 'LayoutEngineName                    :        1 :"AppleWebKit"'
    - 'LayoutEngineVersion                 :        1 :@BrowserVersion'

- test:
    input:
      user_agent_string: 'MT6572/V1 Linux/3.4.5 Android/4.2.2 Release/04.23.2014 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.2.2;'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'MT6572'
      DeviceBrand                          : 'Unknown'
      DeviceFirmwareVersion                : '04.23.2014'
      DeviceVersion                        : 'V1'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : 'AppleWebKit534.30'
      LayoutEngineVersionMajor             : 'AppleWebKit534'
      LayoutEngineNameVersion              : 'AppleWebKit534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.2.2'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.2.2'
      AgentNameVersionMajor                : 'Stock Android Browser 4'

- test:
    input:
      user_agent_string: 'Lenovo A800 Linux/3.0.13 Android/4.1.2 Release/09.25.2012 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.0.1;'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Lenovo A800'
      DeviceBrand                          : 'Lenovo'
      DeviceFirmwareVersion                : '09.25.2012'
      DeviceVersion                        : 'A800'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.1.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.1.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : 'AppleWebKit534.30'
      LayoutEngineVersionMajor             : 'AppleWebKit534'
      LayoutEngineNameVersion              : 'AppleWebKit534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.1.2'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.1.2'
      AgentNameVersionMajor                : 'Stock Android Browser 4'

- test:
    input:
      user_agent_string: 'Coolpad 8717/V1 Linux/3.10.65 Android/4.4.4 Release/03.03.2015 Browser/AppleWebKit537.36 Chrome/33.0.0.0 Mobile Safari/537.36 System/Android 4.4.4;'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Coolpad 8717'
      DeviceBrand                          : 'Coolpad'
      DeviceFirmwareVersion                : '03.03.2015'
      DeviceVersion                        : 'V1'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '33.0.0.0'
      AgentVersionMajor                    : '33'
      AgentNameVersion                     : 'Chrome 33.0.0.0'
      AgentNameVersionMajor                : 'Chrome 33'

- test:
    input:
      user_agent_string: 'AT-AS40SE Linux/3.0.13 Android/4.0.4 Release/04.10.2013 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.0.1;'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Wolfgang Mobile AT-AS40SE'
      DeviceBrand                          : 'Wolfgang Mobile'
      DeviceFirmwareVersion                : '04.10.2013'
      DeviceVersion                        : '3.0.13'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : 'AppleWebKit534.30'
      LayoutEngineVersionMajor             : 'AppleWebKit534'
      LayoutEngineNameVersion              : 'AppleWebKit534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0.4'
      AgentNameVersionMajor                : 'Stock Android Browser 4'

- matcher:
    extract:
    - 'AgentClass                          :     3000 :"Browser"'
    - 'AgentName                           :     3000 :"Dolfin"'
    - 'AgentVersion                        :     3000 :agent.product.name="Dolfin"^.version'

- test:
    input:
      user_agent_string: 'SAMSUNG-GT-S5260/S5260XXKD1 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung GT-S5260'
      DeviceBrand                          : 'Samsung'
      DeviceVersion                        : 'S5260XXKD1'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Browser'
      AgentName                            : 'Dolfin'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Dolfin 2.0'
      AgentNameVersionMajor                : 'Dolfin 2'

- matcher:
    extract:
    - 'AgentClass                          :      100 :"Testclient"'
    - 'AgentName                           :      100 :"Jasmine"'
    - 'AgentVersion                        :      100 :agent.product.name="Jasmine"^.version'

- test:
    input:
      user_agent_string: 'SAMSUNG-S8000/S800MCEIK1 SHP/VPP/R5 Jasmine/1.0 Nextreaming SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 SS-Widget/S8000-FM'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung S8000'
      DeviceBrand                          : 'Samsung'
      DeviceVersion                        : 'S800MCEIK1'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Testclient'
      AgentName                            : 'Jasmine'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Jasmine 1.0'
      AgentNameVersionMajor                : 'Jasmine 1'

- test:
    input:
      user_agent_string: 'NokiaC3-00/5.0 (08.71) Profile/MIDP-2.1 Configuration/CLDC-1.1 UCWEB/2.0 (Java; U; MIDP-2.0; en-US; NokiaC3-00) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia C3-00'
      DeviceBrand                          : 'Nokia'
      DeviceVersion                        : '5.0'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U2'
      LayoutEngineVersion                  : '1.0.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'UCBrowser U2 1.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U2 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '9.5.0.449'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'UCBrowser 9.5.0.449'
      AgentNameVersionMajor                : 'UCBrowser 9'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'

- test:
    input:
      user_agent_string: 'BlackBerry9300/5.0.0.716 Profile/MIDP-2.1 Configuration/CLDC-1.1 VendorID/603'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'BlackBerry 9300'
      DeviceBrand                          : 'BlackBerry'
      DeviceVersion                        : '5.0.0.716'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'BlackBerry9300'
      AgentVersion                         : '5.0.0.716'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'BlackBerry9300 5.0.0.716'
      AgentNameVersionMajor                : 'BlackBerry9300 5'

- test:
    input:
      user_agent_string: 'AT-AS45SE Linux/3.0.13 Android/4.0.4 Release/09.28.2012 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.0.1;'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Wolfgang Mobile AT-AS45SE'
      DeviceBrand                          : 'Wolfgang Mobile'
      DeviceFirmwareVersion                : '09.28.2012'
      DeviceVersion                        : '3.0.13'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : 'AppleWebKit534.30'
      LayoutEngineVersionMajor             : 'AppleWebKit534'
      LayoutEngineNameVersion              : 'AppleWebKit534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0.4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0.4'
      AgentNameVersionMajor                : 'Stock Android Browser 4'

- test:
    input:
      user_agent_string: 'Athens15_TD/V2 Linux/3.0.13 Android/4.0 Release/02.15.2012 Browser/AppleWebKit534.30 Mobile Safari/534.30 MBBMS/2.2 System/Android 4.0.1;'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'ATHENS15_TD'
      DeviceBrand                          : 'Unknown'
      DeviceFirmwareVersion                : '02.15.2012'
      DeviceVersion                        : 'V2'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : 'AppleWebKit534.30'
      LayoutEngineVersionMajor             : 'AppleWebKit534'
      LayoutEngineNameVersion              : 'AppleWebKit534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'


# http://www.ucweb.com/download/UCBrowser_User_Agent_en.pdf


- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      430 :agent.(1)product.(1)comments.(7)entry.(1)product.name'
    - 'DeviceVersion                       :      430 :agent.(1)product.(1)comments.(7)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      429 :agent.(1)product.(1)comments.(7)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      428 :agent.(1)product.(1)comments.(6)entry.(1)product.name'
    - 'DeviceVersion                       :      428 :agent.(1)product.(1)comments.(6)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      427 :agent.(1)product.(1)comments.(6)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      426 :agent.(1)product.(1)comments.(5)entry.(1)product.name'
    - 'DeviceVersion                       :      426 :agent.(1)product.(1)comments.(5)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      425 :agent.(1)product.(1)comments.(5)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      424 :agent.(1)product.(1)comments.(4)entry.(1)product.name'
    - 'DeviceVersion                       :      424 :agent.(1)product.(1)comments.(4)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      423 :agent.(1)product.(1)comments.(4)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      421 :agent.(1)product.(1)comments.(3)entry.(1)product.name'
    - 'DeviceVersion                       :      422 :agent.(1)product.(1)comments.(3)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      421 :agent.(1)product.(1)comments.(3)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      420 :agent.(1)product.(1)comments.(7)entry.(1)product.name'
    - 'DeviceVersion                       :      420 :agent.(1)product.(1)comments.(7)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      429 :agent.(1)product.(1)comments.(7)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      428 :agent.(1)product.(1)comments.(6)entry.(1)product.name'
    - 'DeviceVersion                       :      428 :agent.(1)product.(1)comments.(6)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      427 :agent.(1)product.(1)comments.(6)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      426 :agent.(1)product.(1)comments.(5)entry.(1)product.name'
    - 'DeviceVersion                       :      426 :agent.(1)product.(1)comments.(5)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      425 :agent.(1)product.(1)comments.(5)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      424 :agent.(1)product.(1)comments.(4)entry.(1)product.name'
    - 'DeviceVersion                       :      424 :agent.(1)product.(1)comments.(4)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      423 :agent.(1)product.(1)comments.(4)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      422 :agent.(1)product.(1)comments.(3)entry.(1)product.name'
    - 'DeviceVersion                       :      422 :agent.(1)product.(1)comments.(3)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="UCWEB"'
    extract:
    - 'DeviceName                          :      421 :agent.(1)product.(1)comments.(3)entry.(1-2)text'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :       10 :"<<<null>>>"'


- matcher:
    require:
    - 'agent.product.name="UCBrowser"'
    extract:
    - 'DeviceClass                         :       30 :"Tablet"'

- matcher:
    require:
    - 'agent.product.name="UCBrowser"'
    - 'agent.product.name[1]="Mobile"'
    extract:
    - 'DeviceClass                         :      332 :"Phone"'

- matcher:
    require:
    - 'agent.product.name="UCBrowser"'
    - 'agent.text="Mobile"'
    extract:
    - 'DeviceClass                         :      332 :"Phone"'

- matcher:
    require:
    - 'agent.product.name="UCWEB"'
    extract:
    - 'DeviceClass                         :      330 :"Tablet"'

- matcher:
    require:
    - 'agent.product.name="UCWEB"'
    - 'agent.text="Mobile"'
    extract:
    - 'DeviceClass                         :      332 :"Phone"'

- matcher:
    require:
    - 'agent.product.name="UCWEB"'
    - 'agent.product.name[1]="Mobile"'
    extract:
    - 'DeviceClass                         :      332 :"Phone"'



- matcher:
    variable:
    - 'Version                             :agent.product.name="UCBrowser"^.version'
    extract:
    - 'LayoutEngineClass                   :      131 :"Browser"'
    - 'LayoutEngineName                    :      131 :"UCBrowser"'
    - 'LayoutEngineVersion                 :      131 :@Version'
    - 'AgentClass                          :      131 :"Browser"'
    - 'AgentName                           :      131 :"UCBrowser"'
    - 'AgentVersion                        :      131 :@Version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :      132 :"Browser"'
    - 'LayoutEngineName                    :      132 :"UCBrowser U2"'
    - 'LayoutEngineVersion                 :      132 :agent.product.name="U2"^.version'
    - 'AgentClass                          :      131 :"Browser"'
    - 'AgentName                           :      131 :"UCBrowser"'
    - 'AgentVersion                        :      131 :agent.product.name="UCBrowser"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :      133 :"Browser"'
    - 'LayoutEngineName                    :      133 :"UCBrowser U3"'
    - 'LayoutEngineVersion                 :      133 :agent.product.name="U3"^.version'
    - 'AgentClass                          :      131 :"Browser"'
    - 'AgentName                           :      131 :"UCBrowser"'
    - 'AgentVersion                        :      131 :agent.product.name="UCBrowser"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :      122 :"Browser"'
    - 'LayoutEngineName                    :      122 :"UCBrowser U2"'
    - 'LayoutEngineVersion                 :      122 :agent.product.name="U2"^.version'
    - 'AgentClass                          :      121 :"Browser"'
    - 'AgentName                           :      121 :"UCBrowser"'
    - 'AgentVersion                        :      121 :agent.product.name="UCWEB"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :      123 :"Browser"'
    - 'LayoutEngineName                    :      123 :"UCBrowser U3"'
    - 'LayoutEngineVersion                 :      123 :agent.product.name="U3"^.version'
    - 'AgentClass                          :      121 :"Browser"'
    - 'AgentName                           :      121 :"UCBrowser"'
    - 'AgentVersion                        :      121 :agent.product.name="UCWEB"^.version'


- test:
    input:
      user_agent_string: 'UCWEB/2.0 (Java; U; MIDP-2.0; Nokia203/20.37) U2/1.0.0 UCBrowser/8.7.0.218 U2/1.0.0 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia 203'
      DeviceBrand                          : 'Nokia'
      DeviceVersion                        : '20.37'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Java'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Java ??'
      OperatingSystemNameVersionMajor      : 'Java ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U2'
      LayoutEngineVersion                  : '1.0.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'UCBrowser U2 1.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U2 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '8.7.0.218'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'UCBrowser 8.7.0.218'
      AgentNameVersionMajor                : 'UCBrowser 8'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'NokiaX2-02/2.0 (11.79) Profile/MIDP-2.1 Configuration/CLDC-1.1 UCWEB/2.0(Java; U; MIDP-2.0; en-us; nokiax2-02) U2/1.0.0 UCBrowser/8.7.1.234 U2/1.0.0 Mobile UNTRUSTED/1.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia X2-02'
      DeviceBrand                          : 'Nokia'
      DeviceVersion                        : '2.0'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U2'
      LayoutEngineVersion                  : '1.0.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'UCBrowser U2 1.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U2 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '8.7.1.234'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'UCBrowser 8.7.1.234'
      AgentNameVersionMajor                : 'UCBrowser 8'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'

- test:
    input:
      user_agent_string: 'UCWEB/2.0(BlackBerry; U; 6.6.0.236; en-us; 9300/6.6.0.236) U2/1.0.0 UCBrowser/8.1.0.216 U2/1.0.0 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'BlackBerry 9300'
      DeviceBrand                          : 'BlackBerry'
      DeviceVersion                        : '6.6.0.236'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'RIM OS'
      OperatingSystemVersion               : 'RIM OS'
      OperatingSystemVersionMajor          : 'RIM OS'
      OperatingSystemNameVersion           : 'RIM OS'
      OperatingSystemNameVersionMajor      : 'RIM OS'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U2'
      LayoutEngineVersion                  : '1.0.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'UCBrowser U2 1.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U2 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '8.1.0.216'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'UCBrowser 8.1.0.216'
      AgentNameVersionMajor                : 'UCBrowser 8'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'UCWEB/2.0 (Windows; U; wds 8.10; pt-BR; NOKIA; RM-979_1004) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia RM-979 1004'
      DeviceBrand                          : 'Nokia'
      DeviceVersion                        : '8.10'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows ??'
      OperatingSystemNameVersionMajor      : 'Windows ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U2'
      LayoutEngineVersion                  : '1.0.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'UCBrowser U2 1.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U2 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '4.2.1.541'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'UCBrowser 4.2.1.541'
      AgentNameVersionMajor                : 'UCBrowser 4'
      AgentLanguage                        : 'Portuguese (Brazil)'
      AgentLanguageCode                    : 'pt-br'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'UCWEB/2.0 (Linux; U; Adr 4.1.2; zh-CN; GT-N7100) U2/1.0.0 UCBrowser/9.5.0.360 U2/1.0.0 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung GT-N7100'
      DeviceBrand                          : 'Samsung'
      DeviceVersion                        : '4.1.2'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.1.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.1.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U2'
      LayoutEngineVersion                  : '1.0.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'UCBrowser U2 1.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U2 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '9.5.0.360'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'UCBrowser 9.5.0.360'
      AgentNameVersionMajor                : 'UCBrowser 9'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'UCWEB/8.8 (iPhone; CPU OS_6; en-US)AppleWebKit/534.1 U3/3.0.0 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple EN-US'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U3'
      LayoutEngineVersion                  : '3.0.0'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'UCBrowser U3 3.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U3 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '8.8'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'UCBrowser 8.8'
      AgentNameVersionMajor                : 'UCBrowser 8'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'

- test:
    input:
      user_agent_string: 'UCWEB/2.0 (MIDP-2.0; U; Adr 7.0; en-US; Nexus_6) U2/1.0.0 UCBrowser/10.9.2.962 U2/1.0.0 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      DeviceVersion                        : '7.0'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser U2'
      LayoutEngineVersion                  : '1.0.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'UCBrowser U2 1.0.0'
      LayoutEngineNameVersionMajor         : 'UCBrowser U2 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '10.9.2.962'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'UCBrowser 10.9.2.962'
      AgentNameVersionMajor                : 'UCBrowser 10'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
